import{d as te,r as n,j as me,W as we,k as Ae,l as w,a as ye,a0 as Be,X as Ce,o as Se,a3 as ke,aa as be,aA as Ie,aB as Te,aC as De,w as Ue,s as r,t as f,f as E,z as t,I as ae,F as M,A as l,v as o,B as y,x as R,H as P,P as x,a7 as Qe,a4 as B,ac as S,ad as p,aD as Ge,aE as $e,aF as Fe,aG as se,aH as qe,aI as Oe,ah as Ee,Z as Re,V as Ne,E as A,M as Ve,N as ze,aJ as Le,aK as Me,$ as Pe,O as xe}from"./index.daab1274.js";/* empty css               *//* empty css               *//* empty css               */import{_ as He}from"./index.f842926d.js";const We="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAASBAMAAACzwgOtAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAkUExURUdwTAB23QB23QB23gB13QB03gB13QBz3wB01gB13QB03gB23ZhS5jsAAAALdFJOUwDdwvRNgR8tFpdphPot7wAAAGhJREFUCNdjYEAGLIqCMDCBIXk3HGxl8EZwNqHKcCE4CgwMs2HszQkMDIwwzhag2ezWUE4AyCZvmFkgwAnhSEAcoQ3mOEA4yRBLoM6DWgIB0bt3b2yAcZh2794O9waH9O4FCE8ViYIpAPzBUd4PZBkqAAAAAElFTkSuQmCC",Ze=k=>(Ve("data-v-e5c1b47f"),k=k(),ze(),k),Ke={class:"main"},je={class:"up"},Je={class:"gqc"},Xe={class:"names"},Ye={class:"blance recharge"},ea={class:"gqc"},aa={class:"names"},sa={class:"blance"},ta={class:"gqc"},la={class:"names"},na={class:"sildes"},ca={key:0,class:"u"},oa={key:1,class:"u"},ia={key:0,class:"tips"},ua={class:"box"},ra={class:"titles"},da={class:"userInput"},va={class:"type"},ha={key:0,class:"w_down"},_a=Ze(()=>t("img",{src:We,alt:""},null,-1)),fa=[_a],pa={key:0,class:"estimate"},ga={key:1,class:"tipsBox"},ma={class:"e_tips"},wa={class:"e_tips e_tips_color"},Aa={class:"e_tips"},ya={class:"e_tips e_tips_color"},Ba={class:"btn"},Ca=te({name:"Withdrawal"}),Sa=te({...Ca,setup(k){let d=n({});const _=me(),b=we(),H=Ae(),I=n(!1),c=n("USDT"),g=n(""),le=987643;let v=n(!1),T=n(300);const W=n(10),D=n(0),U=n(0),ne=n(se),s=n("withdrawal"),Q=n(""),Z=n([{name:"GQC",value:Le},{name:"SCT",value:Me}]),K=w(()=>A(_.address)),G=w(()=>A(_.BalanceGQC)),$=w(()=>A(_.BalanceUSDT)),F=w(()=>A(_.BalanceSCT)),ce=w(()=>A(_.withdrawal)),oe=w(()=>A(_.contractInstance)),ie=w(()=>A(_.GQCcontractInstance)),ue=w(()=>A(_.SCTcontractInstance)),i=n(!1),N=n(0),q=n(0),j=n(0);let O=ye({month:0,strDate:0,year:0});O=Be();async function J(){let e=await Qe();d.value=e.data}const X=(e,a)=>{switch(a){case"GQC":D.value=e.gqcBalance,U.value=G.value;break;case"USDT":D.value=e.usdtBalance,U.value=$.value;break;case"SCT":D.value=e.sctBalance,U.value=F.value;break}},Y=e=>{I.value=!1,c.value!==e.name&&(g.value="",c.value=e.name,ne.value=e.value,X(d.value,e.name),V(c.value,""))};function re(e){V(c.value,+e),s.value==="pendingOrder"?+e?N.value=B(+e/q.value,6):N.value=0:s.value==="withdrawal"&&(c.value==="USDT"?+e&&+e<=d.value.usdtBalance?i.value=!1:i.value=!0:c.value==="GQC"?+e&&+e<=d.value.gqcBalance?i.value=!1:i.value=!0:c.value==="SCT"&&(+e&&+e<=d.value.sctBalance?i.value=!1:i.value=!0))}function de(){s.value!=="pendingOrder"&&(I.value=!0)}const ve=()=>{H.push({path:"transactiondDtailed",query:{type:s.value}})};Ce(async()=>{s.value=b.query.name,Q.value=b.query.value,s.value==="recharge"?b.meta.title="recharge":s.value==="pendingOrder"&&(b.meta.title="pendingOrder"),Y({name:Q.value,value:Z.value.find(e=>e.name===Q.value)})}),Se(async()=>{let e=await ke();q.value=e.data;let a=await be();j.value=a.data,console.log("\u7F13\u5B58",_),await J(),X(d.value,Q.value),await Ie(),await Te(),await De()}),Ue([G,$,F],()=>{V(c.value,0)},{deep:!0,immediate:!0});async function V(e,a){e==="USDT"?!$.value||a===""||$.value<a?i.value=!0:i.value=!1:e==="GQC"?!G.value||a===""||G.value<a?i.value=!0:i.value=!1:e==="SCT"&&(!F.value||a===""||F.value<a?i.value=!0:i.value=!1)}const z=e=>{if(!g.value)return;v.value=!0;let a=setInterval(()=>{T.value>0?(T.value--,T.value==0&&(clearInterval(a),v.value=!1)):(clearInterval(a),v.value=!1)},1e3);switch(e){case"recharge":fe(a,c.value);break;case"pendingOrder":+g.value<200?S(p("greaterThan")):pe(a,+g.value);break;case"withdrawal":he(a,+g.value,c.value);break}};async function he(e,a,u){let h=await Ge({amount:a,tokenType:u});h.status===200&&h.data.sign?_e(h.data,e):(S(p("withdrawal")+p("Failed")),v.value=!1,clearInterval(e))}function _e(e,a){ce.value.methods.claimReward(e.tokenAddress,e.address,e.amount,e.sign).send({from:K.value,gasLimit:"300000"}).then(u=>{v.value=!1,clearInterval(a),L()}).catch(u=>{console.log(u),S(p("withdrawal")+p("Failed")),v.value=!1,clearInterval(a)})}function fe(e,a){let u=$e(Fe(+g.value,18),le).toString(),h={Instance:"",address:""};a==="USDT"?h.Instance=oe:a==="GQC"?h.Instance=ie:a==="SCT"&&(h.Instance=ue),h.Instance.value.methods.transfer(se,u).send({from:K.value,gasLimit:"300000"}).then(m=>{console.log(m),ee(m.transactionHash,e)}).catch(m=>{console.log(m),S(p("RechargeFailed")),v.value=!1,clearInterval(e)})}async function pe(e,a){(await qe({amount:a})).status===200?L():S(p("pendingOrder")+p("Failed")),J(),clearInterval(e)}async function ee(e,a){let u=await Oe(e);console.log(u),u.status===200&&u.data&&u.data.txId?(v.value=!1,clearInterval(a),L()):W.value===0?(S(p("RechargeFailed")),v.value=!1,clearInterval(a)):setTimeout(()=>{W.value--,ee(e,a)},3e3)}function L(){H.push({path:"paymentSucceeded",query:{type:s.value}})}return(e,a)=>{const u=Pe,h=Ee,m=Re,ge=Ne;return r(),f(M,null,[E(u,{right:!0,onClickRight:ve}),t("div",Ke,[t("div",{class:ae(["balance",s.value==="pendingOrder"?"center":""])},[t("div",je,[s.value==="pendingOrder"?(r(),f(M,{key:0},[t("div",Je,[t("div",Xe,l(e.$t("my"))+"GQC",1),t("div",Ye,l(o(B)(o(d).gqcBalance,3)),1)]),t("div",ea,[t("div",aa,l(e.$t("my"))+"USDT",1),t("div",sa,l(o(B)(o(d).usdtBalance,3)),1)])],64)):(r(),f(M,{key:1},[t("div",ta,[t("div",la,l(e.$t("my"))+l(c.value),1),t("div",na,[t("div",{class:ae(["blance",s.value==="recharge"?"recharge":""])},l(o(B)(D.value,3)),3),c.value==="GQC"?(r(),f("div",ca,"\u2248"+l(o(B)(o(d).gqcBalance*q.value,3))+" USDT",1)):y("v-if",!0),c.value==="SCT"?(r(),f("div",oa,"\u2248"+l(o(B)(o(d).sctBalance*j.value,3))+" USDT ",1)):y("v-if",!0)])]),y(` <div class="gqc">\r
            <div class="names">{{ $t('my') }}USDT</div>\r
            <div class="blance" :class="type === 'recharge' ? 'recharge' : ''">{{ CoinInfoData.usdtBalance }}</div>\r
          </div> `)],64))]),s.value!=="recharge"&&c.value==="GQC"?(r(),f("div",ia,l(e.$t("GQCIncreased",{price:q.value,time:`${o(O).year}-${o(O).month}-${o(O).strDate}`})),1)):y("v-if",!0)],2),t("div",ua,[t("div",ra,l(e.$t("enterAmount",{type:e.$t(s.value)})),1),t("div",da,[E(h,{modelValue:g.value,"onUpdate:modelValue":[a[0]||(a[0]=C=>g.value=C),re],label:"",type:"number",placeholder:"0.00"},{button:R(()=>[t("div",{class:"w_type",onClick:de},[t("div",va,l(c.value),1),s.value!=="pendingOrder"?(r(),f("div",ha,fa)):y("v-if",!0)])]),_:1},8,["modelValue"])]),s.value==="pendingOrder"?(r(),f("div",pa,l(e.$t("ExpectedAvailability"))+"\uFF1A"+l(N.value)+" GQC ",1)):y("v-if",!0),s.value==="recharge"?(r(),f("div",ga,[t("div",ma,l(e.$t("WalletOnBlockchain")),1),t("div",wa,l(" "+c.value+" "),1),t("div",Aa,l(e.$t("balance")+" "),1),t("div",ya,l(o(B)(U.value,6)),1)])):y("v-if",!0)]),t("div",Ba,[s.value==="recharge"?(r(),P(m,{key:0,type:"primary",block:"",color:"#1F75D9",onClick:a[1]||(a[1]=C=>z(s.value)),disabled:i.value},{default:R(()=>[x(l(e.$t("immediately",{type:e.$t(s.value)})),1)]),_:1},8,["disabled"])):s.value==="pendingOrder"?(r(),P(m,{key:1,type:"primary",block:"",color:"#1F75D9",onClick:a[2]||(a[2]=C=>z(s.value))},{default:R(()=>[x(l(e.$t("immediately",{type:e.$t(s.value)})),1)]),_:1})):(r(),P(m,{key:2,type:"primary",block:"",color:"#1F75D9",onClick:a[3]||(a[3]=C=>z(s.value)),disabled:i.value},{default:R(()=>[x(l(e.$t("immediately",{type:e.$t(s.value)})),1)]),_:1},8,["disabled"]))])]),E(o(He),{showLoading:o(v),countDown:o(T)},null,8,["showLoading","countDown"]),E(ge,{show:I.value,"onUpdate:show":a[4]||(a[4]=C=>I.value=C),actions:Z.value,"cancel-text":e.$t("cancel"),"close-on-click-action":"",onSelect:Y},null,8,["show","actions","cancel-text"])],64)}}});const Ua=xe(Sa,[["__scopeId","data-v-e5c1b47f"],["__file","D:/work/GQC/src/views/withdrawal/index.vue"]]);export{Ua as default};
