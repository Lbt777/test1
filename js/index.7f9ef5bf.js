(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();function Ti(e,t){const r=Object.create(null),i=e.split(",");for(let n=0;n<i.length;n++)r[i[n]]=!0;return t?n=>!!r[n.toLowerCase()]:n=>!!r[n]}const Uo="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Go=Ti(Uo);function da(e){return!!e||e===""}function gt(e){if(fe(e)){const t={};for(let r=0;r<e.length;r++){const i=e[r],n=Re(i)?Ho(i):gt(i);if(n)for(const s in n)t[s]=n[s]}return t}else{if(Re(e))return e;if(_e(e))return e}}const jo=/;(?![^(]*\))/g,Ko=/:(.+)/;function Ho(e){const t={};return e.split(jo).forEach(r=>{if(r){const i=r.split(Ko);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function pt(e){let t="";if(Re(e))t=e;else if(fe(e))for(let r=0;r<e.length;r++){const i=pt(e[r]);i&&(t+=i+" ")}else if(_e(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}const Ce=e=>Re(e)?e:e==null?"":fe(e)||_e(e)&&(e.toString===pa||!he(e.toString))?JSON.stringify(e,fa,2):String(e),fa=(e,t)=>t&&t.__v_isRef?fa(e,t.value):cr(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[i,n])=>(r[`${i} =>`]=n,r),{})}:ha(t)?{[`Set(${t.size})`]:[...t.values()]}:_e(t)&&!fe(t)&&!va(t)?String(t):t,Se={},ur=[],nt=()=>{},Vo=()=>!1,Wo=/^on[^a-z]/,Tn=e=>Wo.test(e),bi=e=>e.startsWith("onUpdate:"),Fe=Object.assign,Si=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},$o=Object.prototype.hasOwnProperty,ve=(e,t)=>$o.call(e,t),fe=Array.isArray,cr=e=>bn(e)==="[object Map]",ha=e=>bn(e)==="[object Set]",he=e=>typeof e=="function",Re=e=>typeof e=="string",Ai=e=>typeof e=="symbol",_e=e=>e!==null&&typeof e=="object",ga=e=>_e(e)&&he(e.then)&&he(e.catch),pa=Object.prototype.toString,bn=e=>pa.call(e),qo=e=>bn(e).slice(8,-1),va=e=>bn(e)==="[object Object]",_i=e=>Re(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,ln=Ti(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Sn=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},Yo=/-(\w)/g,mt=Sn(e=>e.replace(Yo,(t,r)=>r?r.toUpperCase():"")),zo=/\B([A-Z])/g,tr=Sn(e=>e.replace(zo,"-$1").toLowerCase()),An=Sn(e=>e.charAt(0).toUpperCase()+e.slice(1)),Nn=Sn(e=>e?`on${An(e)}`:""),Ur=(e,t)=>!Object.is(e,t),Ir=(e,t)=>{for(let r=0;r<e.length;r++)e[r](t)},fn=(e,t,r)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:r})},ma=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let zi;const Xo=()=>zi||(zi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let ct;class ya{constructor(t=!1){this.detached=t,this.active=!0,this.effects=[],this.cleanups=[],this.parent=ct,!t&&ct&&(this.index=(ct.scopes||(ct.scopes=[])).push(this)-1)}run(t){if(this.active){const r=ct;try{return ct=this,t()}finally{ct=r}}}on(){ct=this}off(){ct=this.parent}stop(t){if(this.active){let r,i;for(r=0,i=this.effects.length;r<i;r++)this.effects[r].stop();for(r=0,i=this.cleanups.length;r<i;r++)this.cleanups[r]();if(this.scopes)for(r=0,i=this.scopes.length;r<i;r++)this.scopes[r].stop(!0);if(!this.detached&&this.parent&&!t){const n=this.parent.scopes.pop();n&&n!==this&&(this.parent.scopes[this.index]=n,n.index=this.index)}this.parent=void 0,this.active=!1}}}function Qo(e){return new ya(e)}function Zo(e,t=ct){t&&t.active&&t.effects.push(e)}const Li=e=>{const t=new Set(e);return t.w=0,t.n=0,t},Ea=e=>(e.w&Bt)>0,Ta=e=>(e.n&Bt)>0,Jo=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=Bt},el=e=>{const{deps:t}=e;if(t.length){let r=0;for(let i=0;i<t.length;i++){const n=t[i];Ea(n)&&!Ta(n)?n.delete(e):t[r++]=n,n.w&=~Bt,n.n&=~Bt}t.length=r}},Zn=new WeakMap;let kr=0,Bt=1;const Jn=30;let tt;const Zt=Symbol(""),ei=Symbol("");class Ri{constructor(t,r=null,i){this.fn=t,this.scheduler=r,this.active=!0,this.deps=[],this.parent=void 0,Zo(this,i)}run(){if(!this.active)return this.fn();let t=tt,r=Mt;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=tt,tt=this,Mt=!0,Bt=1<<++kr,kr<=Jn?Jo(this):Xi(this),this.fn()}finally{kr<=Jn&&el(this),Bt=1<<--kr,tt=this.parent,Mt=r,this.parent=void 0,this.deferStop&&this.stop()}}stop(){tt===this?this.deferStop=!0:this.active&&(Xi(this),this.onStop&&this.onStop(),this.active=!1)}}function Xi(e){const{deps:t}=e;if(t.length){for(let r=0;r<t.length;r++)t[r].delete(e);t.length=0}}let Mt=!0;const ba=[];function Er(){ba.push(Mt),Mt=!1}function Tr(){const e=ba.pop();Mt=e===void 0?!0:e}function $e(e,t,r){if(Mt&&tt){let i=Zn.get(e);i||Zn.set(e,i=new Map);let n=i.get(r);n||i.set(r,n=Li()),Sa(n)}}function Sa(e,t){let r=!1;kr<=Jn?Ta(e)||(e.n|=Bt,r=!Ea(e)):r=!e.has(tt),r&&(e.add(tt),tt.deps.push(e))}function Lt(e,t,r,i,n,s){const u=Zn.get(e);if(!u)return;let A=[];if(t==="clear")A=[...u.values()];else if(r==="length"&&fe(e))u.forEach((y,a)=>{(a==="length"||a>=i)&&A.push(y)});else switch(r!==void 0&&A.push(u.get(r)),t){case"add":fe(e)?_i(r)&&A.push(u.get("length")):(A.push(u.get(Zt)),cr(e)&&A.push(u.get(ei)));break;case"delete":fe(e)||(A.push(u.get(Zt)),cr(e)&&A.push(u.get(ei)));break;case"set":cr(e)&&A.push(u.get(Zt));break}if(A.length===1)A[0]&&ti(A[0]);else{const y=[];for(const a of A)a&&y.push(...a);ti(Li(y))}}function ti(e,t){const r=fe(e)?e:[...e];for(const i of r)i.computed&&Qi(i);for(const i of r)i.computed||Qi(i)}function Qi(e,t){(e!==tt||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const tl=Ti("__proto__,__v_isRef,__isVue"),Aa=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Ai)),rl=Di(),nl=Di(!1,!0),il=Di(!0),Zi=sl();function sl(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...r){const i=ye(this);for(let s=0,u=this.length;s<u;s++)$e(i,"get",s+"");const n=i[t](...r);return n===-1||n===!1?i[t](...r.map(ye)):n}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...r){Er();const i=ye(this)[t].apply(this,r);return Tr(),i}}),e}function Di(e=!1,t=!1){return function(i,n,s){if(n==="__v_isReactive")return!e;if(n==="__v_isReadonly")return e;if(n==="__v_isShallow")return t;if(n==="__v_raw"&&s===(e?t?bl:ka:t?Da:Ra).get(i))return i;const u=fe(i);if(!e&&u&&ve(Zi,n))return Reflect.get(Zi,n,s);const A=Reflect.get(i,n,s);return(Ai(n)?Aa.has(n):tl(n))||(e||$e(i,"get",n),t)?A:Pe(A)?u&&_i(n)?A:A.value:_e(A)?e?Ca(A):qe(A):A}}const al=_a(),ol=_a(!0);function _a(e=!1){return function(r,i,n,s){let u=r[i];if(pr(u)&&Pe(u)&&!Pe(n))return!1;if(!e&&(!hn(n)&&!pr(n)&&(u=ye(u),n=ye(n)),!fe(r)&&Pe(u)&&!Pe(n)))return u.value=n,!0;const A=fe(r)&&_i(i)?Number(i)<r.length:ve(r,i),y=Reflect.set(r,i,n,s);return r===ye(s)&&(A?Ur(n,u)&&Lt(r,"set",i,n):Lt(r,"add",i,n)),y}}function ll(e,t){const r=ve(e,t);e[t];const i=Reflect.deleteProperty(e,t);return i&&r&&Lt(e,"delete",t,void 0),i}function ul(e,t){const r=Reflect.has(e,t);return(!Ai(t)||!Aa.has(t))&&$e(e,"has",t),r}function cl(e){return $e(e,"iterate",fe(e)?"length":Zt),Reflect.ownKeys(e)}const La={get:rl,set:al,deleteProperty:ll,has:ul,ownKeys:cl},dl={get:il,set(e,t){return!0},deleteProperty(e,t){return!0}},fl=Fe({},La,{get:nl,set:ol}),ki=e=>e,_n=e=>Reflect.getPrototypeOf(e);function en(e,t,r=!1,i=!1){e=e.__v_raw;const n=ye(e),s=ye(t);r||(t!==s&&$e(n,"get",t),$e(n,"get",s));const{has:u}=_n(n),A=i?ki:r?xi:Gr;if(u.call(n,t))return A(e.get(t));if(u.call(n,s))return A(e.get(s));e!==n&&e.get(t)}function tn(e,t=!1){const r=this.__v_raw,i=ye(r),n=ye(e);return t||(e!==n&&$e(i,"has",e),$e(i,"has",n)),e===n?r.has(e):r.has(e)||r.has(n)}function rn(e,t=!1){return e=e.__v_raw,!t&&$e(ye(e),"iterate",Zt),Reflect.get(e,"size",e)}function Ji(e){e=ye(e);const t=ye(this);return _n(t).has.call(t,e)||(t.add(e),Lt(t,"add",e,e)),this}function es(e,t){t=ye(t);const r=ye(this),{has:i,get:n}=_n(r);let s=i.call(r,e);s||(e=ye(e),s=i.call(r,e));const u=n.call(r,e);return r.set(e,t),s?Ur(t,u)&&Lt(r,"set",e,t):Lt(r,"add",e,t),this}function ts(e){const t=ye(this),{has:r,get:i}=_n(t);let n=r.call(t,e);n||(e=ye(e),n=r.call(t,e)),i&&i.call(t,e);const s=t.delete(e);return n&&Lt(t,"delete",e,void 0),s}function rs(){const e=ye(this),t=e.size!==0,r=e.clear();return t&&Lt(e,"clear",void 0,void 0),r}function nn(e,t){return function(i,n){const s=this,u=s.__v_raw,A=ye(u),y=t?ki:e?xi:Gr;return!e&&$e(A,"iterate",Zt),u.forEach((a,T)=>i.call(n,y(a),y(T),s))}}function sn(e,t,r){return function(...i){const n=this.__v_raw,s=ye(n),u=cr(s),A=e==="entries"||e===Symbol.iterator&&u,y=e==="keys"&&u,a=n[e](...i),T=r?ki:t?xi:Gr;return!t&&$e(s,"iterate",y?ei:Zt),{next(){const{value:v,done:d}=a.next();return d?{value:v,done:d}:{value:A?[T(v[0]),T(v[1])]:T(v),done:d}},[Symbol.iterator](){return this}}}}function It(e){return function(...t){return e==="delete"?!1:this}}function hl(){const e={get(s){return en(this,s)},get size(){return rn(this)},has:tn,add:Ji,set:es,delete:ts,clear:rs,forEach:nn(!1,!1)},t={get(s){return en(this,s,!1,!0)},get size(){return rn(this)},has:tn,add:Ji,set:es,delete:ts,clear:rs,forEach:nn(!1,!0)},r={get(s){return en(this,s,!0)},get size(){return rn(this,!0)},has(s){return tn.call(this,s,!0)},add:It("add"),set:It("set"),delete:It("delete"),clear:It("clear"),forEach:nn(!0,!1)},i={get(s){return en(this,s,!0,!0)},get size(){return rn(this,!0)},has(s){return tn.call(this,s,!0)},add:It("add"),set:It("set"),delete:It("delete"),clear:It("clear"),forEach:nn(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{e[s]=sn(s,!1,!1),r[s]=sn(s,!0,!1),t[s]=sn(s,!1,!0),i[s]=sn(s,!0,!0)}),[e,r,t,i]}const[gl,pl,vl,ml]=hl();function Ci(e,t){const r=t?e?ml:vl:e?pl:gl;return(i,n,s)=>n==="__v_isReactive"?!e:n==="__v_isReadonly"?e:n==="__v_raw"?i:Reflect.get(ve(r,n)&&n in i?r:i,n,s)}const yl={get:Ci(!1,!1)},El={get:Ci(!1,!0)},Tl={get:Ci(!0,!1)},Ra=new WeakMap,Da=new WeakMap,ka=new WeakMap,bl=new WeakMap;function Sl(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Al(e){return e.__v_skip||!Object.isExtensible(e)?0:Sl(qo(e))}function qe(e){return pr(e)?e:Ii(e,!1,La,yl,Ra)}function _l(e){return Ii(e,!1,fl,El,Da)}function Ca(e){return Ii(e,!0,dl,Tl,ka)}function Ii(e,t,r,i,n){if(!_e(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const s=n.get(e);if(s)return s;const u=Al(e);if(u===0)return e;const A=new Proxy(e,u===2?i:r);return n.set(e,A),A}function dr(e){return pr(e)?dr(e.__v_raw):!!(e&&e.__v_isReactive)}function pr(e){return!!(e&&e.__v_isReadonly)}function hn(e){return!!(e&&e.__v_isShallow)}function Ia(e){return dr(e)||pr(e)}function ye(e){const t=e&&e.__v_raw;return t?ye(t):e}function wi(e){return fn(e,"__v_skip",!0),e}const Gr=e=>_e(e)?qe(e):e,xi=e=>_e(e)?Ca(e):e;function wa(e){Mt&&tt&&(e=ye(e),Sa(e.dep||(e.dep=Li())))}function xa(e,t){e=ye(e),e.dep&&ti(e.dep)}function Pe(e){return!!(e&&e.__v_isRef===!0)}function xe(e){return Oa(e,!1)}function Ll(e){return Oa(e,!0)}function Oa(e,t){return Pe(e)?e:new Rl(e,t)}class Rl{constructor(t,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?t:ye(t),this._value=r?t:Gr(t)}get value(){return wa(this),this._value}set value(t){const r=this.__v_isShallow||hn(t)||pr(t);t=r?t:ye(t),Ur(t,this._rawValue)&&(this._rawValue=t,this._value=r?t:Gr(t),xa(this))}}function ee(e){return Pe(e)?e.value:e}const Dl={get:(e,t,r)=>ee(Reflect.get(e,t,r)),set:(e,t,r,i)=>{const n=e[t];return Pe(n)&&!Pe(r)?(n.value=r,!0):Reflect.set(e,t,r,i)}};function Pa(e){return dr(e)?e:new Proxy(e,Dl)}var Fa;class kl{constructor(t,r,i,n){this._setter=r,this.dep=void 0,this.__v_isRef=!0,this[Fa]=!1,this._dirty=!0,this.effect=new Ri(t,()=>{this._dirty||(this._dirty=!0,xa(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!n,this.__v_isReadonly=i}get value(){const t=ye(this);return wa(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}Fa="__v_isReadonly";function Cl(e,t,r=!1){let i,n;const s=he(e);return s?(i=e,n=nt):(i=e.get,n=e.set),new kl(i,n,s||!n,r)}function Nt(e,t,r,i){let n;try{n=i?e(...i):e()}catch(s){Ln(s,t,r)}return n}function Ze(e,t,r,i){if(he(e)){const s=Nt(e,t,r,i);return s&&ga(s)&&s.catch(u=>{Ln(u,t,r)}),s}const n=[];for(let s=0;s<e.length;s++)n.push(Ze(e[s],t,r,i));return n}function Ln(e,t,r,i=!0){const n=t?t.vnode:null;if(t){let s=t.parent;const u=t.proxy,A=r;for(;s;){const a=s.ec;if(a){for(let T=0;T<a.length;T++)if(a[T](e,u,A)===!1)return}s=s.parent}const y=t.appContext.config.errorHandler;if(y){Nt(y,null,10,[e,u,A]);return}}Il(e,r,n,i)}function Il(e,t,r,i=!0){console.error(e)}let jr=!1,ri=!1;const Ne=[];let ft=0;const fr=[];let St=null,qt=0;const Ma=Promise.resolve();let Oi=null;function er(e){const t=Oi||Ma;return e?t.then(this?e.bind(this):e):t}function wl(e){let t=ft+1,r=Ne.length;for(;t<r;){const i=t+r>>>1;Kr(Ne[i])<e?t=i+1:r=i}return t}function Pi(e){(!Ne.length||!Ne.includes(e,jr&&e.allowRecurse?ft+1:ft))&&(e.id==null?Ne.push(e):Ne.splice(wl(e.id),0,e),Na())}function Na(){!jr&&!ri&&(ri=!0,Oi=Ma.then(Ua))}function xl(e){const t=Ne.indexOf(e);t>ft&&Ne.splice(t,1)}function Ol(e){fe(e)?fr.push(...e):(!St||!St.includes(e,e.allowRecurse?qt+1:qt))&&fr.push(e),Na()}function ns(e,t=jr?ft+1:0){for(;t<Ne.length;t++){const r=Ne[t];r&&r.pre&&(Ne.splice(t,1),t--,r())}}function Ba(e){if(fr.length){const t=[...new Set(fr)];if(fr.length=0,St){St.push(...t);return}for(St=t,St.sort((r,i)=>Kr(r)-Kr(i)),qt=0;qt<St.length;qt++)St[qt]();St=null,qt=0}}const Kr=e=>e.id==null?1/0:e.id,Pl=(e,t)=>{const r=Kr(e)-Kr(t);if(r===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return r};function Ua(e){ri=!1,jr=!0,Ne.sort(Pl);const t=nt;try{for(ft=0;ft<Ne.length;ft++){const r=Ne[ft];r&&r.active!==!1&&Nt(r,null,14)}}finally{ft=0,Ne.length=0,Ba(),jr=!1,Oi=null,(Ne.length||fr.length)&&Ua()}}function Fl(e,t,...r){if(e.isUnmounted)return;const i=e.vnode.props||Se;let n=r;const s=t.startsWith("update:"),u=s&&t.slice(7);if(u&&u in i){const T=`${u==="modelValue"?"model":u}Modifiers`,{number:v,trim:d}=i[T]||Se;d&&(n=r.map(L=>L.trim())),v&&(n=r.map(ma))}let A,y=i[A=Nn(t)]||i[A=Nn(mt(t))];!y&&s&&(y=i[A=Nn(tr(t))]),y&&Ze(y,e,6,n);const a=i[A+"Once"];if(a){if(!e.emitted)e.emitted={};else if(e.emitted[A])return;e.emitted[A]=!0,Ze(a,e,6,n)}}function Ga(e,t,r=!1){const i=t.emitsCache,n=i.get(e);if(n!==void 0)return n;const s=e.emits;let u={},A=!1;if(!he(e)){const y=a=>{const T=Ga(a,t,!0);T&&(A=!0,Fe(u,T))};!r&&t.mixins.length&&t.mixins.forEach(y),e.extends&&y(e.extends),e.mixins&&e.mixins.forEach(y)}return!s&&!A?(_e(e)&&i.set(e,null),null):(fe(s)?s.forEach(y=>u[y]=null):Fe(u,s),_e(e)&&i.set(e,u),u)}function Rn(e,t){return!e||!Tn(t)?!1:(t=t.slice(2).replace(/Once$/,""),ve(e,t[0].toLowerCase()+t.slice(1))||ve(e,tr(t))||ve(e,t))}let Qe=null,Dn=null;function gn(e){const t=Qe;return Qe=e,Dn=e&&e.type.__scopeId||null,t}function rr(e){Dn=e}function nr(){Dn=null}function Hr(e,t=Qe,r){if(!t||e._n)return e;const i=(...n)=>{i._d&&ps(-1);const s=gn(t);let u;try{u=e(...n)}finally{gn(s),i._d&&ps(1)}return u};return i._n=!0,i._c=!0,i._d=!0,i}function Bn(e){const{type:t,vnode:r,proxy:i,withProxy:n,props:s,propsOptions:[u],slots:A,attrs:y,emit:a,render:T,renderCache:v,data:d,setupState:L,ctx:R,inheritAttrs:E}=e;let o,f;const l=gn(e);try{if(r.shapeFlag&4){const m=n||i;o=dt(T.call(m,m,v,s,L,d,R)),f=y}else{const m=t;o=dt(m.length>1?m(s,{attrs:y,slots:A,emit:a}):m(s,null)),f=t.props?y:Ml(y)}}catch(m){Pr.length=0,Ln(m,e,1),o=ne(it)}let g=o;if(f&&E!==!1){const m=Object.keys(f),{shapeFlag:h}=g;m.length&&h&7&&(u&&m.some(bi)&&(f=Nl(f,u)),g=Rt(g,f))}return r.dirs&&(g=Rt(g),g.dirs=g.dirs?g.dirs.concat(r.dirs):r.dirs),r.transition&&(g.transition=r.transition),o=g,gn(l),o}const Ml=e=>{let t;for(const r in e)(r==="class"||r==="style"||Tn(r))&&((t||(t={}))[r]=e[r]);return t},Nl=(e,t)=>{const r={};for(const i in e)(!bi(i)||!(i.slice(9)in t))&&(r[i]=e[i]);return r};function Bl(e,t,r){const{props:i,children:n,component:s}=e,{props:u,children:A,patchFlag:y}=t,a=s.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&y>=0){if(y&1024)return!0;if(y&16)return i?is(i,u,a):!!u;if(y&8){const T=t.dynamicProps;for(let v=0;v<T.length;v++){const d=T[v];if(u[d]!==i[d]&&!Rn(a,d))return!0}}}else return(n||A)&&(!A||!A.$stable)?!0:i===u?!1:i?u?is(i,u,a):!0:!!u;return!1}function is(e,t,r){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let n=0;n<i.length;n++){const s=i[n];if(t[s]!==e[s]&&!Rn(r,s))return!0}return!1}function Ul({vnode:e,parent:t},r){for(;t&&t.subTree===e;)(e=t.vnode).el=r,t=t.parent}const ja=e=>e.__isSuspense;function Gl(e,t){t&&t.pendingBranch?fe(e)?t.effects.push(...e):t.effects.push(e):Ol(e)}function hr(e,t){if(we){let r=we.provides;const i=we.parent&&we.parent.provides;i===r&&(r=we.provides=Object.create(i)),r[e]=t}}function Ve(e,t,r=!1){const i=we||Qe;if(i){const n=i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides;if(n&&e in n)return n[e];if(arguments.length>1)return r&&he(t)?t.call(i.proxy):t}}function jl(e,t){return kn(e,null,t)}function Kl(e,t){return kn(e,null,{flush:"post"})}const ss={};function vt(e,t,r){return kn(e,t,r)}function kn(e,t,{immediate:r,deep:i,flush:n,onTrack:s,onTrigger:u}=Se){const A=we;let y,a=!1,T=!1;if(Pe(e)?(y=()=>e.value,a=hn(e)):dr(e)?(y=()=>e,i=!0):fe(e)?(T=!0,a=e.some(f=>dr(f)||hn(f)),y=()=>e.map(f=>{if(Pe(f))return f.value;if(dr(f))return Xt(f);if(he(f))return Nt(f,A,2)})):he(e)?t?y=()=>Nt(e,A,2):y=()=>{if(!(A&&A.isUnmounted))return v&&v(),Ze(e,A,3,[d])}:y=nt,t&&i){const f=y;y=()=>Xt(f())}let v,d=f=>{v=o.onStop=()=>{Nt(f,A,4)}};if($r)return d=nt,t?r&&Ze(t,A,3,[y(),T?[]:void 0,d]):y(),nt;let L=T?[]:ss;const R=()=>{if(!!o.active)if(t){const f=o.run();(i||a||(T?f.some((l,g)=>Ur(l,L[g])):Ur(f,L)))&&(v&&v(),Ze(t,A,3,[f,L===ss?void 0:L,d]),L=f)}else o.run()};R.allowRecurse=!!t;let E;n==="sync"?E=R:n==="post"?E=()=>Oe(R,A&&A.suspense):(R.pre=!0,A&&(R.id=A.uid),E=()=>Pi(R));const o=new Ri(y,E);return t?r?R():L=o.run():n==="post"?Oe(o.run.bind(o),A&&A.suspense):o.run(),()=>{o.stop(),A&&A.scope&&Si(A.scope.effects,o)}}function Hl(e,t,r){const i=this.proxy,n=Re(e)?e.includes(".")?Ka(i,e):()=>i[e]:e.bind(i,i);let s;he(t)?s=t:(s=t.handler,r=t);const u=we;vr(this);const A=kn(n,s.bind(i),r);return u?vr(u):Jt(),A}function Ka(e,t){const r=t.split(".");return()=>{let i=e;for(let n=0;n<r.length&&i;n++)i=i[r[n]];return i}}function Xt(e,t){if(!_e(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Pe(e))Xt(e.value,t);else if(fe(e))for(let r=0;r<e.length;r++)Xt(e[r],t);else if(ha(e)||cr(e))e.forEach(r=>{Xt(r,t)});else if(va(e))for(const r in e)Xt(e[r],t);return e}function Vl(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Ut(()=>{e.isMounted=!0}),Fi(()=>{e.isUnmounting=!0}),e}const ze=[Function,Array],Wl={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:ze,onEnter:ze,onAfterEnter:ze,onEnterCancelled:ze,onBeforeLeave:ze,onLeave:ze,onAfterLeave:ze,onLeaveCancelled:ze,onBeforeAppear:ze,onAppear:ze,onAfterAppear:ze,onAppearCancelled:ze},setup(e,{slots:t}){const r=kt(),i=Vl();let n;return()=>{const s=t.default&&Wa(t.default(),!0);if(!s||!s.length)return;let u=s[0];if(s.length>1){for(const E of s)if(E.type!==it){u=E;break}}const A=ye(e),{mode:y}=A;if(i.isLeaving)return Un(u);const a=as(u);if(!a)return Un(u);const T=ni(a,A,i,r);pn(a,T);const v=r.subTree,d=v&&as(v);let L=!1;const{getTransitionKey:R}=a.type;if(R){const E=R();n===void 0?n=E:E!==n&&(n=E,L=!0)}if(d&&d.type!==it&&(!Yt(a,d)||L)){const E=ni(d,A,i,r);if(pn(d,E),y==="out-in")return i.isLeaving=!0,E.afterLeave=()=>{i.isLeaving=!1,r.update()},Un(u);y==="in-out"&&a.type!==it&&(E.delayLeave=(o,f,l)=>{const g=Va(i,d);g[String(d.key)]=d,o._leaveCb=()=>{f(),o._leaveCb=void 0,delete T.delayedLeave},T.delayedLeave=l})}return u}}},Ha=Wl;function Va(e,t){const{leavingVNodes:r}=e;let i=r.get(t.type);return i||(i=Object.create(null),r.set(t.type,i)),i}function ni(e,t,r,i){const{appear:n,mode:s,persisted:u=!1,onBeforeEnter:A,onEnter:y,onAfterEnter:a,onEnterCancelled:T,onBeforeLeave:v,onLeave:d,onAfterLeave:L,onLeaveCancelled:R,onBeforeAppear:E,onAppear:o,onAfterAppear:f,onAppearCancelled:l}=t,g=String(e.key),m=Va(r,e),h=(_,D)=>{_&&Ze(_,i,9,D)},b=(_,D)=>{const c=D[1];h(_,D),fe(_)?_.every(p=>p.length<=1)&&c():_.length<=1&&c()},k={mode:s,persisted:u,beforeEnter(_){let D=A;if(!r.isMounted)if(n)D=E||A;else return;_._leaveCb&&_._leaveCb(!0);const c=m[g];c&&Yt(e,c)&&c.el._leaveCb&&c.el._leaveCb(),h(D,[_])},enter(_){let D=y,c=a,p=T;if(!r.isMounted)if(n)D=o||y,c=f||a,p=l||T;else return;let S=!1;const C=_._enterCb=I=>{S||(S=!0,I?h(p,[_]):h(c,[_]),k.delayedLeave&&k.delayedLeave(),_._enterCb=void 0)};D?b(D,[_,C]):C()},leave(_,D){const c=String(e.key);if(_._enterCb&&_._enterCb(!0),r.isUnmounting)return D();h(v,[_]);let p=!1;const S=_._leaveCb=C=>{p||(p=!0,D(),C?h(R,[_]):h(L,[_]),_._leaveCb=void 0,m[c]===e&&delete m[c])};m[c]=e,d?b(d,[_,S]):S()},clone(_){return ni(_,t,r,i)}};return k}function Un(e){if(Cn(e))return e=Rt(e),e.children=null,e}function as(e){return Cn(e)?e.children?e.children[0]:void 0:e}function pn(e,t){e.shapeFlag&6&&e.component?pn(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Wa(e,t=!1,r){let i=[],n=0;for(let s=0;s<e.length;s++){let u=e[s];const A=r==null?u.key:String(r)+String(u.key!=null?u.key:s);u.type===Me?(u.patchFlag&128&&n++,i=i.concat(Wa(u.children,t,A))):(t||u.type!==it)&&i.push(A!=null?Rt(u,{key:A}):u)}if(n>1)for(let s=0;s<i.length;s++)i[s].patchFlag=-2;return i}function De(e){return he(e)?{setup:e,name:e.name}:e}const wr=e=>!!e.type.__asyncLoader,Cn=e=>e.type.__isKeepAlive,$l={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(e,{slots:t}){const r=kt(),i=r.ctx;if(!i.renderer)return()=>{const l=t.default&&t.default();return l&&l.length===1?l[0]:l};const n=new Map,s=new Set;let u=null;const A=r.suspense,{renderer:{p:y,m:a,um:T,o:{createElement:v}}}=i,d=v("div");i.activate=(l,g,m,h,b)=>{const k=l.component;a(l,g,m,0,A),y(k.vnode,l,g,m,k,A,h,l.slotScopeIds,b),Oe(()=>{k.isDeactivated=!1,k.a&&Ir(k.a);const _=l.props&&l.props.onVnodeMounted;_&&Xe(_,k.parent,l)},A)},i.deactivate=l=>{const g=l.component;a(l,d,null,1,A),Oe(()=>{g.da&&Ir(g.da);const m=l.props&&l.props.onVnodeUnmounted;m&&Xe(m,g.parent,l),g.isDeactivated=!0},A)};function L(l){Gn(l),T(l,r,A,!0)}function R(l){n.forEach((g,m)=>{const h=ci(g.type);h&&(!l||!l(h))&&E(m)})}function E(l){const g=n.get(l);!u||g.type!==u.type?L(g):u&&Gn(u),n.delete(l),s.delete(l)}vt(()=>[e.include,e.exclude],([l,g])=>{l&&R(m=>Cr(l,m)),g&&R(m=>!Cr(g,m))},{flush:"post",deep:!0});let o=null;const f=()=>{o!=null&&n.set(o,jn(r.subTree))};return Ut(f),za(f),Fi(()=>{n.forEach(l=>{const{subTree:g,suspense:m}=r,h=jn(g);if(l.type===h.type){Gn(h);const b=h.component.da;b&&Oe(b,m);return}L(l)})}),()=>{if(o=null,!t.default)return null;const l=t.default(),g=l[0];if(l.length>1)return u=null,l;if(!Wr(g)||!(g.shapeFlag&4)&&!(g.shapeFlag&128))return u=null,g;let m=jn(g);const h=m.type,b=ci(wr(m)?m.type.__asyncResolved||{}:h),{include:k,exclude:_,max:D}=e;if(k&&(!b||!Cr(k,b))||_&&b&&Cr(_,b))return u=m,g;const c=m.key==null?h:m.key,p=n.get(c);return m.el&&(m=Rt(m),g.shapeFlag&128&&(g.ssContent=m)),o=c,p?(m.el=p.el,m.component=p.component,m.transition&&pn(m,m.transition),m.shapeFlag|=512,s.delete(c),s.add(c)):(s.add(c),D&&s.size>parseInt(D,10)&&E(s.values().next().value)),m.shapeFlag|=256,u=m,ja(g.type)?g:m}}},ql=$l;function Cr(e,t){return fe(e)?e.some(r=>Cr(r,t)):Re(e)?e.split(",").includes(t):e.test?e.test(t):!1}function $a(e,t){Ya(e,"a",t)}function qa(e,t){Ya(e,"da",t)}function Ya(e,t,r=we){const i=e.__wdc||(e.__wdc=()=>{let n=r;for(;n;){if(n.isDeactivated)return;n=n.parent}return e()});if(In(t,i,r),r){let n=r.parent;for(;n&&n.parent;)Cn(n.parent.vnode)&&Yl(i,t,r,n),n=n.parent}}function Yl(e,t,r,i){const n=In(t,e,i,!0);ir(()=>{Si(i[t],n)},r)}function Gn(e){let t=e.shapeFlag;t&256&&(t-=256),t&512&&(t-=512),e.shapeFlag=t}function jn(e){return e.shapeFlag&128?e.ssContent:e}function In(e,t,r=we,i=!1){if(r){const n=r[e]||(r[e]=[]),s=t.__weh||(t.__weh=(...u)=>{if(r.isUnmounted)return;Er(),vr(r);const A=Ze(t,r,e,u);return Jt(),Tr(),A});return i?n.unshift(s):n.push(s),s}}const Dt=e=>(t,r=we)=>(!$r||e==="sp")&&In(e,(...i)=>t(...i),r),zl=Dt("bm"),Ut=Dt("m"),Xl=Dt("bu"),za=Dt("u"),Fi=Dt("bum"),ir=Dt("um"),Ql=Dt("sp"),Zl=Dt("rtg"),Jl=Dt("rtc");function eu(e,t=we){In("ec",e,t)}function Ke(e,t){const r=Qe;if(r===null)return e;const i=xn(r)||r.proxy,n=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[u,A,y,a=Se]=t[s];he(u)&&(u={mounted:u,updated:u}),u.deep&&Xt(A),n.push({dir:u,instance:i,value:A,oldValue:void 0,arg:y,modifiers:a})}return e}function Kt(e,t,r,i){const n=e.dirs,s=t&&t.dirs;for(let u=0;u<n.length;u++){const A=n[u];s&&(A.oldValue=s[u].value);let y=A.dir[i];y&&(Er(),Ze(y,r,8,[e.el,A,e,t]),Tr())}}const Mi="components";function tu(e,t){return Qa(Mi,e,!0,t)||e}const Xa=Symbol();function ru(e){return Re(e)?Qa(Mi,e,!1)||e:e||Xa}function Qa(e,t,r=!0,i=!1){const n=Qe||we;if(n){const s=n.type;if(e===Mi){const A=ci(s,!1);if(A&&(A===t||A===mt(t)||A===An(mt(t))))return s}const u=os(n[e]||s[e],t)||os(n.appContext[e],t);return!u&&i?s:u}}function os(e,t){return e&&(e[t]||e[mt(t)]||e[An(mt(t))])}function vn(e,t,r,i){let n;const s=r&&r[i];if(fe(e)||Re(e)){n=new Array(e.length);for(let u=0,A=e.length;u<A;u++)n[u]=t(e[u],u,void 0,s&&s[u])}else if(typeof e=="number"){n=new Array(e);for(let u=0;u<e;u++)n[u]=t(u+1,u,void 0,s&&s[u])}else if(_e(e))if(e[Symbol.iterator])n=Array.from(e,(u,A)=>t(u,A,void 0,s&&s[A]));else{const u=Object.keys(e);n=new Array(u.length);for(let A=0,y=u.length;A<y;A++){const a=u[A];n[A]=t(e[a],a,A,s&&s[A])}}else n=[];return r&&(r[i]=n),n}const ii=e=>e?oo(e)?xn(e)||e.proxy:ii(e.parent):null,mn=Fe(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>ii(e.parent),$root:e=>ii(e.root),$emit:e=>e.emit,$options:e=>Ni(e),$forceUpdate:e=>e.f||(e.f=()=>Pi(e.update)),$nextTick:e=>e.n||(e.n=er.bind(e.proxy)),$watch:e=>Hl.bind(e)}),nu={get({_:e},t){const{ctx:r,setupState:i,data:n,props:s,accessCache:u,type:A,appContext:y}=e;let a;if(t[0]!=="$"){const L=u[t];if(L!==void 0)switch(L){case 1:return i[t];case 2:return n[t];case 4:return r[t];case 3:return s[t]}else{if(i!==Se&&ve(i,t))return u[t]=1,i[t];if(n!==Se&&ve(n,t))return u[t]=2,n[t];if((a=e.propsOptions[0])&&ve(a,t))return u[t]=3,s[t];if(r!==Se&&ve(r,t))return u[t]=4,r[t];si&&(u[t]=0)}}const T=mn[t];let v,d;if(T)return t==="$attrs"&&$e(e,"get",t),T(e);if((v=A.__cssModules)&&(v=v[t]))return v;if(r!==Se&&ve(r,t))return u[t]=4,r[t];if(d=y.config.globalProperties,ve(d,t))return d[t]},set({_:e},t,r){const{data:i,setupState:n,ctx:s}=e;return n!==Se&&ve(n,t)?(n[t]=r,!0):i!==Se&&ve(i,t)?(i[t]=r,!0):ve(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(s[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:i,appContext:n,propsOptions:s}},u){let A;return!!r[u]||e!==Se&&ve(e,u)||t!==Se&&ve(t,u)||(A=s[0])&&ve(A,u)||ve(i,u)||ve(mn,u)||ve(n.config.globalProperties,u)},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:ve(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};let si=!0;function iu(e){const t=Ni(e),r=e.proxy,i=e.ctx;si=!1,t.beforeCreate&&ls(t.beforeCreate,e,"bc");const{data:n,computed:s,methods:u,watch:A,provide:y,inject:a,created:T,beforeMount:v,mounted:d,beforeUpdate:L,updated:R,activated:E,deactivated:o,beforeDestroy:f,beforeUnmount:l,destroyed:g,unmounted:m,render:h,renderTracked:b,renderTriggered:k,errorCaptured:_,serverPrefetch:D,expose:c,inheritAttrs:p,components:S,directives:C,filters:I}=t;if(a&&su(a,i,null,e.appContext.config.unwrapInjectedRef),u)for(const x in u){const P=u[x];he(P)&&(i[x]=P.bind(r))}if(n){const x=n.call(r,r);_e(x)&&(e.data=qe(x))}if(si=!0,s)for(const x in s){const P=s[x],F=he(P)?P.bind(r,r):he(P.get)?P.get.bind(r,r):nt,N=!he(P)&&he(P.set)?P.set.bind(r):nt,U=Ae({get:F,set:N});Object.defineProperty(i,x,{enumerable:!0,configurable:!0,get:()=>U.value,set:j=>U.value=j})}if(A)for(const x in A)Za(A[x],i,r,x);if(y){const x=he(y)?y.call(r):y;Reflect.ownKeys(x).forEach(P=>{hr(P,x[P])})}T&&ls(T,e,"c");function O(x,P){fe(P)?P.forEach(F=>x(F.bind(r))):P&&x(P.bind(r))}if(O(zl,v),O(Ut,d),O(Xl,L),O(za,R),O($a,E),O(qa,o),O(eu,_),O(Jl,b),O(Zl,k),O(Fi,l),O(ir,m),O(Ql,D),fe(c))if(c.length){const x=e.exposed||(e.exposed={});c.forEach(P=>{Object.defineProperty(x,P,{get:()=>r[P],set:F=>r[P]=F})})}else e.exposed||(e.exposed={});h&&e.render===nt&&(e.render=h),p!=null&&(e.inheritAttrs=p),S&&(e.components=S),C&&(e.directives=C)}function su(e,t,r=nt,i=!1){fe(e)&&(e=ai(e));for(const n in e){const s=e[n];let u;_e(s)?"default"in s?u=Ve(s.from||n,s.default,!0):u=Ve(s.from||n):u=Ve(s),Pe(u)&&i?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>u.value,set:A=>u.value=A}):t[n]=u}}function ls(e,t,r){Ze(fe(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,r)}function Za(e,t,r,i){const n=i.includes(".")?Ka(r,i):()=>r[i];if(Re(e)){const s=t[e];he(s)&&vt(n,s)}else if(he(e))vt(n,e.bind(r));else if(_e(e))if(fe(e))e.forEach(s=>Za(s,t,r,i));else{const s=he(e.handler)?e.handler.bind(r):t[e.handler];he(s)&&vt(n,s,e)}}function Ni(e){const t=e.type,{mixins:r,extends:i}=t,{mixins:n,optionsCache:s,config:{optionMergeStrategies:u}}=e.appContext,A=s.get(t);let y;return A?y=A:!n.length&&!r&&!i?y=t:(y={},n.length&&n.forEach(a=>yn(y,a,u,!0)),yn(y,t,u)),_e(t)&&s.set(t,y),y}function yn(e,t,r,i=!1){const{mixins:n,extends:s}=t;s&&yn(e,s,r,!0),n&&n.forEach(u=>yn(e,u,r,!0));for(const u in t)if(!(i&&u==="expose")){const A=au[u]||r&&r[u];e[u]=A?A(e[u],t[u]):t[u]}return e}const au={data:us,props:$t,emits:$t,methods:$t,computed:$t,beforeCreate:Ue,created:Ue,beforeMount:Ue,mounted:Ue,beforeUpdate:Ue,updated:Ue,beforeDestroy:Ue,beforeUnmount:Ue,destroyed:Ue,unmounted:Ue,activated:Ue,deactivated:Ue,errorCaptured:Ue,serverPrefetch:Ue,components:$t,directives:$t,watch:lu,provide:us,inject:ou};function us(e,t){return t?e?function(){return Fe(he(e)?e.call(this,this):e,he(t)?t.call(this,this):t)}:t:e}function ou(e,t){return $t(ai(e),ai(t))}function ai(e){if(fe(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function Ue(e,t){return e?[...new Set([].concat(e,t))]:t}function $t(e,t){return e?Fe(Fe(Object.create(null),e),t):t}function lu(e,t){if(!e)return t;if(!t)return e;const r=Fe(Object.create(null),e);for(const i in t)r[i]=Ue(e[i],t[i]);return r}function uu(e,t,r,i=!1){const n={},s={};fn(s,wn,1),e.propsDefaults=Object.create(null),Ja(e,t,n,s);for(const u in e.propsOptions[0])u in n||(n[u]=void 0);r?e.props=i?n:_l(n):e.type.props?e.props=n:e.props=s,e.attrs=s}function cu(e,t,r,i){const{props:n,attrs:s,vnode:{patchFlag:u}}=e,A=ye(n),[y]=e.propsOptions;let a=!1;if((i||u>0)&&!(u&16)){if(u&8){const T=e.vnode.dynamicProps;for(let v=0;v<T.length;v++){let d=T[v];if(Rn(e.emitsOptions,d))continue;const L=t[d];if(y)if(ve(s,d))L!==s[d]&&(s[d]=L,a=!0);else{const R=mt(d);n[R]=oi(y,A,R,L,e,!1)}else L!==s[d]&&(s[d]=L,a=!0)}}}else{Ja(e,t,n,s)&&(a=!0);let T;for(const v in A)(!t||!ve(t,v)&&((T=tr(v))===v||!ve(t,T)))&&(y?r&&(r[v]!==void 0||r[T]!==void 0)&&(n[v]=oi(y,A,v,void 0,e,!0)):delete n[v]);if(s!==A)for(const v in s)(!t||!ve(t,v)&&!0)&&(delete s[v],a=!0)}a&&Lt(e,"set","$attrs")}function Ja(e,t,r,i){const[n,s]=e.propsOptions;let u=!1,A;if(t)for(let y in t){if(ln(y))continue;const a=t[y];let T;n&&ve(n,T=mt(y))?!s||!s.includes(T)?r[T]=a:(A||(A={}))[T]=a:Rn(e.emitsOptions,y)||(!(y in i)||a!==i[y])&&(i[y]=a,u=!0)}if(s){const y=ye(r),a=A||Se;for(let T=0;T<s.length;T++){const v=s[T];r[v]=oi(n,y,v,a[v],e,!ve(a,v))}}return u}function oi(e,t,r,i,n,s){const u=e[r];if(u!=null){const A=ve(u,"default");if(A&&i===void 0){const y=u.default;if(u.type!==Function&&he(y)){const{propsDefaults:a}=n;r in a?i=a[r]:(vr(n),i=a[r]=y.call(null,t),Jt())}else i=y}u[0]&&(s&&!A?i=!1:u[1]&&(i===""||i===tr(r))&&(i=!0))}return i}function eo(e,t,r=!1){const i=t.propsCache,n=i.get(e);if(n)return n;const s=e.props,u={},A=[];let y=!1;if(!he(e)){const T=v=>{y=!0;const[d,L]=eo(v,t,!0);Fe(u,d),L&&A.push(...L)};!r&&t.mixins.length&&t.mixins.forEach(T),e.extends&&T(e.extends),e.mixins&&e.mixins.forEach(T)}if(!s&&!y)return _e(e)&&i.set(e,ur),ur;if(fe(s))for(let T=0;T<s.length;T++){const v=mt(s[T]);cs(v)&&(u[v]=Se)}else if(s)for(const T in s){const v=mt(T);if(cs(v)){const d=s[T],L=u[v]=fe(d)||he(d)?{type:d}:d;if(L){const R=hs(Boolean,L.type),E=hs(String,L.type);L[0]=R>-1,L[1]=E<0||R<E,(R>-1||ve(L,"default"))&&A.push(v)}}}const a=[u,A];return _e(e)&&i.set(e,a),a}function cs(e){return e[0]!=="$"}function ds(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function fs(e,t){return ds(e)===ds(t)}function hs(e,t){return fe(t)?t.findIndex(r=>fs(r,e)):he(t)&&fs(t,e)?0:-1}const to=e=>e[0]==="_"||e==="$stable",Bi=e=>fe(e)?e.map(dt):[dt(e)],du=(e,t,r)=>{if(t._n)return t;const i=Hr((...n)=>Bi(t(...n)),r);return i._c=!1,i},ro=(e,t,r)=>{const i=e._ctx;for(const n in e){if(to(n))continue;const s=e[n];if(he(s))t[n]=du(n,s,i);else if(s!=null){const u=Bi(s);t[n]=()=>u}}},no=(e,t)=>{const r=Bi(t);e.slots.default=()=>r},fu=(e,t)=>{if(e.vnode.shapeFlag&32){const r=t._;r?(e.slots=ye(t),fn(t,"_",r)):ro(t,e.slots={})}else e.slots={},t&&no(e,t);fn(e.slots,wn,1)},hu=(e,t,r)=>{const{vnode:i,slots:n}=e;let s=!0,u=Se;if(i.shapeFlag&32){const A=t._;A?r&&A===1?s=!1:(Fe(n,t),!r&&A===1&&delete n._):(s=!t.$stable,ro(t,n)),u=t}else t&&(no(e,t),u={default:1});if(s)for(const A in n)!to(A)&&!(A in u)&&delete n[A]};function io(){return{app:null,config:{isNativeTag:Vo,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let gu=0;function pu(e,t){return function(i,n=null){he(i)||(i=Object.assign({},i)),n!=null&&!_e(n)&&(n=null);const s=io(),u=new Set;let A=!1;const y=s.app={_uid:gu++,_component:i,_props:n,_container:null,_context:s,_instance:null,version:Pu,get config(){return s.config},set config(a){},use(a,...T){return u.has(a)||(a&&he(a.install)?(u.add(a),a.install(y,...T)):he(a)&&(u.add(a),a(y,...T))),y},mixin(a){return s.mixins.includes(a)||s.mixins.push(a),y},component(a,T){return T?(s.components[a]=T,y):s.components[a]},directive(a,T){return T?(s.directives[a]=T,y):s.directives[a]},mount(a,T,v){if(!A){const d=ne(i,n);return d.appContext=s,T&&t?t(d,a):e(d,a,v),A=!0,y._container=a,a.__vue_app__=y,xn(d.component)||d.component.proxy}},unmount(){A&&(e(null,y._container),delete y._container.__vue_app__)},provide(a,T){return s.provides[a]=T,y}};return y}}function li(e,t,r,i,n=!1){if(fe(e)){e.forEach((d,L)=>li(d,t&&(fe(t)?t[L]:t),r,i,n));return}if(wr(i)&&!n)return;const s=i.shapeFlag&4?xn(i.component)||i.component.proxy:i.el,u=n?null:s,{i:A,r:y}=e,a=t&&t.r,T=A.refs===Se?A.refs={}:A.refs,v=A.setupState;if(a!=null&&a!==y&&(Re(a)?(T[a]=null,ve(v,a)&&(v[a]=null)):Pe(a)&&(a.value=null)),he(y))Nt(y,A,12,[u,T]);else{const d=Re(y),L=Pe(y);if(d||L){const R=()=>{if(e.f){const E=d?ve(v,y)?v[y]:T[y]:y.value;n?fe(E)&&Si(E,s):fe(E)?E.includes(s)||E.push(s):d?(T[y]=[s],ve(v,y)&&(v[y]=T[y])):(y.value=[s],e.k&&(T[e.k]=y.value))}else d?(T[y]=u,ve(v,y)&&(v[y]=u)):L&&(y.value=u,e.k&&(T[e.k]=u))};u?(R.id=-1,Oe(R,r)):R()}}}const Oe=Gl;function vu(e){return mu(e)}function mu(e,t){const r=Xo();r.__VUE__=!0;const{insert:i,remove:n,patchProp:s,createElement:u,createText:A,createComment:y,setText:a,setElementText:T,parentNode:v,nextSibling:d,setScopeId:L=nt,insertStaticContent:R}=e,E=(M,B,K,H=null,q=null,Q=null,J=!1,Z=null,te=!!B.dynamicChildren)=>{if(M===B)return;M&&!Yt(M,B)&&(H=$(M),j(M,q,Q,!0),M=null),B.patchFlag===-2&&(te=!1,B.dynamicChildren=null);const{type:X,ref:le,shapeFlag:ie}=B;switch(X){case Gi:o(M,B,K,H);break;case it:f(M,B,K,H);break;case Or:M==null&&l(B,K,H,J);break;case Me:S(M,B,K,H,q,Q,J,Z,te);break;default:ie&1?h(M,B,K,H,q,Q,J,Z,te):ie&6?C(M,B,K,H,q,Q,J,Z,te):(ie&64||ie&128)&&X.process(M,B,K,H,q,Q,J,Z,te,re)}le!=null&&q&&li(le,M&&M.ref,Q,B||M,!B)},o=(M,B,K,H)=>{if(M==null)i(B.el=A(B.children),K,H);else{const q=B.el=M.el;B.children!==M.children&&a(q,B.children)}},f=(M,B,K,H)=>{M==null?i(B.el=y(B.children||""),K,H):B.el=M.el},l=(M,B,K,H)=>{[M.el,M.anchor]=R(M.children,B,K,H,M.el,M.anchor)},g=({el:M,anchor:B},K,H)=>{let q;for(;M&&M!==B;)q=d(M),i(M,K,H),M=q;i(B,K,H)},m=({el:M,anchor:B})=>{let K;for(;M&&M!==B;)K=d(M),n(M),M=K;n(B)},h=(M,B,K,H,q,Q,J,Z,te)=>{J=J||B.type==="svg",M==null?b(B,K,H,q,Q,J,Z,te):D(M,B,q,Q,J,Z,te)},b=(M,B,K,H,q,Q,J,Z)=>{let te,X;const{type:le,props:ie,shapeFlag:ae,transition:ce,dirs:de}=M;if(te=M.el=u(M.type,Q,ie&&ie.is,ie),ae&8?T(te,M.children):ae&16&&_(M.children,te,null,H,q,Q&&le!=="foreignObject",J,Z),de&&Kt(M,null,H,"created"),ie){for(const pe in ie)pe!=="value"&&!ln(pe)&&s(te,pe,null,ie[pe],Q,M.children,H,q,W);"value"in ie&&s(te,"value",null,ie.value),(X=ie.onVnodeBeforeMount)&&Xe(X,H,M)}k(te,M,M.scopeId,J,H),de&&Kt(M,null,H,"beforeMount");const ge=(!q||q&&!q.pendingBranch)&&ce&&!ce.persisted;ge&&ce.beforeEnter(te),i(te,B,K),((X=ie&&ie.onVnodeMounted)||ge||de)&&Oe(()=>{X&&Xe(X,H,M),ge&&ce.enter(te),de&&Kt(M,null,H,"mounted")},q)},k=(M,B,K,H,q)=>{if(K&&L(M,K),H)for(let Q=0;Q<H.length;Q++)L(M,H[Q]);if(q){let Q=q.subTree;if(B===Q){const J=q.vnode;k(M,J,J.scopeId,J.slotScopeIds,q.parent)}}},_=(M,B,K,H,q,Q,J,Z,te=0)=>{for(let X=te;X<M.length;X++){const le=M[X]=Z?Pt(M[X]):dt(M[X]);E(null,le,B,K,H,q,Q,J,Z)}},D=(M,B,K,H,q,Q,J)=>{const Z=B.el=M.el;let{patchFlag:te,dynamicChildren:X,dirs:le}=B;te|=M.patchFlag&16;const ie=M.props||Se,ae=B.props||Se;let ce;K&&Ht(K,!1),(ce=ae.onVnodeBeforeUpdate)&&Xe(ce,K,B,M),le&&Kt(B,M,K,"beforeUpdate"),K&&Ht(K,!0);const de=q&&B.type!=="foreignObject";if(X?c(M.dynamicChildren,X,Z,K,H,de,Q):J||P(M,B,Z,null,K,H,de,Q,!1),te>0){if(te&16)p(Z,B,ie,ae,K,H,q);else if(te&2&&ie.class!==ae.class&&s(Z,"class",null,ae.class,q),te&4&&s(Z,"style",ie.style,ae.style,q),te&8){const ge=B.dynamicProps;for(let pe=0;pe<ge.length;pe++){const Te=ge[pe],Le=ie[Te],Ye=ae[Te];(Ye!==Le||Te==="value")&&s(Z,Te,Le,Ye,q,M.children,K,H,W)}}te&1&&M.children!==B.children&&T(Z,B.children)}else!J&&X==null&&p(Z,B,ie,ae,K,H,q);((ce=ae.onVnodeUpdated)||le)&&Oe(()=>{ce&&Xe(ce,K,B,M),le&&Kt(B,M,K,"updated")},H)},c=(M,B,K,H,q,Q,J)=>{for(let Z=0;Z<B.length;Z++){const te=M[Z],X=B[Z],le=te.el&&(te.type===Me||!Yt(te,X)||te.shapeFlag&70)?v(te.el):K;E(te,X,le,null,H,q,Q,J,!0)}},p=(M,B,K,H,q,Q,J)=>{if(K!==H){if(K!==Se)for(const Z in K)!ln(Z)&&!(Z in H)&&s(M,Z,K[Z],null,J,B.children,q,Q,W);for(const Z in H){if(ln(Z))continue;const te=H[Z],X=K[Z];te!==X&&Z!=="value"&&s(M,Z,X,te,J,B.children,q,Q,W)}"value"in H&&s(M,"value",K.value,H.value)}},S=(M,B,K,H,q,Q,J,Z,te)=>{const X=B.el=M?M.el:A(""),le=B.anchor=M?M.anchor:A("");let{patchFlag:ie,dynamicChildren:ae,slotScopeIds:ce}=B;ce&&(Z=Z?Z.concat(ce):ce),M==null?(i(X,K,H),i(le,K,H),_(B.children,K,le,q,Q,J,Z,te)):ie>0&&ie&64&&ae&&M.dynamicChildren?(c(M.dynamicChildren,ae,K,q,Q,J,Z),(B.key!=null||q&&B===q.subTree)&&Ui(M,B,!0)):P(M,B,K,le,q,Q,J,Z,te)},C=(M,B,K,H,q,Q,J,Z,te)=>{B.slotScopeIds=Z,M==null?B.shapeFlag&512?q.ctx.activate(B,K,H,J,te):I(B,K,H,q,Q,J,te):w(M,B,te)},I=(M,B,K,H,q,Q,J)=>{const Z=M.component=Du(M,H,q);if(Cn(M)&&(Z.ctx.renderer=re),ku(Z),Z.asyncDep){if(q&&q.registerDep(Z,O),!M.el){const te=Z.subTree=ne(it);f(null,te,B,K)}return}O(Z,M,B,K,q,Q,J)},w=(M,B,K)=>{const H=B.component=M.component;if(Bl(M,B,K))if(H.asyncDep&&!H.asyncResolved){x(H,B,K);return}else H.next=B,xl(H.update),H.update();else B.el=M.el,H.vnode=B},O=(M,B,K,H,q,Q,J)=>{const Z=()=>{if(M.isMounted){let{next:le,bu:ie,u:ae,parent:ce,vnode:de}=M,ge=le,pe;Ht(M,!1),le?(le.el=de.el,x(M,le,J)):le=de,ie&&Ir(ie),(pe=le.props&&le.props.onVnodeBeforeUpdate)&&Xe(pe,ce,le,de),Ht(M,!0);const Te=Bn(M),Le=M.subTree;M.subTree=Te,E(Le,Te,v(Le.el),$(Le),M,q,Q),le.el=Te.el,ge===null&&Ul(M,Te.el),ae&&Oe(ae,q),(pe=le.props&&le.props.onVnodeUpdated)&&Oe(()=>Xe(pe,ce,le,de),q)}else{let le;const{el:ie,props:ae}=B,{bm:ce,m:de,parent:ge}=M,pe=wr(B);if(Ht(M,!1),ce&&Ir(ce),!pe&&(le=ae&&ae.onVnodeBeforeMount)&&Xe(le,ge,B),Ht(M,!0),ie&&oe){const Te=()=>{M.subTree=Bn(M),oe(ie,M.subTree,M,q,null)};pe?B.type.__asyncLoader().then(()=>!M.isUnmounted&&Te()):Te()}else{const Te=M.subTree=Bn(M);E(null,Te,K,H,M,q,Q),B.el=Te.el}if(de&&Oe(de,q),!pe&&(le=ae&&ae.onVnodeMounted)){const Te=B;Oe(()=>Xe(le,ge,Te),q)}(B.shapeFlag&256||ge&&wr(ge.vnode)&&ge.vnode.shapeFlag&256)&&M.a&&Oe(M.a,q),M.isMounted=!0,B=K=H=null}},te=M.effect=new Ri(Z,()=>Pi(X),M.scope),X=M.update=()=>te.run();X.id=M.uid,Ht(M,!0),X()},x=(M,B,K)=>{B.component=M;const H=M.vnode.props;M.vnode=B,M.next=null,cu(M,B.props,H,K),hu(M,B.children,K),Er(),ns(),Tr()},P=(M,B,K,H,q,Q,J,Z,te=!1)=>{const X=M&&M.children,le=M?M.shapeFlag:0,ie=B.children,{patchFlag:ae,shapeFlag:ce}=B;if(ae>0){if(ae&128){N(X,ie,K,H,q,Q,J,Z,te);return}else if(ae&256){F(X,ie,K,H,q,Q,J,Z,te);return}}ce&8?(le&16&&W(X,q,Q),ie!==X&&T(K,ie)):le&16?ce&16?N(X,ie,K,H,q,Q,J,Z,te):W(X,q,Q,!0):(le&8&&T(K,""),ce&16&&_(ie,K,H,q,Q,J,Z,te))},F=(M,B,K,H,q,Q,J,Z,te)=>{M=M||ur,B=B||ur;const X=M.length,le=B.length,ie=Math.min(X,le);let ae;for(ae=0;ae<ie;ae++){const ce=B[ae]=te?Pt(B[ae]):dt(B[ae]);E(M[ae],ce,K,null,q,Q,J,Z,te)}X>le?W(M,q,Q,!0,!1,ie):_(B,K,H,q,Q,J,Z,te,ie)},N=(M,B,K,H,q,Q,J,Z,te)=>{let X=0;const le=B.length;let ie=M.length-1,ae=le-1;for(;X<=ie&&X<=ae;){const ce=M[X],de=B[X]=te?Pt(B[X]):dt(B[X]);if(Yt(ce,de))E(ce,de,K,null,q,Q,J,Z,te);else break;X++}for(;X<=ie&&X<=ae;){const ce=M[ie],de=B[ae]=te?Pt(B[ae]):dt(B[ae]);if(Yt(ce,de))E(ce,de,K,null,q,Q,J,Z,te);else break;ie--,ae--}if(X>ie){if(X<=ae){const ce=ae+1,de=ce<le?B[ce].el:H;for(;X<=ae;)E(null,B[X]=te?Pt(B[X]):dt(B[X]),K,de,q,Q,J,Z,te),X++}}else if(X>ae)for(;X<=ie;)j(M[X],q,Q,!0),X++;else{const ce=X,de=X,ge=new Map;for(X=de;X<=ae;X++){const ke=B[X]=te?Pt(B[X]):dt(B[X]);ke.key!=null&&ge.set(ke.key,X)}let pe,Te=0;const Le=ae-de+1;let Ye=!1,Et=0;const Be=new Array(Le);for(X=0;X<Le;X++)Be[X]=0;for(X=ce;X<=ie;X++){const ke=M[X];if(Te>=Le){j(ke,q,Q,!0);continue}let Ie;if(ke.key!=null)Ie=ge.get(ke.key);else for(pe=de;pe<=ae;pe++)if(Be[pe-de]===0&&Yt(ke,B[pe])){Ie=pe;break}Ie===void 0?j(ke,q,Q,!0):(Be[Ie-de]=X+1,Ie>=Et?Et=Ie:Ye=!0,E(ke,B[Ie],K,null,q,Q,J,Z,te),Te++)}const Ct=Ye?yu(Be):ur;for(pe=Ct.length-1,X=Le-1;X>=0;X--){const ke=de+X,Ie=B[ke],Je=ke+1<le?B[ke+1].el:H;Be[X]===0?E(null,Ie,K,Je,q,Q,J,Z,te):Ye&&(pe<0||X!==Ct[pe]?U(Ie,K,Je,2):pe--)}}},U=(M,B,K,H,q=null)=>{const{el:Q,type:J,transition:Z,children:te,shapeFlag:X}=M;if(X&6){U(M.component.subTree,B,K,H);return}if(X&128){M.suspense.move(B,K,H);return}if(X&64){J.move(M,B,K,re);return}if(J===Me){i(Q,B,K);for(let ie=0;ie<te.length;ie++)U(te[ie],B,K,H);i(M.anchor,B,K);return}if(J===Or){g(M,B,K);return}if(H!==2&&X&1&&Z)if(H===0)Z.beforeEnter(Q),i(Q,B,K),Oe(()=>Z.enter(Q),q);else{const{leave:ie,delayLeave:ae,afterLeave:ce}=Z,de=()=>i(Q,B,K),ge=()=>{ie(Q,()=>{de(),ce&&ce()})};ae?ae(Q,de,ge):ge()}else i(Q,B,K)},j=(M,B,K,H=!1,q=!1)=>{const{type:Q,props:J,ref:Z,children:te,dynamicChildren:X,shapeFlag:le,patchFlag:ie,dirs:ae}=M;if(Z!=null&&li(Z,null,K,M,!0),le&256){B.ctx.deactivate(M);return}const ce=le&1&&ae,de=!wr(M);let ge;if(de&&(ge=J&&J.onVnodeBeforeUnmount)&&Xe(ge,B,M),le&6)G(M.component,K,H);else{if(le&128){M.suspense.unmount(K,H);return}ce&&Kt(M,null,B,"beforeUnmount"),le&64?M.type.remove(M,B,K,q,re,H):X&&(Q!==Me||ie>0&&ie&64)?W(X,B,K,!1,!0):(Q===Me&&ie&384||!q&&le&16)&&W(te,B,K),H&&V(M)}(de&&(ge=J&&J.onVnodeUnmounted)||ce)&&Oe(()=>{ge&&Xe(ge,B,M),ce&&Kt(M,null,B,"unmounted")},K)},V=M=>{const{type:B,el:K,anchor:H,transition:q}=M;if(B===Me){z(K,H);return}if(B===Or){m(M);return}const Q=()=>{n(K),q&&!q.persisted&&q.afterLeave&&q.afterLeave()};if(M.shapeFlag&1&&q&&!q.persisted){const{leave:J,delayLeave:Z}=q,te=()=>J(K,Q);Z?Z(M.el,Q,te):te()}else Q()},z=(M,B)=>{let K;for(;M!==B;)K=d(M),n(M),M=K;n(B)},G=(M,B,K)=>{const{bum:H,scope:q,update:Q,subTree:J,um:Z}=M;H&&Ir(H),q.stop(),Q&&(Q.active=!1,j(J,M,B,K)),Z&&Oe(Z,B),Oe(()=>{M.isUnmounted=!0},B),B&&B.pendingBranch&&!B.isUnmounted&&M.asyncDep&&!M.asyncResolved&&M.suspenseId===B.pendingId&&(B.deps--,B.deps===0&&B.resolve())},W=(M,B,K,H=!1,q=!1,Q=0)=>{for(let J=Q;J<M.length;J++)j(M[J],B,K,H,q)},$=M=>M.shapeFlag&6?$(M.component.subTree):M.shapeFlag&128?M.suspense.next():d(M.anchor||M.el),Y=(M,B,K)=>{M==null?B._vnode&&j(B._vnode,null,null,!0):E(B._vnode||null,M,B,null,null,null,K),ns(),Ba(),B._vnode=M},re={p:E,um:j,m:U,r:V,mt:I,mc:_,pc:P,pbc:c,n:$,o:e};let ue,oe;return t&&([ue,oe]=t(re)),{render:Y,hydrate:ue,createApp:pu(Y,ue)}}function Ht({effect:e,update:t},r){e.allowRecurse=t.allowRecurse=r}function Ui(e,t,r=!1){const i=e.children,n=t.children;if(fe(i)&&fe(n))for(let s=0;s<i.length;s++){const u=i[s];let A=n[s];A.shapeFlag&1&&!A.dynamicChildren&&((A.patchFlag<=0||A.patchFlag===32)&&(A=n[s]=Pt(n[s]),A.el=u.el),r||Ui(u,A))}}function yu(e){const t=e.slice(),r=[0];let i,n,s,u,A;const y=e.length;for(i=0;i<y;i++){const a=e[i];if(a!==0){if(n=r[r.length-1],e[n]<a){t[i]=n,r.push(i);continue}for(s=0,u=r.length-1;s<u;)A=s+u>>1,e[r[A]]<a?s=A+1:u=A;a<e[r[s]]&&(s>0&&(t[i]=r[s-1]),r[s]=i)}}for(s=r.length,u=r[s-1];s-- >0;)r[s]=u,u=t[u];return r}const Eu=e=>e.__isTeleport,xr=e=>e&&(e.disabled||e.disabled===""),gs=e=>typeof SVGElement<"u"&&e instanceof SVGElement,ui=(e,t)=>{const r=e&&e.to;return Re(r)?t?t(r):null:r},Tu={__isTeleport:!0,process(e,t,r,i,n,s,u,A,y,a){const{mc:T,pc:v,pbc:d,o:{insert:L,querySelector:R,createText:E,createComment:o}}=a,f=xr(t.props);let{shapeFlag:l,children:g,dynamicChildren:m}=t;if(e==null){const h=t.el=E(""),b=t.anchor=E("");L(h,r,i),L(b,r,i);const k=t.target=ui(t.props,R),_=t.targetAnchor=E("");k&&(L(_,k),u=u||gs(k));const D=(c,p)=>{l&16&&T(g,c,p,n,s,u,A,y)};f?D(r,b):k&&D(k,_)}else{t.el=e.el;const h=t.anchor=e.anchor,b=t.target=e.target,k=t.targetAnchor=e.targetAnchor,_=xr(e.props),D=_?r:b,c=_?h:k;if(u=u||gs(b),m?(d(e.dynamicChildren,m,D,n,s,u,A),Ui(e,t,!0)):y||v(e,t,D,c,n,s,u,A,!1),f)_||an(t,r,h,a,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const p=t.target=ui(t.props,R);p&&an(t,p,null,a,0)}else _&&an(t,b,k,a,1)}},remove(e,t,r,i,{um:n,o:{remove:s}},u){const{shapeFlag:A,children:y,anchor:a,targetAnchor:T,target:v,props:d}=e;if(v&&s(T),(u||!xr(d))&&(s(a),A&16))for(let L=0;L<y.length;L++){const R=y[L];n(R,t,r,!0,!!R.dynamicChildren)}},move:an,hydrate:bu};function an(e,t,r,{o:{insert:i},m:n},s=2){s===0&&i(e.targetAnchor,t,r);const{el:u,anchor:A,shapeFlag:y,children:a,props:T}=e,v=s===2;if(v&&i(u,t,r),(!v||xr(T))&&y&16)for(let d=0;d<a.length;d++)n(a[d],t,r,2);v&&i(A,t,r)}function bu(e,t,r,i,n,s,{o:{nextSibling:u,parentNode:A,querySelector:y}},a){const T=t.target=ui(t.props,y);if(T){const v=T._lpa||T.firstChild;if(t.shapeFlag&16)if(xr(t.props))t.anchor=a(u(e),t,A(e),r,i,n,s),t.targetAnchor=v;else{t.anchor=u(e);let d=v;for(;d;)if(d=u(d),d&&d.nodeType===8&&d.data==="teleport anchor"){t.targetAnchor=d,T._lpa=t.targetAnchor&&u(t.targetAnchor);break}a(v,t,T,r,i,n,s)}}return t.anchor&&u(t.anchor)}const mg=Tu,Me=Symbol(void 0),Gi=Symbol(void 0),it=Symbol(void 0),Or=Symbol(void 0),Pr=[];let rt=null;function me(e=!1){Pr.push(rt=e?null:[])}function Su(){Pr.pop(),rt=Pr[Pr.length-1]||null}let Vr=1;function ps(e){Vr+=e}function so(e){return e.dynamicChildren=Vr>0?rt||ur:null,Su(),Vr>0&&rt&&rt.push(e),e}function be(e,t,r,i,n,s){return so(se(e,t,r,i,n,s,!0))}function Fr(e,t,r,i,n){return so(ne(e,t,r,i,n,!0))}function Wr(e){return e?e.__v_isVNode===!0:!1}function Yt(e,t){return e.type===t.type&&e.key===t.key}const wn="__vInternal",ao=({key:e})=>e!=null?e:null,un=({ref:e,ref_key:t,ref_for:r})=>e!=null?Re(e)||Pe(e)||he(e)?{i:Qe,r:e,k:t,f:!!r}:e:null;function se(e,t=null,r=null,i=0,n=null,s=e===Me?0:1,u=!1,A=!1){const y={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&ao(t),ref:t&&un(t),scopeId:Dn,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:i,dynamicProps:n,dynamicChildren:null,appContext:null};return A?(ji(y,r),s&128&&e.normalize(y)):r&&(y.shapeFlag|=Re(r)?8:16),Vr>0&&!u&&rt&&(y.patchFlag>0||s&6)&&y.patchFlag!==32&&rt.push(y),y}const ne=Au;function Au(e,t=null,r=null,i=0,n=null,s=!1){if((!e||e===Xa)&&(e=it),Wr(e)){const A=Rt(e,t,!0);return r&&ji(A,r),Vr>0&&!s&&rt&&(A.shapeFlag&6?rt[rt.indexOf(e)]=A:rt.push(A)),A.patchFlag|=-2,A}if(wu(e)&&(e=e.__vccOpts),t){t=_u(t);let{class:A,style:y}=t;A&&!Re(A)&&(t.class=pt(A)),_e(y)&&(Ia(y)&&!fe(y)&&(y=Fe({},y)),t.style=gt(y))}const u=Re(e)?1:ja(e)?128:Eu(e)?64:_e(e)?4:he(e)?2:0;return se(e,t,r,i,n,u,s,!0)}function _u(e){return e?Ia(e)||wn in e?Fe({},e):e:null}function Rt(e,t,r=!1){const{props:i,ref:n,patchFlag:s,children:u}=e,A=t?Qr(i||{},t):i;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:A,key:A&&ao(A),ref:t&&t.ref?r&&n?fe(n)?n.concat(un(t)):[n,un(t)]:un(t):n,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:u,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Me?s===-1?16:s|16:s,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Rt(e.ssContent),ssFallback:e.ssFallback&&Rt(e.ssFallback),el:e.el,anchor:e.anchor}}function st(e=" ",t=0){return ne(Gi,null,e,t)}function yg(e,t){const r=ne(Or,null,e);return r.staticCount=t,r}function Ge(e="",t=!1){return t?(me(),Fr(it,null,e)):ne(it,null,e)}function dt(e){return e==null||typeof e=="boolean"?ne(it):fe(e)?ne(Me,null,e.slice()):typeof e=="object"?Pt(e):ne(Gi,null,String(e))}function Pt(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Rt(e)}function ji(e,t){let r=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(fe(t))r=16;else if(typeof t=="object")if(i&65){const n=t.default;n&&(n._c&&(n._d=!1),ji(e,n()),n._c&&(n._d=!0));return}else{r=32;const n=t._;!n&&!(wn in t)?t._ctx=Qe:n===3&&Qe&&(Qe.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else he(t)?(t={default:t,_ctx:Qe},r=32):(t=String(t),i&64?(r=16,t=[st(t)]):r=8);e.children=t,e.shapeFlag|=r}function Qr(...e){const t={};for(let r=0;r<e.length;r++){const i=e[r];for(const n in i)if(n==="class")t.class!==i.class&&(t.class=pt([t.class,i.class]));else if(n==="style")t.style=gt([t.style,i.style]);else if(Tn(n)){const s=t[n],u=i[n];u&&s!==u&&!(fe(s)&&s.includes(u))&&(t[n]=s?[].concat(s,u):u)}else n!==""&&(t[n]=i[n])}return t}function Xe(e,t,r,i=null){Ze(e,t,7,[r,i])}const Lu=io();let Ru=0;function Du(e,t,r){const i=e.type,n=(t?t.appContext:e.appContext)||Lu,s={uid:Ru++,vnode:e,type:i,parent:t,appContext:n,root:null,next:null,subTree:null,effect:null,update:null,scope:new ya(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(n.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:eo(i,n),emitsOptions:Ga(i,n),emit:null,emitted:null,propsDefaults:Se,inheritAttrs:i.inheritAttrs,ctx:Se,data:Se,props:Se,attrs:Se,slots:Se,refs:Se,setupState:Se,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=t?t.root:s,s.emit=Fl.bind(null,s),e.ce&&e.ce(s),s}let we=null;const kt=()=>we||Qe,vr=e=>{we=e,e.scope.on()},Jt=()=>{we&&we.scope.off(),we=null};function oo(e){return e.vnode.shapeFlag&4}let $r=!1;function ku(e,t=!1){$r=t;const{props:r,children:i}=e.vnode,n=oo(e);uu(e,r,n,t),fu(e,i);const s=n?Cu(e,t):void 0;return $r=!1,s}function Cu(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=wi(new Proxy(e.ctx,nu));const{setup:i}=r;if(i){const n=e.setupContext=i.length>1?uo(e):null;vr(e),Er();const s=Nt(i,e,0,[e.props,n]);if(Tr(),Jt(),ga(s)){if(s.then(Jt,Jt),t)return s.then(u=>{vs(e,u,t)}).catch(u=>{Ln(u,e,0)});e.asyncDep=s}else vs(e,s,t)}else lo(e,t)}function vs(e,t,r){he(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:_e(t)&&(e.setupState=Pa(t)),lo(e,r)}let ms;function lo(e,t,r){const i=e.type;if(!e.render){if(!t&&ms&&!i.render){const n=i.template||Ni(e).template;if(n){const{isCustomElement:s,compilerOptions:u}=e.appContext.config,{delimiters:A,compilerOptions:y}=i,a=Fe(Fe({isCustomElement:s,delimiters:A},u),y);i.render=ms(n,a)}}e.render=i.render||nt}vr(e),Er(),iu(e),Tr(),Jt()}function Iu(e){return new Proxy(e.attrs,{get(t,r){return $e(e,"get","$attrs"),t[r]}})}function uo(e){const t=i=>{e.exposed=i||{}};let r;return{get attrs(){return r||(r=Iu(e))},slots:e.slots,emit:e.emit,expose:t}}function xn(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Pa(wi(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in mn)return mn[r](e)}}))}function ci(e,t=!0){return he(e)?e.displayName||e.name:e.name||t&&e.__name}function wu(e){return he(e)&&"__vccOpts"in e}const Ae=(e,t)=>Cl(e,t,$r);function xu(){return Ou().attrs}function Ou(){const e=kt();return e.setupContext||(e.setupContext=uo(e))}function Ki(e,t,r){const i=arguments.length;return i===2?_e(t)&&!fe(t)?Wr(t)?ne(e,null,[t]):ne(e,t):ne(e,null,t):(i>3?r=Array.prototype.slice.call(arguments,2):i===3&&Wr(r)&&(r=[r]),ne(e,t,r))}const Pu="3.2.41",Fu="http://www.w3.org/2000/svg",zt=typeof document<"u"?document:null,ys=zt&&zt.createElement("template"),Mu={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,i)=>{const n=t?zt.createElementNS(Fu,e):zt.createElement(e,r?{is:r}:void 0);return e==="select"&&i&&i.multiple!=null&&n.setAttribute("multiple",i.multiple),n},createText:e=>zt.createTextNode(e),createComment:e=>zt.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>zt.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,r,i,n,s){const u=r?r.previousSibling:t.lastChild;if(n&&(n===s||n.nextSibling))for(;t.insertBefore(n.cloneNode(!0),r),!(n===s||!(n=n.nextSibling)););else{ys.innerHTML=i?`<svg>${e}</svg>`:e;const A=ys.content;if(i){const y=A.firstChild;for(;y.firstChild;)A.appendChild(y.firstChild);A.removeChild(y)}t.insertBefore(A,r)}return[u?u.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}};function Nu(e,t,r){const i=e._vtc;i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}function Bu(e,t,r){const i=e.style,n=Re(r);if(r&&!n){for(const s in r)di(i,s,r[s]);if(t&&!Re(t))for(const s in t)r[s]==null&&di(i,s,"")}else{const s=i.display;n?t!==r&&(i.cssText=r):t&&e.removeAttribute("style"),"_vod"in e&&(i.display=s)}}const Es=/\s*!important$/;function di(e,t,r){if(fe(r))r.forEach(i=>di(e,t,i));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const i=Uu(e,t);Es.test(r)?e.setProperty(tr(i),r.replace(Es,""),"important"):e[i]=r}}const Ts=["Webkit","Moz","ms"],Kn={};function Uu(e,t){const r=Kn[t];if(r)return r;let i=mt(t);if(i!=="filter"&&i in e)return Kn[t]=i;i=An(i);for(let n=0;n<Ts.length;n++){const s=Ts[n]+i;if(s in e)return Kn[t]=s}return t}const bs="http://www.w3.org/1999/xlink";function Gu(e,t,r,i,n){if(i&&t.startsWith("xlink:"))r==null?e.removeAttributeNS(bs,t.slice(6,t.length)):e.setAttributeNS(bs,t,r);else{const s=Go(t);r==null||s&&!da(r)?e.removeAttribute(t):e.setAttribute(t,s?"":r)}}function ju(e,t,r,i,n,s,u){if(t==="innerHTML"||t==="textContent"){i&&u(i,n,s),e[t]=r==null?"":r;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=r;const y=r==null?"":r;(e.value!==y||e.tagName==="OPTION")&&(e.value=y),r==null&&e.removeAttribute(t);return}let A=!1;if(r===""||r==null){const y=typeof e[t];y==="boolean"?r=da(r):r==null&&y==="string"?(r="",A=!0):y==="number"&&(r=0,A=!0)}try{e[t]=r}catch{}A&&e.removeAttribute(t)}function Ku(e,t,r,i){e.addEventListener(t,r,i)}function Hu(e,t,r,i){e.removeEventListener(t,r,i)}function Vu(e,t,r,i,n=null){const s=e._vei||(e._vei={}),u=s[t];if(i&&u)u.value=i;else{const[A,y]=Wu(t);if(i){const a=s[t]=Yu(i,n);Ku(e,A,a,y)}else u&&(Hu(e,A,u,y),s[t]=void 0)}}const Ss=/(?:Once|Passive|Capture)$/;function Wu(e){let t;if(Ss.test(e)){t={};let i;for(;i=e.match(Ss);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):tr(e.slice(2)),t]}let Hn=0;const $u=Promise.resolve(),qu=()=>Hn||($u.then(()=>Hn=0),Hn=Date.now());function Yu(e,t){const r=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=r.attached)return;Ze(zu(i,r.value),t,5,[i])};return r.value=e,r.attached=qu(),r}function zu(e,t){if(fe(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(i=>n=>!n._stopped&&i&&i(n))}else return t}const As=/^on[a-z]/,Xu=(e,t,r,i,n=!1,s,u,A,y)=>{t==="class"?Nu(e,i,n):t==="style"?Bu(e,r,i):Tn(t)?bi(t)||Vu(e,t,r,i,u):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Qu(e,t,i,n))?ju(e,t,i,s,u,A,y):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),Gu(e,t,i,n))};function Qu(e,t,r,i){return i?!!(t==="innerHTML"||t==="textContent"||t in e&&As.test(t)&&he(r)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||As.test(t)&&Re(r)?!1:t in e}function Hi(e){const t=kt();if(!t)return;const r=()=>fi(t.subTree,e(t.proxy));Kl(r),Ut(()=>{const i=new MutationObserver(r);i.observe(t.subTree.el.parentNode,{childList:!0}),ir(()=>i.disconnect())})}function fi(e,t){if(e.shapeFlag&128){const r=e.suspense;e=r.activeBranch,r.pendingBranch&&!r.isHydrating&&r.effects.push(()=>{fi(r.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)_s(e.el,t);else if(e.type===Me)e.children.forEach(r=>fi(r,t));else if(e.type===Or){let{el:r,anchor:i}=e;for(;r&&(_s(r,t),r!==i);)r=r.nextSibling}}function _s(e,t){if(e.nodeType===1){const r=e.style;for(const i in t)r.setProperty(`--${i}`,t[i])}}const wt="transition",Sr="animation",qr=(e,{slots:t})=>Ki(Ha,Zu(e),t);qr.displayName="Transition";const co={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};qr.props=Fe({},Ha.props,co);const Vt=(e,t=[])=>{fe(e)?e.forEach(r=>r(...t)):e&&e(...t)},Ls=e=>e?fe(e)?e.some(t=>t.length>1):e.length>1:!1;function Zu(e){const t={};for(const S in e)S in co||(t[S]=e[S]);if(e.css===!1)return t;const{name:r="v",type:i,duration:n,enterFromClass:s=`${r}-enter-from`,enterActiveClass:u=`${r}-enter-active`,enterToClass:A=`${r}-enter-to`,appearFromClass:y=s,appearActiveClass:a=u,appearToClass:T=A,leaveFromClass:v=`${r}-leave-from`,leaveActiveClass:d=`${r}-leave-active`,leaveToClass:L=`${r}-leave-to`}=e,R=Ju(n),E=R&&R[0],o=R&&R[1],{onBeforeEnter:f,onEnter:l,onEnterCancelled:g,onLeave:m,onLeaveCancelled:h,onBeforeAppear:b=f,onAppear:k=l,onAppearCancelled:_=g}=t,D=(S,C,I)=>{Wt(S,C?T:A),Wt(S,C?a:u),I&&I()},c=(S,C)=>{S._isLeaving=!1,Wt(S,v),Wt(S,L),Wt(S,d),C&&C()},p=S=>(C,I)=>{const w=S?k:l,O=()=>D(C,S,I);Vt(w,[C,O]),Rs(()=>{Wt(C,S?y:s),xt(C,S?T:A),Ls(w)||Ds(C,i,E,O)})};return Fe(t,{onBeforeEnter(S){Vt(f,[S]),xt(S,s),xt(S,u)},onBeforeAppear(S){Vt(b,[S]),xt(S,y),xt(S,a)},onEnter:p(!1),onAppear:p(!0),onLeave(S,C){S._isLeaving=!0;const I=()=>c(S,C);xt(S,v),rc(),xt(S,d),Rs(()=>{!S._isLeaving||(Wt(S,v),xt(S,L),Ls(m)||Ds(S,i,o,I))}),Vt(m,[S,I])},onEnterCancelled(S){D(S,!1),Vt(g,[S])},onAppearCancelled(S){D(S,!0),Vt(_,[S])},onLeaveCancelled(S){c(S),Vt(h,[S])}})}function Ju(e){if(e==null)return null;if(_e(e))return[Vn(e.enter),Vn(e.leave)];{const t=Vn(e);return[t,t]}}function Vn(e){return ma(e)}function xt(e,t){t.split(/\s+/).forEach(r=>r&&e.classList.add(r)),(e._vtc||(e._vtc=new Set)).add(t)}function Wt(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.remove(i));const{_vtc:r}=e;r&&(r.delete(t),r.size||(e._vtc=void 0))}function Rs(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let ec=0;function Ds(e,t,r,i){const n=e._endId=++ec,s=()=>{n===e._endId&&i()};if(r)return setTimeout(s,r);const{type:u,timeout:A,propCount:y}=tc(e,t);if(!u)return i();const a=u+"end";let T=0;const v=()=>{e.removeEventListener(a,d),s()},d=L=>{L.target===e&&++T>=y&&v()};setTimeout(()=>{T<y&&v()},A+1),e.addEventListener(a,d)}function tc(e,t){const r=window.getComputedStyle(e),i=R=>(r[R]||"").split(", "),n=i(wt+"Delay"),s=i(wt+"Duration"),u=ks(n,s),A=i(Sr+"Delay"),y=i(Sr+"Duration"),a=ks(A,y);let T=null,v=0,d=0;t===wt?u>0&&(T=wt,v=u,d=s.length):t===Sr?a>0&&(T=Sr,v=a,d=y.length):(v=Math.max(u,a),T=v>0?u>a?wt:Sr:null,d=T?T===wt?s.length:y.length:0);const L=T===wt&&/\b(transform|all)(,|$)/.test(r[wt+"Property"]);return{type:T,timeout:v,propCount:d,hasTransform:L}}function ks(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((r,i)=>Cs(r)+Cs(e[i])))}function Cs(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function rc(){return document.body.offsetHeight}const nc=["ctrl","shift","alt","meta"],ic={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>nc.some(r=>e[`${r}Key`]&&!t.includes(r))},sc=(e,t)=>(r,...i)=>{for(let n=0;n<t.length;n++){const s=ic[t[n]];if(s&&s(r,t))return}return e(r,...i)},ac={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Ar=(e,t)=>r=>{if(!("key"in r))return;const i=tr(r.key);if(t.some(n=>n===i||ac[n]===i))return e(r)},He={beforeMount(e,{value:t},{transition:r}){e._vod=e.style.display==="none"?"":e.style.display,r&&t?r.beforeEnter(e):_r(e,t)},mounted(e,{value:t},{transition:r}){r&&t&&r.enter(e)},updated(e,{value:t,oldValue:r},{transition:i}){!t!=!r&&(i?t?(i.beforeEnter(e),_r(e,!0),i.enter(e)):i.leave(e,()=>{_r(e,!1)}):_r(e,t))},beforeUnmount(e,{value:t}){_r(e,t)}};function _r(e,t){e.style.display=t?e._vod:"none"}const oc=Fe({patchProp:Xu},Mu);let Is;function lc(){return Is||(Is=vu(oc))}const uc=(...e)=>{const t=lc().createApp(...e),{mount:r}=t;return t.mount=i=>{const n=cc(i);if(!n)return;const s=t._component;!he(s)&&!s.render&&!s.template&&(s.template=n.innerHTML),n.innerHTML="";const u=r(n,!1,n instanceof SVGElement);return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),u},t};function cc(e){return Re(e)?document.querySelector(e):e}/*!
  * vue-router v4.1.5
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const lr=typeof window<"u";function dc(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const Ee=Object.assign;function Wn(e,t){const r={};for(const i in t){const n=t[i];r[i]=at(n)?n.map(e):e(n)}return r}const Mr=()=>{},at=Array.isArray,fc=/\/$/,hc=e=>e.replace(fc,"");function $n(e,t,r="/"){let i,n={},s="",u="";const A=t.indexOf("#");let y=t.indexOf("?");return A<y&&A>=0&&(y=-1),y>-1&&(i=t.slice(0,y),s=t.slice(y+1,A>-1?A:t.length),n=e(s)),A>-1&&(i=i||t.slice(0,A),u=t.slice(A,t.length)),i=mc(i!=null?i:t,r),{fullPath:i+(s&&"?")+s+u,path:i,query:n,hash:u}}function gc(e,t){const r=t.query?e(t.query):"";return t.path+(r&&"?")+r+(t.hash||"")}function ws(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function pc(e,t,r){const i=t.matched.length-1,n=r.matched.length-1;return i>-1&&i===n&&mr(t.matched[i],r.matched[n])&&fo(t.params,r.params)&&e(t.query)===e(r.query)&&t.hash===r.hash}function mr(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function fo(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!vc(e[r],t[r]))return!1;return!0}function vc(e,t){return at(e)?xs(e,t):at(t)?xs(t,e):e===t}function xs(e,t){return at(t)?e.length===t.length&&e.every((r,i)=>r===t[i]):e.length===1&&e[0]===t}function mc(e,t){if(e.startsWith("/"))return e;if(!e)return t;const r=t.split("/"),i=e.split("/");let n=r.length-1,s,u;for(s=0;s<i.length;s++)if(u=i[s],u!==".")if(u==="..")n>1&&n--;else break;return r.slice(0,n).join("/")+"/"+i.slice(s-(s===i.length?1:0)).join("/")}var Yr;(function(e){e.pop="pop",e.push="push"})(Yr||(Yr={}));var Nr;(function(e){e.back="back",e.forward="forward",e.unknown=""})(Nr||(Nr={}));function yc(e){if(!e)if(lr){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),hc(e)}const Ec=/^[^#]+#/;function Tc(e,t){return e.replace(Ec,"#")+t}function bc(e,t){const r=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-r.left-(t.left||0),top:i.top-r.top-(t.top||0)}}const On=()=>({left:window.pageXOffset,top:window.pageYOffset});function Sc(e){let t;if("el"in e){const r=e.el,i=typeof r=="string"&&r.startsWith("#"),n=typeof r=="string"?i?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!n)return;t=bc(n,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function Os(e,t){return(history.state?history.state.position-t:-1)+e}const hi=new Map;function Ac(e,t){hi.set(e,t)}function _c(e){const t=hi.get(e);return hi.delete(e),t}let Lc=()=>location.protocol+"//"+location.host;function ho(e,t){const{pathname:r,search:i,hash:n}=t,s=e.indexOf("#");if(s>-1){let A=n.includes(e.slice(s))?e.slice(s).length:1,y=n.slice(A);return y[0]!=="/"&&(y="/"+y),ws(y,"")}return ws(r,e)+i+n}function Rc(e,t,r,i){let n=[],s=[],u=null;const A=({state:d})=>{const L=ho(e,location),R=r.value,E=t.value;let o=0;if(d){if(r.value=L,t.value=d,u&&u===R){u=null;return}o=E?d.position-E.position:0}else i(L);n.forEach(f=>{f(r.value,R,{delta:o,type:Yr.pop,direction:o?o>0?Nr.forward:Nr.back:Nr.unknown})})};function y(){u=r.value}function a(d){n.push(d);const L=()=>{const R=n.indexOf(d);R>-1&&n.splice(R,1)};return s.push(L),L}function T(){const{history:d}=window;!d.state||d.replaceState(Ee({},d.state,{scroll:On()}),"")}function v(){for(const d of s)d();s=[],window.removeEventListener("popstate",A),window.removeEventListener("beforeunload",T)}return window.addEventListener("popstate",A),window.addEventListener("beforeunload",T),{pauseListeners:y,listen:a,destroy:v}}function Ps(e,t,r,i=!1,n=!1){return{back:e,current:t,forward:r,replaced:i,position:window.history.length,scroll:n?On():null}}function Dc(e){const{history:t,location:r}=window,i={value:ho(e,r)},n={value:t.state};n.value||s(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function s(y,a,T){const v=e.indexOf("#"),d=v>-1?(r.host&&document.querySelector("base")?e:e.slice(v))+y:Lc()+e+y;try{t[T?"replaceState":"pushState"](a,"",d),n.value=a}catch(L){console.error(L),r[T?"replace":"assign"](d)}}function u(y,a){const T=Ee({},t.state,Ps(n.value.back,y,n.value.forward,!0),a,{position:n.value.position});s(y,T,!0),i.value=y}function A(y,a){const T=Ee({},n.value,t.state,{forward:y,scroll:On()});s(T.current,T,!0);const v=Ee({},Ps(i.value,y,null),{position:T.position+1},a);s(y,v,!1),i.value=y}return{location:i,state:n,push:A,replace:u}}function kc(e){e=yc(e);const t=Dc(e),r=Rc(e,t.state,t.location,t.replace);function i(s,u=!0){u||r.pauseListeners(),history.go(s)}const n=Ee({location:"",base:e,go:i,createHref:Tc.bind(null,e)},t,r);return Object.defineProperty(n,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(n,"state",{enumerable:!0,get:()=>t.state.value}),n}function Cc(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),kc(e)}function Ic(e){return typeof e=="string"||e&&typeof e=="object"}function go(e){return typeof e=="string"||typeof e=="symbol"}const Ot={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},po=Symbol("");var Fs;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(Fs||(Fs={}));function yr(e,t){return Ee(new Error,{type:e,[po]:!0},t)}function Tt(e,t){return e instanceof Error&&po in e&&(t==null||!!(e.type&t))}const Ms="[^/]+?",wc={sensitive:!1,strict:!1,start:!0,end:!0},xc=/[.+*?^${}()[\]/\\]/g;function Oc(e,t){const r=Ee({},wc,t),i=[];let n=r.start?"^":"";const s=[];for(const a of e){const T=a.length?[]:[90];r.strict&&!a.length&&(n+="/");for(let v=0;v<a.length;v++){const d=a[v];let L=40+(r.sensitive?.25:0);if(d.type===0)v||(n+="/"),n+=d.value.replace(xc,"\\$&"),L+=40;else if(d.type===1){const{value:R,repeatable:E,optional:o,regexp:f}=d;s.push({name:R,repeatable:E,optional:o});const l=f||Ms;if(l!==Ms){L+=10;try{new RegExp(`(${l})`)}catch(m){throw new Error(`Invalid custom RegExp for param "${R}" (${l}): `+m.message)}}let g=E?`((?:${l})(?:/(?:${l}))*)`:`(${l})`;v||(g=o&&a.length<2?`(?:/${g})`:"/"+g),o&&(g+="?"),n+=g,L+=20,o&&(L+=-8),E&&(L+=-20),l===".*"&&(L+=-50)}T.push(L)}i.push(T)}if(r.strict&&r.end){const a=i.length-1;i[a][i[a].length-1]+=.7000000000000001}r.strict||(n+="/?"),r.end?n+="$":r.strict&&(n+="(?:/|$)");const u=new RegExp(n,r.sensitive?"":"i");function A(a){const T=a.match(u),v={};if(!T)return null;for(let d=1;d<T.length;d++){const L=T[d]||"",R=s[d-1];v[R.name]=L&&R.repeatable?L.split("/"):L}return v}function y(a){let T="",v=!1;for(const d of e){(!v||!T.endsWith("/"))&&(T+="/"),v=!1;for(const L of d)if(L.type===0)T+=L.value;else if(L.type===1){const{value:R,repeatable:E,optional:o}=L,f=R in a?a[R]:"";if(at(f)&&!E)throw new Error(`Provided param "${R}" is an array but it is not repeatable (* or + modifiers)`);const l=at(f)?f.join("/"):f;if(!l)if(o)d.length<2&&(T.endsWith("/")?T=T.slice(0,-1):v=!0);else throw new Error(`Missing required param "${R}"`);T+=l}}return T||"/"}return{re:u,score:i,keys:s,parse:A,stringify:y}}function Pc(e,t){let r=0;for(;r<e.length&&r<t.length;){const i=t[r]-e[r];if(i)return i;r++}return e.length<t.length?e.length===1&&e[0]===40+40?-1:1:e.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function Fc(e,t){let r=0;const i=e.score,n=t.score;for(;r<i.length&&r<n.length;){const s=Pc(i[r],n[r]);if(s)return s;r++}if(Math.abs(n.length-i.length)===1){if(Ns(i))return 1;if(Ns(n))return-1}return n.length-i.length}function Ns(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const Mc={type:0,value:""},Nc=/[a-zA-Z0-9_]/;function Bc(e){if(!e)return[[]];if(e==="/")return[[Mc]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(L){throw new Error(`ERR (${r})/"${a}": ${L}`)}let r=0,i=r;const n=[];let s;function u(){s&&n.push(s),s=[]}let A=0,y,a="",T="";function v(){!a||(r===0?s.push({type:0,value:a}):r===1||r===2||r===3?(s.length>1&&(y==="*"||y==="+")&&t(`A repeatable param (${a}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:a,regexp:T,repeatable:y==="*"||y==="+",optional:y==="*"||y==="?"})):t("Invalid state to consume buffer"),a="")}function d(){a+=y}for(;A<e.length;){if(y=e[A++],y==="\\"&&r!==2){i=r,r=4;continue}switch(r){case 0:y==="/"?(a&&v(),u()):y===":"?(v(),r=1):d();break;case 4:d(),r=i;break;case 1:y==="("?r=2:Nc.test(y)?d():(v(),r=0,y!=="*"&&y!=="?"&&y!=="+"&&A--);break;case 2:y===")"?T[T.length-1]=="\\"?T=T.slice(0,-1)+y:r=3:T+=y;break;case 3:v(),r=0,y!=="*"&&y!=="?"&&y!=="+"&&A--,T="";break;default:t("Unknown state");break}}return r===2&&t(`Unfinished custom RegExp for param "${a}"`),v(),u(),n}function Uc(e,t,r){const i=Oc(Bc(e.path),r),n=Ee(i,{record:e,parent:t,children:[],alias:[]});return t&&!n.record.aliasOf==!t.record.aliasOf&&t.children.push(n),n}function Gc(e,t){const r=[],i=new Map;t=Gs({strict:!1,end:!0,sensitive:!1},t);function n(T){return i.get(T)}function s(T,v,d){const L=!d,R=jc(T);R.aliasOf=d&&d.record;const E=Gs(t,T),o=[R];if("alias"in T){const g=typeof T.alias=="string"?[T.alias]:T.alias;for(const m of g)o.push(Ee({},R,{components:d?d.record.components:R.components,path:m,aliasOf:d?d.record:R}))}let f,l;for(const g of o){const{path:m}=g;if(v&&m[0]!=="/"){const h=v.record.path,b=h[h.length-1]==="/"?"":"/";g.path=v.record.path+(m&&b+m)}if(f=Uc(g,v,E),d?d.alias.push(f):(l=l||f,l!==f&&l.alias.push(f),L&&T.name&&!Us(f)&&u(T.name)),R.children){const h=R.children;for(let b=0;b<h.length;b++)s(h[b],f,d&&d.children[b])}d=d||f,y(f)}return l?()=>{u(l)}:Mr}function u(T){if(go(T)){const v=i.get(T);v&&(i.delete(T),r.splice(r.indexOf(v),1),v.children.forEach(u),v.alias.forEach(u))}else{const v=r.indexOf(T);v>-1&&(r.splice(v,1),T.record.name&&i.delete(T.record.name),T.children.forEach(u),T.alias.forEach(u))}}function A(){return r}function y(T){let v=0;for(;v<r.length&&Fc(T,r[v])>=0&&(T.record.path!==r[v].record.path||!vo(T,r[v]));)v++;r.splice(v,0,T),T.record.name&&!Us(T)&&i.set(T.record.name,T)}function a(T,v){let d,L={},R,E;if("name"in T&&T.name){if(d=i.get(T.name),!d)throw yr(1,{location:T});E=d.record.name,L=Ee(Bs(v.params,d.keys.filter(l=>!l.optional).map(l=>l.name)),T.params&&Bs(T.params,d.keys.map(l=>l.name))),R=d.stringify(L)}else if("path"in T)R=T.path,d=r.find(l=>l.re.test(R)),d&&(L=d.parse(R),E=d.record.name);else{if(d=v.name?i.get(v.name):r.find(l=>l.re.test(v.path)),!d)throw yr(1,{location:T,currentLocation:v});E=d.record.name,L=Ee({},v.params,T.params),R=d.stringify(L)}const o=[];let f=d;for(;f;)o.unshift(f.record),f=f.parent;return{name:E,path:R,params:L,matched:o,meta:Hc(o)}}return e.forEach(T=>s(T)),{addRoute:s,resolve:a,removeRoute:u,getRoutes:A,getRecordMatcher:n}}function Bs(e,t){const r={};for(const i of t)i in e&&(r[i]=e[i]);return r}function jc(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:Kc(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function Kc(e){const t={},r=e.props||!1;if("component"in e)t.default=r;else for(const i in e.components)t[i]=typeof r=="boolean"?r:r[i];return t}function Us(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function Hc(e){return e.reduce((t,r)=>Ee(t,r.meta),{})}function Gs(e,t){const r={};for(const i in e)r[i]=i in t?t[i]:e[i];return r}function vo(e,t){return t.children.some(r=>r===e||vo(e,r))}const mo=/#/g,Vc=/&/g,Wc=/\//g,$c=/=/g,qc=/\?/g,yo=/\+/g,Yc=/%5B/g,zc=/%5D/g,Eo=/%5E/g,Xc=/%60/g,To=/%7B/g,Qc=/%7C/g,bo=/%7D/g,Zc=/%20/g;function Vi(e){return encodeURI(""+e).replace(Qc,"|").replace(Yc,"[").replace(zc,"]")}function Jc(e){return Vi(e).replace(To,"{").replace(bo,"}").replace(Eo,"^")}function gi(e){return Vi(e).replace(yo,"%2B").replace(Zc,"+").replace(mo,"%23").replace(Vc,"%26").replace(Xc,"`").replace(To,"{").replace(bo,"}").replace(Eo,"^")}function ed(e){return gi(e).replace($c,"%3D")}function td(e){return Vi(e).replace(mo,"%23").replace(qc,"%3F")}function rd(e){return e==null?"":td(e).replace(Wc,"%2F")}function En(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function nd(e){const t={};if(e===""||e==="?")return t;const i=(e[0]==="?"?e.slice(1):e).split("&");for(let n=0;n<i.length;++n){const s=i[n].replace(yo," "),u=s.indexOf("="),A=En(u<0?s:s.slice(0,u)),y=u<0?null:En(s.slice(u+1));if(A in t){let a=t[A];at(a)||(a=t[A]=[a]),a.push(y)}else t[A]=y}return t}function js(e){let t="";for(let r in e){const i=e[r];if(r=ed(r),i==null){i!==void 0&&(t+=(t.length?"&":"")+r);continue}(at(i)?i.map(s=>s&&gi(s)):[i&&gi(i)]).forEach(s=>{s!==void 0&&(t+=(t.length?"&":"")+r,s!=null&&(t+="="+s))})}return t}function id(e){const t={};for(const r in e){const i=e[r];i!==void 0&&(t[r]=at(i)?i.map(n=>n==null?null:""+n):i==null?i:""+i)}return t}const sd=Symbol(""),Ks=Symbol(""),Pn=Symbol(""),Wi=Symbol(""),pi=Symbol("");function Lr(){let e=[];function t(i){return e.push(i),()=>{const n=e.indexOf(i);n>-1&&e.splice(n,1)}}function r(){e=[]}return{add:t,list:()=>e,reset:r}}function Ft(e,t,r,i,n){const s=i&&(i.enterCallbacks[n]=i.enterCallbacks[n]||[]);return()=>new Promise((u,A)=>{const y=v=>{v===!1?A(yr(4,{from:r,to:t})):v instanceof Error?A(v):Ic(v)?A(yr(2,{from:t,to:v})):(s&&i.enterCallbacks[n]===s&&typeof v=="function"&&s.push(v),u())},a=e.call(i&&i.instances[n],t,r,y);let T=Promise.resolve(a);e.length<3&&(T=T.then(y)),T.catch(v=>A(v))})}function qn(e,t,r,i){const n=[];for(const s of e)for(const u in s.components){let A=s.components[u];if(!(t!=="beforeRouteEnter"&&!s.instances[u]))if(ad(A)){const a=(A.__vccOpts||A)[t];a&&n.push(Ft(a,r,i,s,u))}else{let y=A();n.push(()=>y.then(a=>{if(!a)return Promise.reject(new Error(`Couldn't resolve component "${u}" at "${s.path}"`));const T=dc(a)?a.default:a;s.components[u]=T;const d=(T.__vccOpts||T)[t];return d&&Ft(d,r,i,s,u)()}))}}return n}function ad(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Hs(e){const t=Ve(Pn),r=Ve(Wi),i=Ae(()=>t.resolve(ee(e.to))),n=Ae(()=>{const{matched:y}=i.value,{length:a}=y,T=y[a-1],v=r.matched;if(!T||!v.length)return-1;const d=v.findIndex(mr.bind(null,T));if(d>-1)return d;const L=Vs(y[a-2]);return a>1&&Vs(T)===L&&v[v.length-1].path!==L?v.findIndex(mr.bind(null,y[a-2])):d}),s=Ae(()=>n.value>-1&&cd(r.params,i.value.params)),u=Ae(()=>n.value>-1&&n.value===r.matched.length-1&&fo(r.params,i.value.params));function A(y={}){return ud(y)?t[ee(e.replace)?"replace":"push"](ee(e.to)).catch(Mr):Promise.resolve()}return{route:i,href:Ae(()=>i.value.href),isActive:s,isExactActive:u,navigate:A}}const od=De({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Hs,setup(e,{slots:t}){const r=qe(Hs(e)),{options:i}=Ve(Pn),n=Ae(()=>({[Ws(e.activeClass,i.linkActiveClass,"router-link-active")]:r.isActive,[Ws(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const s=t.default&&t.default(r);return e.custom?s:Ki("a",{"aria-current":r.isExactActive?e.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:n.value},s)}}}),ld=od;function ud(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function cd(e,t){for(const r in t){const i=t[r],n=e[r];if(typeof i=="string"){if(i!==n)return!1}else if(!at(n)||n.length!==i.length||i.some((s,u)=>s!==n[u]))return!1}return!0}function Vs(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Ws=(e,t,r)=>e!=null?e:t!=null?t:r,dd=De({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:r}){const i=Ve(pi),n=Ae(()=>e.route||i.value),s=Ve(Ks,0),u=Ae(()=>{let a=ee(s);const{matched:T}=n.value;let v;for(;(v=T[a])&&!v.components;)a++;return a}),A=Ae(()=>n.value.matched[u.value]);hr(Ks,Ae(()=>u.value+1)),hr(sd,A),hr(pi,n);const y=xe();return vt(()=>[y.value,A.value,e.name],([a,T,v],[d,L,R])=>{T&&(T.instances[v]=a,L&&L!==T&&a&&a===d&&(T.leaveGuards.size||(T.leaveGuards=L.leaveGuards),T.updateGuards.size||(T.updateGuards=L.updateGuards))),a&&T&&(!L||!mr(T,L)||!d)&&(T.enterCallbacks[v]||[]).forEach(E=>E(a))},{flush:"post"}),()=>{const a=n.value,T=e.name,v=A.value,d=v&&v.components[T];if(!d)return $s(r.default,{Component:d,route:a});const L=v.props[T],R=L?L===!0?a.params:typeof L=="function"?L(a):L:null,o=Ki(d,Ee({},R,t,{onVnodeUnmounted:f=>{f.component.isUnmounted&&(v.instances[T]=null)},ref:y}));return $s(r.default,{Component:o,route:a})||o}}});function $s(e,t){if(!e)return null;const r=e(t);return r.length===1?r[0]:r}const fd=dd;function hd(e){const t=Gc(e.routes,e),r=e.parseQuery||nd,i=e.stringifyQuery||js,n=e.history,s=Lr(),u=Lr(),A=Lr(),y=Ll(Ot);let a=Ot;lr&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const T=Wn.bind(null,G=>""+G),v=Wn.bind(null,rd),d=Wn.bind(null,En);function L(G,W){let $,Y;return go(G)?($=t.getRecordMatcher(G),Y=W):Y=G,t.addRoute(Y,$)}function R(G){const W=t.getRecordMatcher(G);W&&t.removeRoute(W)}function E(){return t.getRoutes().map(G=>G.record)}function o(G){return!!t.getRecordMatcher(G)}function f(G,W){if(W=Ee({},W||y.value),typeof G=="string"){const M=$n(r,G,W.path),B=t.resolve({path:M.path},W),K=n.createHref(M.fullPath);return Ee(M,B,{params:d(B.params),hash:En(M.hash),redirectedFrom:void 0,href:K})}let $;if("path"in G)$=Ee({},G,{path:$n(r,G.path,W.path).path});else{const M=Ee({},G.params);for(const B in M)M[B]==null&&delete M[B];$=Ee({},G,{params:v(G.params)}),W.params=v(W.params)}const Y=t.resolve($,W),re=G.hash||"";Y.params=T(d(Y.params));const ue=gc(i,Ee({},G,{hash:Jc(re),path:Y.path})),oe=n.createHref(ue);return Ee({fullPath:ue,hash:re,query:i===js?id(G.query):G.query||{}},Y,{redirectedFrom:void 0,href:oe})}function l(G){return typeof G=="string"?$n(r,G,y.value.path):Ee({},G)}function g(G,W){if(a!==G)return yr(8,{from:W,to:G})}function m(G){return k(G)}function h(G){return m(Ee(l(G),{replace:!0}))}function b(G){const W=G.matched[G.matched.length-1];if(W&&W.redirect){const{redirect:$}=W;let Y=typeof $=="function"?$(G):$;return typeof Y=="string"&&(Y=Y.includes("?")||Y.includes("#")?Y=l(Y):{path:Y},Y.params={}),Ee({query:G.query,hash:G.hash,params:"path"in Y?{}:G.params},Y)}}function k(G,W){const $=a=f(G),Y=y.value,re=G.state,ue=G.force,oe=G.replace===!0,M=b($);if(M)return k(Ee(l(M),{state:typeof M=="object"?Ee({},re,M.state):re,force:ue,replace:oe}),W||$);const B=$;B.redirectedFrom=W;let K;return!ue&&pc(i,Y,$)&&(K=yr(16,{to:B,from:Y}),N(Y,Y,!0,!1)),(K?Promise.resolve(K):D(B,Y)).catch(H=>Tt(H)?Tt(H,2)?H:F(H):x(H,B,Y)).then(H=>{if(H){if(Tt(H,2))return k(Ee({replace:oe},l(H.to),{state:typeof H.to=="object"?Ee({},re,H.to.state):re,force:ue}),W||B)}else H=p(B,Y,!0,oe,re);return c(B,Y,H),H})}function _(G,W){const $=g(G,W);return $?Promise.reject($):Promise.resolve()}function D(G,W){let $;const[Y,re,ue]=gd(G,W);$=qn(Y.reverse(),"beforeRouteLeave",G,W);for(const M of Y)M.leaveGuards.forEach(B=>{$.push(Ft(B,G,W))});const oe=_.bind(null,G,W);return $.push(oe),sr($).then(()=>{$=[];for(const M of s.list())$.push(Ft(M,G,W));return $.push(oe),sr($)}).then(()=>{$=qn(re,"beforeRouteUpdate",G,W);for(const M of re)M.updateGuards.forEach(B=>{$.push(Ft(B,G,W))});return $.push(oe),sr($)}).then(()=>{$=[];for(const M of G.matched)if(M.beforeEnter&&!W.matched.includes(M))if(at(M.beforeEnter))for(const B of M.beforeEnter)$.push(Ft(B,G,W));else $.push(Ft(M.beforeEnter,G,W));return $.push(oe),sr($)}).then(()=>(G.matched.forEach(M=>M.enterCallbacks={}),$=qn(ue,"beforeRouteEnter",G,W),$.push(oe),sr($))).then(()=>{$=[];for(const M of u.list())$.push(Ft(M,G,W));return $.push(oe),sr($)}).catch(M=>Tt(M,8)?M:Promise.reject(M))}function c(G,W,$){for(const Y of A.list())Y(G,W,$)}function p(G,W,$,Y,re){const ue=g(G,W);if(ue)return ue;const oe=W===Ot,M=lr?history.state:{};$&&(Y||oe?n.replace(G.fullPath,Ee({scroll:oe&&M&&M.scroll},re)):n.push(G.fullPath,re)),y.value=G,N(G,W,$,oe),F()}let S;function C(){S||(S=n.listen((G,W,$)=>{if(!z.listening)return;const Y=f(G),re=b(Y);if(re){k(Ee(re,{replace:!0}),Y).catch(Mr);return}a=Y;const ue=y.value;lr&&Ac(Os(ue.fullPath,$.delta),On()),D(Y,ue).catch(oe=>Tt(oe,12)?oe:Tt(oe,2)?(k(oe.to,Y).then(M=>{Tt(M,20)&&!$.delta&&$.type===Yr.pop&&n.go(-1,!1)}).catch(Mr),Promise.reject()):($.delta&&n.go(-$.delta,!1),x(oe,Y,ue))).then(oe=>{oe=oe||p(Y,ue,!1),oe&&($.delta&&!Tt(oe,8)?n.go(-$.delta,!1):$.type===Yr.pop&&Tt(oe,20)&&n.go(-1,!1)),c(Y,ue,oe)}).catch(Mr)}))}let I=Lr(),w=Lr(),O;function x(G,W,$){F(G);const Y=w.list();return Y.length?Y.forEach(re=>re(G,W,$)):console.error(G),Promise.reject(G)}function P(){return O&&y.value!==Ot?Promise.resolve():new Promise((G,W)=>{I.add([G,W])})}function F(G){return O||(O=!G,C(),I.list().forEach(([W,$])=>G?$(G):W()),I.reset()),G}function N(G,W,$,Y){const{scrollBehavior:re}=e;if(!lr||!re)return Promise.resolve();const ue=!$&&_c(Os(G.fullPath,0))||(Y||!$)&&history.state&&history.state.scroll||null;return er().then(()=>re(G,W,ue)).then(oe=>oe&&Sc(oe)).catch(oe=>x(oe,G,W))}const U=G=>n.go(G);let j;const V=new Set,z={currentRoute:y,listening:!0,addRoute:L,removeRoute:R,hasRoute:o,getRoutes:E,resolve:f,options:e,push:m,replace:h,go:U,back:()=>U(-1),forward:()=>U(1),beforeEach:s.add,beforeResolve:u.add,afterEach:A.add,onError:w.add,isReady:P,install(G){const W=this;G.component("RouterLink",ld),G.component("RouterView",fd),G.config.globalProperties.$router=W,Object.defineProperty(G.config.globalProperties,"$route",{enumerable:!0,get:()=>ee(y)}),lr&&!j&&y.value===Ot&&(j=!0,m(n.location).catch(re=>{}));const $={};for(const re in Ot)$[re]=Ae(()=>y.value[re]);G.provide(Pn,W),G.provide(Wi,qe($)),G.provide(pi,y);const Y=G.unmount;V.add(G),G.unmount=function(){V.delete(G),V.size<1&&(a=Ot,S&&S(),S=null,y.value=Ot,j=!1,O=!1),Y()}}};return z}function sr(e){return e.reduce((t,r)=>t.then(()=>r()),Promise.resolve())}function gd(e,t){const r=[],i=[],n=[],s=Math.max(t.matched.length,e.matched.length);for(let u=0;u<s;u++){const A=t.matched[u];A&&(e.matched.find(a=>mr(a,A))?i.push(A):r.push(A));const y=e.matched[u];y&&(t.matched.find(a=>mr(a,y))||n.push(y))}return[r,i,n]}function Eg(){return Ve(Pn)}function pd(){return Ve(Wi)}const vd=De({name:"APP"}),md=De({...vd,setup(e){const t=qe([]),r=pd(),i=xe(!1);return vt(()=>r,n=>{n.meta.keepAlive&&t.indexOf(n.name)===-1&&t.push(n.name),["/","/nft","/profit"].includes(n.path)?i.value=!0:i.value=!1},{deep:!0,immediate:!0}),(n,s)=>{const u=tu("router-view");return me(),Fr(u,null,{default:Hr(({Component:A})=>[(me(),Fr(ql,{include:t},[(me(),Fr(ru(A),{key:n.$route.name}))],1032,["include"]))]),_:1})}}});var yd=!1;/*!
  * pinia v2.0.23
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const Ed=Symbol();var qs;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(qs||(qs={}));function Td(){const e=Qo(!0),t=e.run(()=>xe({}));let r=[],i=[];const n=wi({install(s){n._a=s,s.provide(Ed,n),s.config.globalProperties.$pinia=n,i.forEach(u=>r.push(u)),i=[]},use(s){return!this._a&&!yd?i.push(s):r.push(s),this},_p:r,_a:null,_e:e,_s:new Map,state:t});return n}const bd=Td(),Sd="modulepreload",Ad=function(e){return"/test1/"+e},Ys={},Rr=function(t,r,i){return!r||r.length===0?t():Promise.all(r.map(n=>{if(n=Ad(n),n in Ys)return;Ys[n]=!0;const s=n.endsWith(".css"),u=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${u}`))return;const A=document.createElement("link");if(A.rel=s?"stylesheet":Sd,s||(A.as="script",A.crossOrigin=""),A.href=n,document.head.appendChild(A),s)return new Promise((y,a)=>{A.addEventListener("load",y),A.addEventListener("error",()=>a(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>t())},_d=[{path:"/",component:()=>Rr(()=>import("./index.3a070a7b.js"),["js/index.3a070a7b.js","css/index.c5aec5d4.css","js/_plugin-vue_export-helper.5059d46b.js"]),name:"Index",meta:{title:"Index",keepAlive:!1}},{path:"/opendaa",component:()=>Rr(()=>import("./index.7bb52415.js"),["js/index.7bb52415.js","css/index.2bd2b672.css","css/index.64598a7d.css","js/_plugin-vue_export-helper.5059d46b.js"]),name:"OpenDaa",meta:{title:"OpenDaa",keepAlive:!1}},{path:"/zihua",component:()=>Rr(()=>import("./index.2aa79a9f.js"),["js/index.2aa79a9f.js","css/index.0aa5b63a.css","css/index.64598a7d.css","js/function-call.8747eeee.js","js/_plugin-vue_export-helper.5059d46b.js"]),name:"zihua",meta:{title:"zihua",keepAlive:!1}},{path:"/tr",component:()=>Rr(()=>import("./index.7496a285.js"),["js/index.7496a285.js","css/index.6208a95f.css","css/index.64598a7d.css","js/_plugin-vue_export-helper.5059d46b.js","js/function-call.8747eeee.js"]),name:"tr",meta:{title:"tr",keepAlive:!1}},{path:"/pdf",component:()=>Rr(()=>import("./index.18d0f54b.js"),["js/index.18d0f54b.js","css/index.998a440c.css","css/index.64598a7d.css","js/_plugin-vue_export-helper.5059d46b.js"]),name:"pdf",meta:{title:"pdf",keepAlive:!1}},{path:"/:pathMatch(.*)*",redirect:"/"}],Ld=hd({history:Cc("/test1/"),routes:_d,scrollBehavior(e,t,r){return r||{top:0}}});var Rd=Object.defineProperty,Dd=Object.defineProperties,kd=Object.getOwnPropertyDescriptors,zs=Object.getOwnPropertySymbols,Cd=Object.prototype.hasOwnProperty,Id=Object.prototype.propertyIsEnumerable,Xs=(e,t,r)=>t in e?Rd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,vi=(e,t)=>{for(var r in t||(t={}))Cd.call(t,r)&&Xs(e,r,t[r]);if(zs)for(var r of zs(t))Id.call(t,r)&&Xs(e,r,t[r]);return e},mi=(e,t)=>Dd(e,kd(t));function Qs(e,t,r,i){var n,s=!1,u=0;function A(){n&&clearTimeout(n)}function y(){for(var a=arguments.length,T=new Array(a),v=0;v<a;v++)T[v]=arguments[v];var d=this,L=Date.now()-u;function R(){u=Date.now(),r.apply(d,T)}function E(){n=void 0}s||(i&&!n&&R(),A(),i===void 0&&L>e?R():t!==!0&&(n=setTimeout(i?E:R,i===void 0?e-L:e)))}return typeof t!="boolean"&&(i=r,r=t,t=void 0),y.cancel=function(){A(),s=!0},y}function Zs(e,t,r){return r===void 0?Qs(e,t,!1):Qs(e,r,t!==!1)}function wd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var So={exports:{}};typeof window<"u"&&(So.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(i,n,s){r.o(i,n)||Object.defineProperty(i,n,{enumerable:!0,get:s})},r.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},r.t=function(i,n){if(1&n&&(i=r(i)),8&n||4&n&&typeof i=="object"&&i&&i.__esModule)return i;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:i}),2&n&&typeof i!="string")for(var u in i)r.d(s,u,function(A){return i[A]}.bind(null,u));return s},r.n=function(i){var n=i&&i.__esModule?function(){return i.default}:function(){return i};return r.d(n,"a",n),n},r.o=function(i,n){return Object.prototype.hasOwnProperty.call(i,n)},r.p="/dist/",r(r.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(e,t,r){var i=Object.prototype.hasOwnProperty,n="~";function s(){}function u(T,v,d){this.fn=T,this.context=v,this.once=d||!1}function A(T,v,d,L,R){if(typeof d!="function")throw new TypeError("The listener must be a function");var E=new u(d,L||T,R),o=n?n+v:v;return T._events[o]?T._events[o].fn?T._events[o]=[T._events[o],E]:T._events[o].push(E):(T._events[o]=E,T._eventsCount++),T}function y(T,v){--T._eventsCount==0?T._events=new s:delete T._events[v]}function a(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(n=!1)),a.prototype.eventNames=function(){var T,v,d=[];if(this._eventsCount===0)return d;for(v in T=this._events)i.call(T,v)&&d.push(n?v.slice(1):v);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(T)):d},a.prototype.listeners=function(T){var v=n?n+T:T,d=this._events[v];if(!d)return[];if(d.fn)return[d.fn];for(var L=0,R=d.length,E=new Array(R);L<R;L++)E[L]=d[L].fn;return E},a.prototype.listenerCount=function(T){var v=n?n+T:T,d=this._events[v];return d?d.fn?1:d.length:0},a.prototype.emit=function(T,v,d,L,R,E){var o=n?n+T:T;if(!this._events[o])return!1;var f,l,g=this._events[o],m=arguments.length;if(g.fn){switch(g.once&&this.removeListener(T,g.fn,void 0,!0),m){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,v),!0;case 3:return g.fn.call(g.context,v,d),!0;case 4:return g.fn.call(g.context,v,d,L),!0;case 5:return g.fn.call(g.context,v,d,L,R),!0;case 6:return g.fn.call(g.context,v,d,L,R,E),!0}for(l=1,f=new Array(m-1);l<m;l++)f[l-1]=arguments[l];g.fn.apply(g.context,f)}else{var h,b=g.length;for(l=0;l<b;l++)switch(g[l].once&&this.removeListener(T,g[l].fn,void 0,!0),m){case 1:g[l].fn.call(g[l].context);break;case 2:g[l].fn.call(g[l].context,v);break;case 3:g[l].fn.call(g[l].context,v,d);break;case 4:g[l].fn.call(g[l].context,v,d,L);break;default:if(!f)for(h=1,f=new Array(m-1);h<m;h++)f[h-1]=arguments[h];g[l].fn.apply(g[l].context,f)}}return!0},a.prototype.on=function(T,v,d){return A(this,T,v,d,!1)},a.prototype.once=function(T,v,d){return A(this,T,v,d,!0)},a.prototype.removeListener=function(T,v,d,L){var R=n?n+T:T;if(!this._events[R])return this;if(!v)return y(this,R),this;var E=this._events[R];if(E.fn)E.fn!==v||L&&!E.once||d&&E.context!==d||y(this,R);else{for(var o=0,f=[],l=E.length;o<l;o++)(E[o].fn!==v||L&&!E[o].once||d&&E[o].context!==d)&&f.push(E[o]);f.length?this._events[R]=f.length===1?f[0]:f:y(this,R)}return this},a.prototype.removeAllListeners=function(T){var v;return T?(v=n?n+T:T,this._events[v]&&y(this,v)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},"./node_modules/url-toolkit/src/url-toolkit.js":function(e,t,r){var i,n,s,u,A;i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#[^]*)?$/,n=/^([^\/?#]*)([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,u=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,A={buildAbsoluteURL:function(y,a,T){if(T=T||{},y=y.trim(),!(a=a.trim())){if(!T.alwaysNormalize)return y;var v=A.parseURL(y);if(!v)throw new Error("Error trying to parse base URL.");return v.path=A.normalizePath(v.path),A.buildURLFromParts(v)}var d=A.parseURL(a);if(!d)throw new Error("Error trying to parse relative URL.");if(d.scheme)return T.alwaysNormalize?(d.path=A.normalizePath(d.path),A.buildURLFromParts(d)):a;var L=A.parseURL(y);if(!L)throw new Error("Error trying to parse base URL.");if(!L.netLoc&&L.path&&L.path[0]!=="/"){var R=n.exec(L.path);L.netLoc=R[1],L.path=R[2]}L.netLoc&&!L.path&&(L.path="/");var E={scheme:L.scheme,netLoc:d.netLoc,path:null,params:d.params,query:d.query,fragment:d.fragment};if(!d.netLoc&&(E.netLoc=L.netLoc,d.path[0]!=="/"))if(d.path){var o=L.path,f=o.substring(0,o.lastIndexOf("/")+1)+d.path;E.path=A.normalizePath(f)}else E.path=L.path,d.params||(E.params=L.params,d.query||(E.query=L.query));return E.path===null&&(E.path=T.alwaysNormalize?A.normalizePath(d.path):d.path),A.buildURLFromParts(E)},parseURL:function(y){var a=i.exec(y);return a?{scheme:a[1]||"",netLoc:a[2]||"",path:a[3]||"",params:a[4]||"",query:a[5]||"",fragment:a[6]||""}:null},normalizePath:function(y){for(y=y.split("").reverse().join("").replace(s,"");y.length!==(y=y.replace(u,"")).length;);return y.split("").reverse().join("")},buildURLFromParts:function(y){return y.scheme+y.netLoc+y.path+y.params+y.query+y.fragment}},e.exports=A},"./node_modules/webworkify-webpack/index.js":function(e,t,r){function i(a){var T={};function v(L){if(T[L])return T[L].exports;var R=T[L]={i:L,l:!1,exports:{}};return a[L].call(R.exports,R,R.exports,v),R.l=!0,R.exports}v.m=a,v.c=T,v.i=function(L){return L},v.d=function(L,R,E){v.o(L,R)||Object.defineProperty(L,R,{configurable:!1,enumerable:!0,get:E})},v.r=function(L){Object.defineProperty(L,"__esModule",{value:!0})},v.n=function(L){var R=L&&L.__esModule?function(){return L.default}:function(){return L};return v.d(R,"a",R),R},v.o=function(L,R){return Object.prototype.hasOwnProperty.call(L,R)},v.p="/",v.oe=function(L){throw console.error(L),L};var d=v(v.s=ENTRY_MODULE);return d.default||d}var n="[\\.|\\-|\\+|\\w|/|@]+",s="\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)";function u(a){return(a+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function A(a,T,v){var d={};d[v]=[];var L=T.toString(),R=L.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!R)return d;for(var E,o=R[1],f=new RegExp("(\\\\n|\\W)"+u(o)+s,"g");E=f.exec(L);)E[3]!=="dll-reference"&&d[v].push(E[3]);for(f=new RegExp("\\("+u(o)+'\\("(dll-reference\\s('+n+'))"\\)\\)'+s,"g");E=f.exec(L);)a[E[2]]||(d[v].push(E[1]),a[E[2]]=r(E[1]).m),d[E[2]]=d[E[2]]||[],d[E[2]].push(E[4]);for(var l,g=Object.keys(d),m=0;m<g.length;m++)for(var h=0;h<d[g[m]].length;h++)l=d[g[m]][h],isNaN(1*l)||(d[g[m]][h]=1*d[g[m]][h]);return d}function y(a){return Object.keys(a).reduce(function(T,v){return T||a[v].length>0},!1)}e.exports=function(a,T){T=T||{};var v={main:r.m},d=T.all?{main:Object.keys(v.main)}:function(f,l){for(var g={main:[l]},m={main:[]},h={main:{}};y(g);)for(var b=Object.keys(g),k=0;k<b.length;k++){var _=b[k],D=g[_].pop();if(h[_]=h[_]||{},!h[_][D]&&f[_][D]){h[_][D]=!0,m[_]=m[_]||[],m[_].push(D);for(var c=A(f,f[_][D],_),p=Object.keys(c),S=0;S<p.length;S++)g[p[S]]=g[p[S]]||[],g[p[S]]=g[p[S]].concat(c[p[S]])}}return m}(v,a),L="";Object.keys(d).filter(function(f){return f!=="main"}).forEach(function(f){for(var l=0;d[f][l];)l++;d[f].push(l),v[f][l]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",L=L+"var "+f+" = ("+i.toString().replace("ENTRY_MODULE",JSON.stringify(l))+")({"+d[f].map(function(g){return JSON.stringify(g)+": "+v[f][g].toString()}).join(",")+`});
`}),L=L+"new (("+i.toString().replace("ENTRY_MODULE",JSON.stringify(a))+")({"+d.main.map(function(f){return JSON.stringify(f)+": "+v.main[f].toString()}).join(",")+"}))(self);";var R=new window.Blob([L],{type:"text/javascript"});if(T.bare)return R;var E=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(R),o=new window.Worker(E);return o.objectURL=E,o}},"./src/config.ts":function(e,t,r){r.r(t),r.d(t,"hlsDefaultConfig",function(){return b}),r.d(t,"mergeConfig",function(){return k}),r.d(t,"enableStreamingMode",function(){return _});var i=r("./src/controller/abr-controller.ts"),n=r("./src/controller/audio-stream-controller.ts"),s=r("./src/controller/audio-track-controller.ts"),u=r("./src/controller/subtitle-stream-controller.ts"),A=r("./src/controller/subtitle-track-controller.ts"),y=r("./src/controller/buffer-controller.ts"),a=r("./src/controller/timeline-controller.ts"),T=r("./src/controller/cap-level-controller.ts"),v=r("./src/controller/fps-controller.ts"),d=r("./src/controller/eme-controller.ts"),L=r("./src/utils/xhr-loader.ts"),R=r("./src/utils/fetch-loader.ts"),E=r("./src/utils/cues.ts"),o=r("./src/utils/mediakeys-helper.ts"),f=r("./src/utils/logger.ts");function l(){return(l=Object.assign||function(D){for(var c=1;c<arguments.length;c++){var p=arguments[c];for(var S in p)Object.prototype.hasOwnProperty.call(p,S)&&(D[S]=p[S])}return D}).apply(this,arguments)}function g(D,c){var p=Object.keys(D);if(Object.getOwnPropertySymbols){var S=Object.getOwnPropertySymbols(D);c&&(S=S.filter(function(C){return Object.getOwnPropertyDescriptor(D,C).enumerable})),p.push.apply(p,S)}return p}function m(D){for(var c=1;c<arguments.length;c++){var p=arguments[c]!=null?arguments[c]:{};c%2?g(Object(p),!0).forEach(function(S){h(D,S,p[S])}):Object.getOwnPropertyDescriptors?Object.defineProperties(D,Object.getOwnPropertyDescriptors(p)):g(Object(p)).forEach(function(S){Object.defineProperty(D,S,Object.getOwnPropertyDescriptor(p,S))})}return D}function h(D,c,p){return c in D?Object.defineProperty(D,c,{value:p,enumerable:!0,configurable:!0,writable:!0}):D[c]=p,D}var b=m(m({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:L.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:i.default,bufferController:y.default,capLevelController:T.default,fpsController:v.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:o.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0},{cueHandler:E.default,enableCEA708Captions:!0,enableWebVTT:!0,enableIMSC1:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:u.SubtitleStreamController,subtitleTrackController:A.default,timelineController:a.TimelineController,audioStreamController:n.default,audioTrackController:s.default,emeController:d.default});function k(D,c){if((c.liveSyncDurationCount||c.liveMaxLatencyDurationCount)&&(c.liveSyncDuration||c.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(c.liveMaxLatencyDurationCount!==void 0&&(c.liveSyncDurationCount===void 0||c.liveMaxLatencyDurationCount<=c.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(c.liveMaxLatencyDuration!==void 0&&(c.liveSyncDuration===void 0||c.liveMaxLatencyDuration<=c.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return l({},D,c)}function _(D){var c=D.loader;c!==R.default&&c!==L.default?(f.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),D.progressive=!1):Object(R.fetchSupported)()&&(D.loader=R.default,D.progressive=!0,D.enableSoftwareAES=!0,f.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}},"./src/controller/abr-controller.ts":function(e,t,r){r.r(t);var i=r("./src/polyfills/number.ts"),n=r("./src/utils/ewma-bandwidth-estimator.ts"),s=r("./src/events.ts"),u=r("./src/utils/buffer-helper.ts"),A=r("./src/errors.ts"),y=r("./src/types/loader.ts"),a=r("./src/utils/logger.ts");function T(d,L){for(var R=0;R<L.length;R++){var E=L[R];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(d,E.key,E)}}var v=function(){function d(o){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=o;var f=o.config;this.bwEstimator=new n.default(f.abrEwmaSlowVoD,f.abrEwmaFastVoD,f.abrEwmaDefaultEstimate),this.registerListeners()}var L,R,E=d.prototype;return E.registerListeners=function(){var o=this.hls;o.on(s.Events.FRAG_LOADING,this.onFragLoading,this),o.on(s.Events.FRAG_LOADED,this.onFragLoaded,this),o.on(s.Events.FRAG_BUFFERED,this.onFragBuffered,this),o.on(s.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.on(s.Events.ERROR,this.onError,this)},E.unregisterListeners=function(){var o=this.hls;o.off(s.Events.FRAG_LOADING,this.onFragLoading,this),o.off(s.Events.FRAG_LOADED,this.onFragLoaded,this),o.off(s.Events.FRAG_BUFFERED,this.onFragBuffered,this),o.off(s.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.off(s.Events.ERROR,this.onError,this)},E.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},E.onFragLoading=function(o,f){var l,g=f.frag;g.type===y.PlaylistLevelType.MAIN&&(this.timer||(this.fragCurrent=g,this.partCurrent=(l=f.part)!=null?l:null,this.timer=self.setInterval(this.onCheck,100)))},E.onLevelLoaded=function(o,f){var l=this.hls.config;f.details.live?this.bwEstimator.update(l.abrEwmaSlowLive,l.abrEwmaFastLive):this.bwEstimator.update(l.abrEwmaSlowVoD,l.abrEwmaFastVoD)},E._abandonRulesCheck=function(){var o=this.fragCurrent,f=this.partCurrent,l=this.hls,g=l.autoLevelEnabled,m=l.config,h=l.media;if(o&&h){var b=f?f.stats:o.stats,k=f?f.duration:o.duration;if(b.aborted)return a.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);if(g&&!h.paused&&h.playbackRate&&h.readyState){var _=performance.now()-b.loading.start,D=Math.abs(h.playbackRate);if(!(_<=500*k/D)){var c=l.levels,p=l.minAutoLevel,S=c[o.level],C=b.total||Math.max(b.loaded,Math.round(k*S.maxBitrate/8)),I=Math.max(1,b.bwEstimate?b.bwEstimate/8:1e3*b.loaded/_),w=(C-b.loaded)/I,O=h.currentTime,x=(u.BufferHelper.bufferInfo(h,O,m.maxBufferHole).end-O)/D;if(!(x>=2*k/D||w<=x)){var P,F=Number.POSITIVE_INFINITY;for(P=o.level-1;P>p&&!((F=k*c[P].maxBitrate/(6.4*I))<x);P--);if(!(F>=w)){var N=this.bwEstimator.getEstimate();a.logger.warn("Fragment "+o.sn+(f?" part "+f.index:"")+" of level "+o.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+P+`
      Current BW estimate: `+(Object(i.isFiniteNumber)(N)?(N/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+w.toFixed(3)+` s
      Estimated load time for the next fragment: `+F.toFixed(3)+` s
      Time to underbuffer: `+x.toFixed(3)+" s"),l.nextLoadLevel=P,this.bwEstimator.sample(_,b.loaded),this.clearTimer(),o.loader&&(this.fragCurrent=this.partCurrent=null,o.loader.abort()),l.trigger(s.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:o,part:f,stats:b})}}}}}},E.onFragLoaded=function(o,f){var l=f.frag,g=f.part;if(l.type===y.PlaylistLevelType.MAIN&&Object(i.isFiniteNumber)(l.sn)){var m=g?g.stats:l.stats,h=g?g.duration:l.duration;if(this.clearTimer(),this.lastLoadedFragLevel=l.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var b=this.hls.levels[l.level],k=(b.loaded?b.loaded.bytes:0)+m.loaded,_=(b.loaded?b.loaded.duration:0)+h;b.loaded={bytes:k,duration:_},b.realBitrate=Math.round(8*k/_)}if(l.bitrateTest){var D={stats:m,frag:l,part:g,id:l.type};this.onFragBuffered(s.Events.FRAG_BUFFERED,D),l.bitrateTest=!1}}},E.onFragBuffered=function(o,f){var l=f.frag,g=f.part,m=g?g.stats:l.stats;if(!m.aborted&&l.type===y.PlaylistLevelType.MAIN&&l.sn!=="initSegment"){var h=m.parsing.end-m.loading.start;this.bwEstimator.sample(h,m.loaded),m.bwEstimate=this.bwEstimator.getEstimate(),l.bitrateTest?this.bitrateTestDelay=h/1e3:this.bitrateTestDelay=0}},E.onError=function(o,f){switch(f.details){case A.ErrorDetails.FRAG_LOAD_ERROR:case A.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}},E.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},E.getNextABRAutoLevel=function(){var o=this.fragCurrent,f=this.partCurrent,l=this.hls,g=l.maxAutoLevel,m=l.config,h=l.minAutoLevel,b=l.media,k=f?f.duration:o?o.duration:0,_=b?b.currentTime:0,D=b&&b.playbackRate!==0?Math.abs(b.playbackRate):1,c=this.bwEstimator?this.bwEstimator.getEstimate():m.abrEwmaDefaultEstimate,p=(u.BufferHelper.bufferInfo(b,_,m.maxBufferHole).end-_)/D,S=this.findBestLevel(c,h,g,p,m.abrBandWidthFactor,m.abrBandWidthUpFactor);if(S>=0)return S;a.logger.trace((p?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var C=k?Math.min(k,m.maxStarvationDelay):m.maxStarvationDelay,I=m.abrBandWidthFactor,w=m.abrBandWidthUpFactor;if(!p){var O=this.bitrateTestDelay;O&&(C=(k?Math.min(k,m.maxLoadingDelay):m.maxLoadingDelay)-O,a.logger.trace("bitrate test took "+Math.round(1e3*O)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*C)+" ms"),I=w=1)}return S=this.findBestLevel(c,h,g,p+C,I,w),Math.max(S,0)},E.findBestLevel=function(o,f,l,g,m,h){for(var b,k=this.fragCurrent,_=this.partCurrent,D=this.lastLoadedFragLevel,c=this.hls.levels,p=c[D],S=!(p==null||(b=p.details)===null||b===void 0||!b.live),C=p==null?void 0:p.codecSet,I=_?_.duration:k?k.duration:0,w=l;w>=f;w--){var O=c[w];if(O&&(!C||O.codecSet===C)){var x=O.details,P=(_?x==null?void 0:x.partTarget:x==null?void 0:x.averagetargetduration)||I,F=void 0;F=w<=D?m*o:h*o;var N=c[w].maxBitrate,U=N*P/F;if(a.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+w+"/"+Math.round(F)+"/"+N+"/"+P+"/"+g+"/"+U),F>N&&(!U||S&&!this.bitrateTestDelay||U<g))return w}}return-1},L=d,(R=[{key:"nextAutoLevel",get:function(){var o=this._nextAutoLevel,f=this.bwEstimator;if(!(o===-1||f&&f.canEstimate()))return o;var l=this.getNextABRAutoLevel();return o!==-1&&(l=Math.min(o,l)),l},set:function(o){this._nextAutoLevel=o}}])&&T(L.prototype,R),d}();t.default=v},"./src/controller/audio-stream-controller.ts":function(e,t,r){r.r(t);var i=r("./src/polyfills/number.ts"),n=r("./src/controller/base-stream-controller.ts"),s=r("./src/events.ts"),u=r("./src/utils/buffer-helper.ts"),A=r("./src/controller/fragment-tracker.ts"),y=r("./src/types/level.ts"),a=r("./src/types/loader.ts"),T=r("./src/loader/fragment.ts"),v=r("./src/demux/chunk-cache.ts"),d=r("./src/demux/transmuxer-interface.ts"),L=r("./src/types/transmuxer.ts"),R=r("./src/controller/fragment-finders.ts"),E=r("./src/utils/discontinuities.ts"),o=r("./src/errors.ts"),f=r("./src/utils/logger.ts");function l(){return(l=Object.assign||function(h){for(var b=1;b<arguments.length;b++){var k=arguments[b];for(var _ in k)Object.prototype.hasOwnProperty.call(k,_)&&(h[_]=k[_])}return h}).apply(this,arguments)}function g(h,b){return(g=Object.setPrototypeOf||function(k,_){return k.__proto__=_,k})(h,b)}var m=function(h){var b,k;function _(c,p){var S;return(S=h.call(this,c,p,"[audio-stream-controller]")||this).videoBuffer=null,S.videoTrackCC=-1,S.waitingVideoCC=-1,S.audioSwitch=!1,S.trackId=-1,S.waitingData=null,S.mainDetails=null,S.bufferFlushed=!1,S._registerListeners(),S}k=h,(b=_).prototype=Object.create(k.prototype),b.prototype.constructor=b,g(b,k);var D=_.prototype;return D.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},D._registerListeners=function(){var c=this.hls;c.on(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),c.on(s.Events.MEDIA_DETACHING,this.onMediaDetaching,this),c.on(s.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.on(s.Events.LEVEL_LOADED,this.onLevelLoaded,this),c.on(s.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),c.on(s.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),c.on(s.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),c.on(s.Events.ERROR,this.onError,this),c.on(s.Events.BUFFER_RESET,this.onBufferReset,this),c.on(s.Events.BUFFER_CREATED,this.onBufferCreated,this),c.on(s.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),c.on(s.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),c.on(s.Events.FRAG_BUFFERED,this.onFragBuffered,this)},D._unregisterListeners=function(){var c=this.hls;c.off(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),c.off(s.Events.MEDIA_DETACHING,this.onMediaDetaching,this),c.off(s.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.off(s.Events.LEVEL_LOADED,this.onLevelLoaded,this),c.off(s.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),c.off(s.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),c.off(s.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),c.off(s.Events.ERROR,this.onError,this),c.off(s.Events.BUFFER_RESET,this.onBufferReset,this),c.off(s.Events.BUFFER_CREATED,this.onBufferCreated,this),c.off(s.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),c.off(s.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),c.off(s.Events.FRAG_BUFFERED,this.onFragBuffered,this)},D.onInitPtsFound=function(c,p){var S=p.frag,C=p.id,I=p.initPTS;if(C==="main"){var w=S.cc;this.initPTS[S.cc]=I,this.log("InitPTS for cc: "+w+" found from main: "+I),this.videoTrackCC=w,this.state===n.State.WAITING_INIT_PTS&&this.tick()}},D.startLoad=function(c){if(!this.levels)return this.startPosition=c,void(this.state=n.State.STOPPED);var p=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,p>0&&c===-1?(this.log("Override startPosition with lastCurrentTime @"+p.toFixed(3)),this.state=n.State.IDLE):(this.loadedmetadata=!1,this.state=n.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=c,this.tick()},D.doTick=function(){switch(this.state){case n.State.IDLE:this.doTickIdle();break;case n.State.WAITING_TRACK:var c,p=this.levels,S=this.trackId,C=p==null||(c=p[S])===null||c===void 0?void 0:c.details;if(C){if(this.waitForCdnTuneIn(C))break;this.state=n.State.WAITING_INIT_PTS}break;case n.State.FRAG_LOADING_WAITING_RETRY:var I,w=performance.now(),O=this.retryDate;(!O||w>=O||(I=this.media)!==null&&I!==void 0&&I.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.state=n.State.IDLE);break;case n.State.WAITING_INIT_PTS:var x=this.waitingData;if(x){var P=x.frag,F=x.part,N=x.cache,U=x.complete;if(this.initPTS[P.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=n.State.FRAG_LOADING;var j={frag:P,part:F,payload:N.flush(),networkDetails:null};this._handleFragmentLoadProgress(j),U&&h.prototype._handleFragmentLoadComplete.call(this,j)}else if(this.videoTrackCC!==this.waitingVideoCC)f.logger.log("Waiting fragment cc ("+P.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var V=this.getLoadPosition(),z=u.BufferHelper.bufferInfo(this.mediaBuffer,V,this.config.maxBufferHole);Object(R.fragmentWithinToleranceTest)(z.end,this.config.maxFragLookUpTolerance,P)<0&&(f.logger.log("Waiting fragment cc ("+P.cc+") @ "+P.start+" cancelled because another fragment at "+z.end+" is needed"),this.clearWaitingFragment())}}else this.state=n.State.IDLE}this.onTickEnd()},D.clearWaitingFragment=function(){var c=this.waitingData;c&&(this.fragmentTracker.removeFragment(c.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=n.State.IDLE)},D.onTickEnd=function(){var c=this.media;if(c&&c.readyState){var p=(this.mediaBuffer?this.mediaBuffer:c).buffered;!this.loadedmetadata&&p.length&&(this.loadedmetadata=!0),this.lastCurrentTime=c.currentTime}},D.doTickIdle=function(){var c,p,S=this.hls,C=this.levels,I=this.media,w=this.trackId,O=S.config;if(C&&C[w]&&(I||!this.startFragRequested&&O.startFragPrefetch)){var x=C[w].details;if(!x||x.live&&this.levelLastLoaded!==w||this.waitForCdnTuneIn(x))this.state=n.State.WAITING_TRACK;else{this.bufferFlushed&&(this.bufferFlushed=!1,this.afterBufferFlushed(this.mediaBuffer?this.mediaBuffer:this.media,T.ElementaryStreamTypes.AUDIO,a.PlaylistLevelType.AUDIO));var P=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,a.PlaylistLevelType.AUDIO);if(P!==null){var F=P.len,N=this.getMaxBufferLength(),U=this.audioSwitch;if(!(F>=N)||U){if(!U&&this._streamEnded(P,x))return S.trigger(s.Events.BUFFER_EOS,{type:"audio"}),void(this.state=n.State.ENDED);var j=x.fragments[0].start,V=P.end;if(U){var z=this.getLoadPosition();V=z,x.PTSKnown&&z<j&&(P.end>j||P.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),I.currentTime=j+.05)}var G=this.getNextFragment(V,x);G?((c=G.decryptdata)===null||c===void 0?void 0:c.keyFormat)!=="identity"||(p=G.decryptdata)!==null&&p!==void 0&&p.key?this.loadFragment(G,x,V):this.loadKey(G,x):this.bufferFlushed=!0}}}}},D.getMaxBufferLength=function(){var c=h.prototype.getMaxBufferLength.call(this),p=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,a.PlaylistLevelType.MAIN);return p===null?c:Math.max(c,p.len)},D.onMediaDetaching=function(){this.videoBuffer=null,h.prototype.onMediaDetaching.call(this)},D.onAudioTracksUpdated=function(c,p){var S=p.audioTracks;this.resetTransmuxer(),this.levels=S.map(function(C){return new y.Level(C)})},D.onAudioTrackSwitching=function(c,p){var S=!!p.url;this.trackId=p.id;var C=this.fragCurrent;C!=null&&C.loader&&C.loader.abort(),this.fragCurrent=null,this.clearWaitingFragment(),S?this.setInterval(100):this.resetTransmuxer(),S?(this.audioSwitch=!0,this.state=n.State.IDLE):this.state=n.State.STOPPED,this.tick()},D.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},D.onLevelLoaded=function(c,p){this.mainDetails=p.details},D.onAudioTrackLoaded=function(c,p){var S,C=this.levels,I=p.details,w=p.id;if(C){this.log("Track "+w+" loaded ["+I.startSN+","+I.endSN+"],duration:"+I.totalduration);var O=C[w],x=0;if(I.live||(S=O.details)!==null&&S!==void 0&&S.live){var P=this.mainDetails;if(I.fragments[0]||(I.deltaUpdateFailed=!0),I.deltaUpdateFailed||!P)return;!O.details&&I.hasProgramDateTime&&P.hasProgramDateTime?(Object(E.alignPDT)(I,P),x=I.fragments[0].start):x=this.alignPlaylists(I,O.details)}O.details=I,this.levelLastLoaded=w,this.startFragRequested||!this.mainDetails&&I.live||this.setStartPosition(O.details,x),this.state!==n.State.WAITING_TRACK||this.waitForCdnTuneIn(I)||(this.state=n.State.IDLE),this.tick()}else this.warn("Audio tracks were reset while loading level "+w)},D._handleFragmentLoadProgress=function(c){var p,S=c.frag,C=c.part,I=c.payload,w=this.config,O=this.trackId,x=this.levels;if(x){var P=x[O];console.assert(P,"Audio track is defined on fragment load progress");var F=P.details;console.assert(F,"Audio track details are defined on fragment load progress");var N=w.defaultAudioCodec||P.audioCodec||"mp4a.40.2",U=this.transmuxer;U||(U=this.transmuxer=new d.default(this.hls,a.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var j=this.initPTS[S.cc],V=(p=S.initSegment)===null||p===void 0?void 0:p.data;if(j!==void 0){var z=C?C.index:-1,G=z!==-1,W=new L.ChunkMetadata(S.level,S.sn,S.stats.chunkCount,I.byteLength,z,G);U.push(I,V,N,"",S,C,F.totalduration,!1,W,j)}else f.logger.log("Unknown video PTS for cc "+S.cc+", waiting for video PTS before demuxing audio frag "+S.sn+" of ["+F.startSN+" ,"+F.endSN+"],track "+O),(this.waitingData=this.waitingData||{frag:S,part:C,cache:new v.default,complete:!1}).cache.push(new Uint8Array(I)),this.waitingVideoCC=this.videoTrackCC,this.state=n.State.WAITING_INIT_PTS}else this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+S.sn+" of level "+S.level+" will not be buffered")},D._handleFragmentLoadComplete=function(c){this.waitingData?this.waitingData.complete=!0:h.prototype._handleFragmentLoadComplete.call(this,c)},D.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},D.onBufferCreated=function(c,p){var S=p.tracks.audio;S&&(this.mediaBuffer=S.buffer),p.tracks.video&&(this.videoBuffer=p.tracks.video.buffer)},D.onFragBuffered=function(c,p){var S=p.frag,C=p.part;S.type===a.PlaylistLevelType.AUDIO&&(this.fragContextChanged(S)?this.warn("Fragment "+S.sn+(C?" p: "+C.index:"")+" of level "+S.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch):(S.sn!=="initSegment"&&(this.fragPrevious=S,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(s.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(S,C)))},D.onError=function(c,p){switch(p.details){case o.ErrorDetails.FRAG_LOAD_ERROR:case o.ErrorDetails.FRAG_LOAD_TIMEOUT:case o.ErrorDetails.KEY_LOAD_ERROR:case o.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(a.PlaylistLevelType.AUDIO,p);break;case o.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case o.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==n.State.ERROR&&this.state!==n.State.STOPPED&&(this.state=p.fatal?n.State.ERROR:n.State.IDLE,this.warn(p.details+" while loading frag, switching to "+this.state+" state"));break;case o.ErrorDetails.BUFFER_FULL_ERROR:if(p.parent==="audio"&&(this.state===n.State.PARSING||this.state===n.State.PARSED)){var S=!0,C=this.getFwdBufferInfo(this.mediaBuffer,a.PlaylistLevelType.AUDIO);C&&C.len>.5&&(S=!this.reduceMaxBufferLength(C.len)),S&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,h.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}}},D.onBufferFlushed=function(c,p){p.type===T.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0)},D._handleTransmuxComplete=function(c){var p,S="audio",C=this.hls,I=c.remuxResult,w=c.chunkMeta,O=this.getCurrentContext(w);if(!O)return this.warn("The loading context changed while buffering fragment "+w.sn+" of level "+w.level+". This chunk will not be buffered."),void this.resetLiveStartWhenNotLoaded(w.level);var x=O.frag,P=O.part,F=I.audio,N=I.text,U=I.id3,j=I.initSegment;if(!this.fragContextChanged(x)){if(this.state=n.State.PARSING,this.audioSwitch&&F&&this.completeAudioSwitch(),j!=null&&j.tracks&&(this._bufferInitSegment(j.tracks,x,w),C.trigger(s.Events.FRAG_PARSING_INIT_SEGMENT,{frag:x,id:S,tracks:j.tracks})),F){var V=F.startPTS,z=F.endPTS,G=F.startDTS,W=F.endDTS;P&&(P.elementaryStreams[T.ElementaryStreamTypes.AUDIO]={startPTS:V,endPTS:z,startDTS:G,endDTS:W}),x.setElementaryStreamInfo(T.ElementaryStreamTypes.AUDIO,V,z,G,W),this.bufferFragmentData(F,x,P,w)}if(U!=null&&(p=U.samples)!==null&&p!==void 0&&p.length){var $=l({frag:x,id:S},U);C.trigger(s.Events.FRAG_PARSING_METADATA,$)}if(N){var Y=l({frag:x,id:S},N);C.trigger(s.Events.FRAG_PARSING_USERDATA,Y)}}},D._bufferInitSegment=function(c,p,S){if(this.state===n.State.PARSING){c.video&&delete c.video;var C=c.audio;if(C){C.levelCodec=C.codec,C.id="audio",this.log("Init audio buffer, container:"+C.container+", codecs[parsed]=["+C.codec+"]"),this.hls.trigger(s.Events.BUFFER_CODECS,c);var I=C.initSegment;if(I!=null&&I.byteLength){var w={type:"audio",frag:p,part:null,chunkMeta:S,parent:p.type,data:I};this.hls.trigger(s.Events.BUFFER_APPENDING,w)}this.tick()}}},D.loadFragment=function(c,p,S){var C=this.fragmentTracker.getState(c);this.fragCurrent=c,(this.audioSwitch||C===A.FragmentState.NOT_LOADED||C===A.FragmentState.PARTIAL)&&(c.sn==="initSegment"?this._loadInitSegment(c):p.live&&!Object(i.isFiniteNumber)(this.initPTS[c.cc])?(this.log("Waiting for video PTS in continuity counter "+c.cc+" of live stream before loading audio fragment "+c.sn+" of level "+this.trackId),this.state=n.State.WAITING_INIT_PTS):(this.startFragRequested=!0,h.prototype.loadFragment.call(this,c,p,S)))},D.completeAudioSwitch=function(){var c=this.hls,p=this.media,S=this.trackId;p&&(this.log("Switching audio track : flushing all audio"),h.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,c.trigger(s.Events.AUDIO_TRACK_SWITCHED,{id:S})},_}(n.default);t.default=m},"./src/controller/audio-track-controller.ts":function(e,t,r){r.r(t);var i=r("./src/events.ts"),n=r("./src/errors.ts"),s=r("./src/controller/base-playlist-controller.ts"),u=r("./src/types/loader.ts");function A(T,v){for(var d=0;d<v.length;d++){var L=v[d];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(T,L.key,L)}}function y(T,v){return(y=Object.setPrototypeOf||function(d,L){return d.__proto__=L,d})(T,v)}var a=function(T){var v,d;function L(f){var l;return(l=T.call(this,f,"[audio-track-controller]")||this).tracks=[],l.groupId=null,l.tracksInGroup=[],l.trackId=-1,l.trackName="",l.selectDefaultTrack=!0,l.registerListeners(),l}d=T,(v=L).prototype=Object.create(d.prototype),v.prototype.constructor=v,y(v,d);var R,E,o=L.prototype;return o.registerListeners=function(){var f=this.hls;f.on(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),f.on(i.Events.MANIFEST_PARSED,this.onManifestParsed,this),f.on(i.Events.LEVEL_LOADING,this.onLevelLoading,this),f.on(i.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),f.on(i.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),f.on(i.Events.ERROR,this.onError,this)},o.unregisterListeners=function(){var f=this.hls;f.off(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),f.off(i.Events.MANIFEST_PARSED,this.onManifestParsed,this),f.off(i.Events.LEVEL_LOADING,this.onLevelLoading,this),f.off(i.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),f.off(i.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),f.off(i.Events.ERROR,this.onError,this)},o.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,T.prototype.destroy.call(this)},o.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},o.onManifestParsed=function(f,l){this.tracks=l.audioTracks||[]},o.onAudioTrackLoaded=function(f,l){var g=l.id,m=l.details,h=this.tracksInGroup[g];if(h){var b=h.details;h.details=l.details,this.log("audioTrack "+g+" loaded ["+m.startSN+"-"+m.endSN+"]"),g===this.trackId&&(this.retryCount=0,this.playlistLoaded(g,l,b))}else this.warn("Invalid audio track id "+g)},o.onLevelLoading=function(f,l){this.switchLevel(l.level)},o.onLevelSwitching=function(f,l){this.switchLevel(l.level)},o.switchLevel=function(f){var l=this.hls.levels[f];if(l!=null&&l.audioGroupIds){var g=l.audioGroupIds[l.urlId];if(this.groupId!==g){this.groupId=g;var m=this.tracks.filter(function(b){return!g||b.groupId===g});this.selectDefaultTrack&&!m.some(function(b){return b.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=m;var h={audioTracks:m};this.log("Updating audio tracks, "+m.length+' track(s) found in "'+g+'" group-id'),this.hls.trigger(i.Events.AUDIO_TRACKS_UPDATED,h),this.selectInitialTrack()}}},o.onError=function(f,l){T.prototype.onError.call(this,f,l),!l.fatal&&l.context&&l.context.type===u.PlaylistContextType.AUDIO_TRACK&&l.context.id===this.trackId&&l.context.groupId===this.groupId&&this.retryLoadingOrFail(l)},o.setAudioTrack=function(f){var l=this.tracksInGroup;if(f<0||f>=l.length)this.warn("Invalid id passed to audio-track controller");else{this.clearTimer();var g=l[this.trackId];this.log("Now switching to audio-track index "+f);var m=l[f],h=m.id,b=m.groupId,k=b===void 0?"":b,_=m.name,D=m.type,c=m.url;if(this.trackId=f,this.trackName=_,this.selectDefaultTrack=!1,this.hls.trigger(i.Events.AUDIO_TRACK_SWITCHING,{id:h,groupId:k,name:_,type:D,url:c}),!m.details||m.details.live){var p=this.switchParams(m.url,g==null?void 0:g.details);this.loadPlaylist(p)}}},o.selectInitialTrack=function(){var f=this.tracksInGroup;console.assert(f.length,"Initial audio track should be selected when tracks are known");var l=this.trackName,g=this.findTrackId(l)||this.findTrackId();g!==-1?this.setAudioTrack(g):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},o.findTrackId=function(f){for(var l=this.tracksInGroup,g=0;g<l.length;g++){var m=l[g];if((!this.selectDefaultTrack||m.default)&&(!f||f===m.name))return m.id}return-1},o.loadPlaylist=function(f){var l=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(l)){var g=l.id,m=l.groupId,h=l.url;if(f)try{h=f.addDirectives(h)}catch(b){this.warn("Could not construct new URL with HLS Delivery Directives: "+b)}this.log("loading audio-track playlist for id: "+g),this.clearTimer(),this.hls.trigger(i.Events.AUDIO_TRACK_LOADING,{url:h,id:g,groupId:m,deliveryDirectives:f||null})}},R=L,(E=[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(f){this.selectDefaultTrack=!1,this.setAudioTrack(f)}}])&&A(R.prototype,E),L}(s.default);t.default=a},"./src/controller/base-playlist-controller.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return y});var i=r("./src/polyfills/number.ts"),n=r("./src/types/level.ts"),s=r("./src/controller/level-helper.ts"),u=r("./src/utils/logger.ts"),A=r("./src/errors.ts"),y=function(){function a(v,d){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=u.logger.log.bind(u.logger,d+":"),this.warn=u.logger.warn.bind(u.logger,d+":"),this.hls=v}var T=a.prototype;return T.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},T.onError=function(v,d){d.fatal&&d.type===A.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},T.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},T.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},T.stopLoad=function(){this.canLoad=!1,this.clearTimer()},T.switchParams=function(v,d){var L=d==null?void 0:d.renditionReports;if(L)for(var R=0;R<L.length;R++){var E=L[R],o=""+E.URI;if(o===v.substr(-o.length)){var f=parseInt(E["LAST-MSN"]),l=parseInt(E["LAST-PART"]);if(d&&this.hls.config.lowLatencyMode){var g=Math.min(d.age-d.partTarget,d.targetduration);l!==void 0&&g>d.partTarget&&(l+=1)}if(Object(i.isFiniteNumber)(f))return new n.HlsUrlParameters(f,Object(i.isFiniteNumber)(l)?l:void 0,n.HlsSkip.No)}}},T.loadPlaylist=function(v){},T.shouldLoadTrack=function(v){return this.canLoad&&v&&!!v.url&&(!v.details||v.details.live)},T.playlistLoaded=function(v,d,L){var R=this,E=d.details,o=d.stats,f=o.loading.end?Math.max(0,self.performance.now()-o.loading.end):0;if(E.advancedDateTime=Date.now()-f,E.live||L!=null&&L.live){if(E.reloaded(L),L&&this.log("live playlist "+v+" "+(E.advanced?"REFRESHED "+E.lastPartSn+"-"+E.lastPartIndex:"MISSED")),L&&E.fragments.length>0&&Object(s.mergeDetails)(L,E),!this.canLoad||!E.live)return;var l,g=void 0,m=void 0;if(E.canBlockReload&&E.endSN&&E.advanced){var h=this.hls.config.lowLatencyMode,b=E.lastPartSn,k=E.endSN,_=E.lastPartIndex,D=b===k;_!==-1?(g=D?k+1:b,m=D?h?0:_:_+1):g=k+1;var c=E.age,p=c+E.ageHeader,S=Math.min(p-E.partTarget,1.5*E.targetduration);if(S>0){if(L&&S>L.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+L.tuneInGoal+" to: "+S+" with playlist age: "+E.age),S=0;else{var C=Math.floor(S/E.targetduration);g+=C,m!==void 0&&(m+=Math.round(S%E.targetduration/E.partTarget)),this.log("CDN Tune-in age: "+E.ageHeader+"s last advanced "+c.toFixed(2)+"s goal: "+S+" skip sn "+C+" to part "+m)}E.tuneInGoal=S}if(l=this.getDeliveryDirectives(E,d.deliveryDirectives,g,m),h||!D)return void this.loadPlaylist(l)}else l=this.getDeliveryDirectives(E,d.deliveryDirectives,g,m);var I=Object(s.computeReloadInterval)(E,o);g!==void 0&&E.canBlockReload&&(I-=E.partTarget||1),this.log("reload live playlist "+v+" in "+Math.round(I)+" ms"),this.timer=self.setTimeout(function(){return R.loadPlaylist(l)},I)}else this.clearTimer()},T.getDeliveryDirectives=function(v,d,L,R){var E=Object(n.getSkipValue)(v,L);return d!=null&&d.skip&&v.deltaUpdateFailed&&(L=d.msn,R=d.part,E=n.HlsSkip.No),new n.HlsUrlParameters(L,R,E)},T.retryLoadingOrFail=function(v){var d,L=this,R=this.hls.config,E=this.retryCount<R.levelLoadingMaxRetry;if(E)if(this.retryCount++,v.details.indexOf("LoadTimeOut")>-1&&(d=v.context)!==null&&d!==void 0&&d.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+v.details+'"'),this.loadPlaylist();else{var o=Math.min(Math.pow(2,this.retryCount)*R.levelLoadingRetryDelay,R.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return L.loadPlaylist()},o),this.warn("retry playlist loading #"+this.retryCount+" in "+o+' ms after "'+v.details+'"')}else this.warn('cannot recover from error "'+v.details+'"'),this.clearTimer(),v.fatal=!0;return E},a}()},"./src/controller/base-stream-controller.ts":function(e,t,r){r.r(t),r.d(t,"State",function(){return h}),r.d(t,"default",function(){return b});var i=r("./src/polyfills/number.ts"),n=r("./src/task-loop.ts"),s=r("./src/controller/fragment-tracker.ts"),u=r("./src/utils/buffer-helper.ts"),A=r("./src/utils/logger.ts"),y=r("./src/events.ts"),a=r("./src/errors.ts"),T=r("./src/types/transmuxer.ts"),v=r("./src/utils/mp4-tools.ts"),d=r("./src/utils/discontinuities.ts"),L=r("./src/controller/fragment-finders.ts"),R=r("./src/controller/level-helper.ts"),E=r("./src/loader/fragment-loader.ts"),o=r("./src/crypt/decrypter.ts"),f=r("./src/utils/time-ranges.ts"),l=r("./src/types/loader.ts");function g(k,_){for(var D=0;D<_.length;D++){var c=_[D];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(k,c.key,c)}}function m(k,_){return(m=Object.setPrototypeOf||function(D,c){return D.__proto__=c,D})(k,_)}var h={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BACKTRACKING:"BACKTRACKING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},b=function(k){var _,D;function c(I,w,O){var x;return(x=k.call(this)||this).hls=void 0,x.fragPrevious=null,x.fragCurrent=null,x.fragmentTracker=void 0,x.transmuxer=null,x._state=h.STOPPED,x.media=void 0,x.mediaBuffer=void 0,x.config=void 0,x.bitrateTest=!1,x.lastCurrentTime=0,x.nextLoadPosition=0,x.startPosition=0,x.loadedmetadata=!1,x.fragLoadError=0,x.retryDate=0,x.levels=null,x.fragmentLoader=void 0,x.levelLastLoaded=null,x.startFragRequested=!1,x.decrypter=void 0,x.initPTS=[],x.onvseeking=null,x.onvended=null,x.logPrefix="",x.log=void 0,x.warn=void 0,x.logPrefix=O,x.log=A.logger.log.bind(A.logger,O+":"),x.warn=A.logger.warn.bind(A.logger,O+":"),x.hls=I,x.fragmentLoader=new E.default(I.config),x.fragmentTracker=w,x.config=I.config,x.decrypter=new o.default(I,I.config),I.on(y.Events.KEY_LOADED,x.onKeyLoaded,function(P){if(P===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P}(x)),x}D=k,(_=c).prototype=Object.create(D.prototype),_.prototype.constructor=_,m(_,D);var p,S,C=c.prototype;return C.doTick=function(){this.onTickEnd()},C.onTickEnd=function(){},C.startLoad=function(I){},C.stopLoad=function(){this.fragmentLoader.abort();var I=this.fragCurrent;I&&this.fragmentTracker.removeFragment(I),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=h.STOPPED},C._streamEnded=function(I,w){var O=this.fragCurrent,x=this.fragmentTracker;if(!w.live&&O&&O.sn===w.endSN&&!I.nextStart){var P=x.getState(O);return P===s.FragmentState.PARTIAL||P===s.FragmentState.OK}return!1},C.onMediaAttached=function(I,w){var O=this.media=this.mediaBuffer=w.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),O.addEventListener("seeking",this.onvseeking),O.addEventListener("ended",this.onvended);var x=this.config;this.levels&&x.autoStartLoad&&this.state===h.STOPPED&&this.startLoad(x.startPosition)},C.onMediaDetaching=function(){var I=this.media;I!=null&&I.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),I&&(I.removeEventListener("seeking",this.onvseeking),I.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},C.onMediaSeeking=function(){var I=this.config,w=this.fragCurrent,O=this.media,x=this.mediaBuffer,P=this.state,F=O?O.currentTime:0,N=u.BufferHelper.bufferInfo(x||O,F,I.maxBufferHole);if(this.log("media seeking to "+(Object(i.isFiniteNumber)(F)?F.toFixed(3):F)+", state: "+P),P===h.ENDED)this.resetLoadingState();else if(w&&!N.len){var U=I.maxFragLookUpTolerance,j=w.start-U,V=F>w.start+w.duration+U;(F<j||V)&&(V&&w.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),w.loader.abort()),this.resetLoadingState())}O&&(this.lastCurrentTime=F),this.loadedmetadata||N.len||(this.nextLoadPosition=this.startPosition=F),this.tickImmediate()},C.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},C.onKeyLoaded=function(I,w){if(this.state===h.KEY_LOADING&&w.frag===this.fragCurrent&&this.levels){this.state=h.IDLE;var O=this.levels[w.frag.level].details;O&&this.loadFragment(w.frag,O,w.frag.start)}},C.onHandlerDestroying=function(){this.stopLoad(),k.prototype.onHandlerDestroying.call(this)},C.onHandlerDestroyed=function(){this.state=h.STOPPED,this.hls.off(y.Events.KEY_LOADED,this.onKeyLoaded,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,k.prototype.onHandlerDestroyed.call(this)},C.loadKey=function(I,w){this.log("Loading key for "+I.sn+" of ["+w.startSN+"-"+w.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+I.level),this.state=h.KEY_LOADING,this.fragCurrent=I,this.hls.trigger(y.Events.KEY_LOADING,{frag:I})},C.loadFragment=function(I,w,O){this._loadFragForPlayback(I,w,O)},C._loadFragForPlayback=function(I,w,O){var x=this;this._doFragLoad(I,w,O,function(P){if(x.fragContextChanged(I))return x.warn("Fragment "+I.sn+(P.part?" p: "+P.part.index:"")+" of level "+I.level+" was dropped during download."),void x.fragmentTracker.removeFragment(I);I.stats.chunkCount++,x._handleFragmentLoadProgress(P)}).then(function(P){if(P){x.fragLoadError=0;var F=x.state;if(!x.fragContextChanged(I))return"payload"in P&&(x.log("Loaded fragment "+I.sn+" of level "+I.level),x.hls.trigger(y.Events.FRAG_LOADED,P),x.state===h.BACKTRACKING)?(x.fragmentTracker.backtrack(I,P),void x.resetFragmentLoading(I)):void x._handleFragmentLoadComplete(P);(F===h.FRAG_LOADING||F===h.BACKTRACKING||!x.fragCurrent&&F===h.PARSING)&&(x.fragmentTracker.removeFragment(I),x.state=h.IDLE)}}).catch(function(P){x.warn(P),x.resetFragmentLoading(I)})},C.flushMainBuffer=function(I,w,O){if(O===void 0&&(O=null),I-w){var x={startOffset:I,endOffset:w,type:O};this.fragLoadError=0,this.hls.trigger(y.Events.BUFFER_FLUSHING,x)}},C._loadInitSegment=function(I){var w=this;this._doFragLoad(I).then(function(O){if(!O||w.fragContextChanged(I)||!w.levels)throw new Error("init load aborted");return O}).then(function(O){var x=w.hls,P=O.payload,F=I.decryptdata;if(P&&P.byteLength>0&&F&&F.key&&F.iv&&F.method==="AES-128"){var N=self.performance.now();return w.decrypter.webCryptoDecrypt(new Uint8Array(P),F.key.buffer,F.iv.buffer).then(function(U){var j=self.performance.now();return x.trigger(y.Events.FRAG_DECRYPTED,{frag:I,payload:U,stats:{tstart:N,tdecrypt:j}}),O.payload=U,O})}return O}).then(function(O){var x=w.fragCurrent,P=w.hls,F=w.levels;if(!F)throw new Error("init load aborted, missing levels");var N=F[I.level].details;console.assert(N,"Level details are defined when init segment is loaded");var U=I.stats;w.state=h.IDLE,w.fragLoadError=0,I.data=new Uint8Array(O.payload),U.parsing.start=U.buffering.start=self.performance.now(),U.parsing.end=U.buffering.end=self.performance.now(),O.frag===x&&P.trigger(y.Events.FRAG_BUFFERED,{stats:U,frag:x,part:null,id:I.type}),w.tick()}).catch(function(O){w.warn(O),w.resetFragmentLoading(I)})},C.fragContextChanged=function(I){var w=this.fragCurrent;return!I||!w||I.level!==w.level||I.sn!==w.sn||I.urlId!==w.urlId},C.fragBufferedComplete=function(I,w){var O=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+I.type+" sn: "+I.sn+(w?" part: "+w.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+I.level+" "+f.default.toString(u.BufferHelper.getBuffered(O))),this.state=h.IDLE,this.tick()},C._handleFragmentLoadComplete=function(I){var w=this.transmuxer;if(w){var O=I.frag,x=I.part,P=I.partsLoaded,F=!P||P.length===0||P.some(function(U){return!U}),N=new T.ChunkMetadata(O.level,O.sn,O.stats.chunkCount+1,0,x?x.index:-1,!F);w.flush(N)}},C._handleFragmentLoadProgress=function(I){},C._doFragLoad=function(I,w,O,x){var P=this;if(O===void 0&&(O=null),!this.levels)throw new Error("frag load aborted, missing levels");if(O=Math.max(I.start,O||0),this.config.lowLatencyMode&&w){var F=w.partList;if(F&&x){O>I.end&&w.fragmentHint&&(I=w.fragmentHint);var N=this.getNextPart(F,I,O);if(N>-1){var U=F[N];return this.log("Loading part sn: "+I.sn+" p: "+U.index+" cc: "+I.cc+" of playlist ["+w.startSN+"-"+w.endSN+"] parts [0-"+N+"-"+(F.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+I.level+", target: "+parseFloat(O.toFixed(3))),this.nextLoadPosition=U.start+U.duration,this.state=h.FRAG_LOADING,this.hls.trigger(y.Events.FRAG_LOADING,{frag:I,part:F[N],targetBufferTime:O}),this.doFragPartsLoad(I,F,N,x).catch(function(j){return P.handleFragLoadError(j)})}if(!I.url||this.loadedEndOfParts(F,O))return Promise.resolve(null)}}return this.log("Loading fragment "+I.sn+" cc: "+I.cc+" "+(w?"of ["+w.startSN+"-"+w.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+I.level+", target: "+parseFloat(O.toFixed(3))),Object(i.isFiniteNumber)(I.sn)&&!this.bitrateTest&&(this.nextLoadPosition=I.start+I.duration),this.state=h.FRAG_LOADING,this.hls.trigger(y.Events.FRAG_LOADING,{frag:I,targetBufferTime:O}),this.fragmentLoader.load(I,x).catch(function(j){return P.handleFragLoadError(j)})},C.doFragPartsLoad=function(I,w,O,x){var P=this;return new Promise(function(F,N){var U=[];(function j(V){var z=w[V];P.fragmentLoader.loadPart(I,z,x).then(function(G){U[z.index]=G;var W=G.part;P.hls.trigger(y.Events.FRAG_LOADED,G);var $=w[V+1];if(!$||$.fragment!==I)return F({frag:I,part:W,partsLoaded:U});j(V+1)}).catch(N)})(O)})},C.handleFragLoadError=function(I){var w=I.data;return w&&w.details===a.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(w.frag,w.part):this.hls.trigger(y.Events.ERROR,w),null},C._handleTransmuxerFlush=function(I){var w=this.getCurrentContext(I);if(w&&this.state===h.PARSING){var O=w.frag,x=w.part,P=w.level,F=self.performance.now();O.stats.parsing.end=F,x&&(x.stats.parsing.end=F),this.updateLevelTiming(O,x,P,I.partial)}else this.fragCurrent||(this.state=h.IDLE)},C.getCurrentContext=function(I){var w=this.levels,O=I.level,x=I.sn,P=I.part;if(!w||!w[O])return this.warn("Levels object was unset while buffering fragment "+x+" of level "+O+". The current chunk will not be buffered."),null;var F=w[O],N=P>-1?Object(R.getPartWith)(F,x,P):null,U=N?N.fragment:Object(R.getFragmentWithSN)(F,x,this.fragCurrent);return U?{frag:U,part:N,level:F}:null},C.bufferFragmentData=function(I,w,O,x){if(I&&this.state===h.PARSING){var P=I.data1,F=I.data2,N=P;if(P&&F&&(N=Object(v.appendUint8Array)(P,F)),N&&N.length){var U={type:I.type,frag:w,part:O,chunkMeta:x,parent:w.type,data:N};this.hls.trigger(y.Events.BUFFER_APPENDING,U),I.dropped&&I.independent&&!O&&this.flushBufferGap(w)}}},C.flushBufferGap=function(I){var w=this.media;if(w)if(u.BufferHelper.isBuffered(w,w.currentTime)){var O=w.currentTime,x=u.BufferHelper.bufferInfo(w,O,0),P=I.duration,F=Math.min(2*this.config.maxFragLookUpTolerance,.25*P),N=Math.max(Math.min(I.start-F,x.end-F),O+F);I.start-N>F&&this.flushMainBuffer(N,I.start)}else this.flushMainBuffer(0,I.start)},C.getFwdBufferInfo=function(I,w){var O=this.config,x=this.getLoadPosition();if(!Object(i.isFiniteNumber)(x))return null;var P=u.BufferHelper.bufferInfo(I,x,O.maxBufferHole);if(P.len===0&&P.nextStart!==void 0){var F=this.fragmentTracker.getBufferedFrag(x,w);if(F&&P.nextStart<F.end)return u.BufferHelper.bufferInfo(I,x,Math.max(P.nextStart,O.maxBufferHole))}return P},C.getMaxBufferLength=function(I){var w,O=this.config;return w=I?Math.max(8*O.maxBufferSize/I,O.maxBufferLength):O.maxBufferLength,Math.min(w,O.maxMaxBufferLength)},C.reduceMaxBufferLength=function(I){var w=this.config,O=I||w.maxBufferLength;return w.maxMaxBufferLength>=O&&(w.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+w.maxMaxBufferLength+"s"),!0)},C.getNextFragment=function(I,w){var O,x,P=w.fragments,F=P.length;if(!F)return null;var N,U=this.config,j=P[0].start;if(w.live){var V=U.initialLiveManifestSize;if(F<V)return this.warn("Not enough fragments to start playback (have: "+F+", need: "+V+")"),null;w.PTSKnown||this.startFragRequested||this.startPosition!==-1||(N=this.getInitialLiveFragment(w,P),this.startPosition=N?this.hls.liveSyncPosition||N.start:I)}else I<=j&&(N=P[0]);if(!N){var z=U.lowLatencyMode?w.partEnd:w.fragmentEnd;N=this.getFragmentAtPosition(I,z,w)}return(O=N)===null||O===void 0||!O.initSegment||(x=N)!==null&&x!==void 0&&x.initSegment.data||this.bitrateTest||(N=N.initSegment),N},C.getNextPart=function(I,w,O){for(var x=-1,P=!1,F=!0,N=0,U=I.length;N<U;N++){var j=I[N];if(F=F&&!j.independent,x>-1&&O<j.start)break;var V=j.loaded;!V&&(P||j.independent||F)&&j.fragment===w&&(x=N),P=V}return x},C.loadedEndOfParts=function(I,w){var O=I[I.length-1];return O&&w>O.start&&O.loaded},C.getInitialLiveFragment=function(I,w){var O=this.fragPrevious,x=null;if(O){if(I.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+O.programDateTime),x=Object(L.findFragmentByPDT)(w,O.endProgramDateTime,this.config.maxFragLookUpTolerance)),!x){var P=O.sn+1;if(P>=I.startSN&&P<=I.endSN){var F=w[P-I.startSN];O.cc===F.cc&&(x=F,this.log("Live playlist, switching playlist, load frag with next SN: "+x.sn))}x||(x=Object(L.findFragWithCC)(w,O.cc))&&this.log("Live playlist, switching playlist, load frag with same CC: "+x.sn)}}else{var N=this.hls.liveSyncPosition;N!==null&&(x=this.getFragmentAtPosition(N,this.bitrateTest?I.fragmentEnd:I.edge,I))}return x},C.getFragmentAtPosition=function(I,w,O){var x,P=this.config,F=this.fragPrevious,N=O.fragments,U=O.endSN,j=O.fragmentHint,V=P.maxFragLookUpTolerance,z=!!(P.lowLatencyMode&&O.partList&&j);if(z&&j&&!this.bitrateTest&&(N=N.concat(j),U=j.sn),I<w){var G=I>w-V?0:V;x=Object(L.findFragmentByPTS)(F,N,I,G)}else x=N[N.length-1];if(x){var W=x.sn-O.startSN,$=F&&x.level===F.level,Y=N[W+1];if(this.fragmentTracker.getState(x)===s.FragmentState.BACKTRACKED){x=null;for(var re=W;N[re]&&this.fragmentTracker.getState(N[re])===s.FragmentState.BACKTRACKED;)x=F?N[re--]:N[--re];x||(x=Y)}else F&&x.sn===F.sn&&!z&&$&&(x.sn<U&&this.fragmentTracker.getState(Y)!==s.FragmentState.OK?(this.log("SN "+x.sn+" just loaded, load next one: "+Y.sn),x=Y):x=null)}return x},C.synchronizeToLiveEdge=function(I){var w=this.config,O=this.media;if(O){var x=this.hls.liveSyncPosition,P=O.currentTime,F=I.fragments[0].start,N=I.edge,U=P>=F-w.maxFragLookUpTolerance&&P<=N;if(x!==null&&O.duration>x&&(P<x||!U)){var j=w.liveMaxLatencyDuration!==void 0?w.liveMaxLatencyDuration:w.liveMaxLatencyDurationCount*I.targetduration;(!U&&O.readyState<4||P<N-j)&&(this.loadedmetadata||(this.nextLoadPosition=x),O.readyState&&(this.warn("Playback: "+P.toFixed(3)+" is located too far from the end of live sliding playlist: "+N+", reset currentTime to : "+x.toFixed(3)),O.currentTime=x))}}},C.alignPlaylists=function(I,w){var O=this.levels,x=this.levelLastLoaded,P=this.fragPrevious,F=x!==null?O[x]:null,N=I.fragments.length;if(!N)return this.warn("No fragments in live playlist"),0;var U=I.fragments[0].start,j=!w,V=I.alignedSliding&&Object(i.isFiniteNumber)(U);if(j||!V&&!U){Object(d.alignStream)(P,F,I);var z=I.fragments[0].start;return this.log("Live playlist sliding: "+z.toFixed(2)+" start-sn: "+(w?w.startSN:"na")+"->"+I.startSN+" prev-sn: "+(P?P.sn:"na")+" fragments: "+N),z}return U},C.waitForCdnTuneIn=function(I){return I.live&&I.canBlockReload&&I.tuneInGoal>Math.max(I.partHoldBack,3*I.partTarget)},C.setStartPosition=function(I,w){var O=this.startPosition;if(O<w&&(O=-1),O===-1||this.lastCurrentTime===-1){var x=I.startTimeOffset;Object(i.isFiniteNumber)(x)?(O=w+x,x<0&&(O+=I.totalduration),O=Math.min(Math.max(w,O),w+I.totalduration),this.log("Start time offset "+x+" found in playlist, adjust startPosition to "+O),this.startPosition=O):I.live?O=this.hls.liveSyncPosition||w:this.startPosition=O=0,this.lastCurrentTime=O}this.nextLoadPosition=O},C.getLoadPosition=function(){var I=this.media,w=0;return this.loadedmetadata&&I?w=I.currentTime:this.nextLoadPosition&&(w=this.nextLoadPosition),w},C.handleFragLoadAborted=function(I,w){this.transmuxer&&I.sn!=="initSegment"&&I.stats.aborted&&(this.warn("Fragment "+I.sn+(w?" part"+w.index:"")+" of level "+I.level+" was aborted"),this.resetFragmentLoading(I))},C.resetFragmentLoading=function(I){this.fragCurrent&&this.fragContextChanged(I)||(this.state=h.IDLE)},C.onFragmentOrKeyLoadError=function(I,w){if(!w.fatal){var O=w.frag;if(O&&O.type===I){var x=this.fragCurrent;console.assert(x&&O.sn===x.sn&&O.level===x.level&&O.urlId===x.urlId,"Frag load error must match current frag to retry");var P=this.config;if(this.fragLoadError+1<=P.fragLoadingMaxRetry){if(this.resetLiveStartWhenNotLoaded(O.level))return;var F=Math.min(Math.pow(2,this.fragLoadError)*P.fragLoadingRetryDelay,P.fragLoadingMaxRetryTimeout);this.warn("Fragment "+O.sn+" of "+I+" "+O.level+" failed to load, retrying in "+F+"ms"),this.retryDate=self.performance.now()+F,this.fragLoadError++,this.state=h.FRAG_LOADING_WAITING_RETRY}else w.levelRetry?(I===l.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=h.IDLE):(A.logger.error(w.details+" reaches max retry, redispatch as fatal ..."),w.fatal=!0,this.hls.stopLoad(),this.state=h.ERROR)}}},C.afterBufferFlushed=function(I,w,O){if(I){var x=u.BufferHelper.getBuffered(I);this.fragmentTracker.detectEvictedFragments(w,x,O),this.state===h.ENDED&&this.resetLoadingState()}},C.resetLoadingState=function(){this.fragCurrent=null,this.fragPrevious=null,this.state=h.IDLE},C.resetLiveStartWhenNotLoaded=function(I){if(!this.loadedmetadata){this.startFragRequested=!1;var w=this.levels?this.levels[I].details:null;if(w!=null&&w.live)return this.startPosition=-1,this.setStartPosition(w,0),this.resetLoadingState(),!0;this.nextLoadPosition=this.startPosition}return!1},C.updateLevelTiming=function(I,w,O,x){var P=this,F=O.details;console.assert(!!F,"level.details must be defined"),Object.keys(I.elementaryStreams).reduce(function(N,U){var j=I.elementaryStreams[U];if(j){var V=j.endPTS-j.startPTS;if(V<=0)return P.warn("Could not parse fragment "+I.sn+" "+U+" duration reliably ("+V+") resetting transmuxer to fallback to playlist timing"),P.resetTransmuxer(),N||!1;var z=x?0:Object(R.updateFragPTSDTS)(F,I,j.startPTS,j.endPTS,j.startDTS,j.endDTS);return P.hls.trigger(y.Events.LEVEL_PTS_UPDATED,{details:F,level:O,drift:z,type:U,frag:I,start:j.startPTS,end:j.endPTS}),!0}return N},!1)?(this.state=h.PARSED,this.hls.trigger(y.Events.FRAG_PARSED,{frag:I,part:w})):this.resetLoadingState()},C.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},p=c,(S=[{key:"state",get:function(){return this._state},set:function(I){var w=this._state;w!==I&&(this._state=I,this.log(w+"->"+I))}}])&&g(p.prototype,S),c}(n.default)},"./src/controller/buffer-controller.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return L});var i=r("./src/polyfills/number.ts"),n=r("./src/events.ts"),s=r("./src/utils/logger.ts"),u=r("./src/errors.ts"),A=r("./src/utils/buffer-helper.ts"),y=r("./src/utils/mediasource-helper.ts"),a=r("./src/loader/fragment.ts"),T=r("./src/controller/buffer-operation-queue.ts"),v=Object(y.getMediaSource)(),d=/([ha]vc.)(?:\.[^.,]+)+/,L=function(){function R(o){var f=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var l=f.hls,g=f.media,m=f.mediaSource;s.logger.log("[buffer-controller]: Media source opened"),g&&(f.updateMediaElementDuration(),l.trigger(n.Events.MEDIA_ATTACHED,{media:g})),m&&m.removeEventListener("sourceopen",f._onMediaSourceOpen),f.checkPendingTracks()},this._onMediaSourceClose=function(){s.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){s.logger.log("[buffer-controller]: Media source ended")},this.hls=o,this._initSourceBuffer(),this.registerListeners()}var E=R.prototype;return E.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},E.destroy=function(){this.unregisterListeners(),this.details=null},E.registerListeners=function(){var o=this.hls;o.on(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),o.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.on(n.Events.BUFFER_RESET,this.onBufferReset,this),o.on(n.Events.BUFFER_APPENDING,this.onBufferAppending,this),o.on(n.Events.BUFFER_CODECS,this.onBufferCodecs,this),o.on(n.Events.BUFFER_EOS,this.onBufferEos,this),o.on(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),o.on(n.Events.LEVEL_UPDATED,this.onLevelUpdated,this),o.on(n.Events.FRAG_PARSED,this.onFragParsed,this),o.on(n.Events.FRAG_CHANGED,this.onFragChanged,this)},E.unregisterListeners=function(){var o=this.hls;o.off(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),o.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.off(n.Events.BUFFER_RESET,this.onBufferReset,this),o.off(n.Events.BUFFER_APPENDING,this.onBufferAppending,this),o.off(n.Events.BUFFER_CODECS,this.onBufferCodecs,this),o.off(n.Events.BUFFER_EOS,this.onBufferEos,this),o.off(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),o.off(n.Events.LEVEL_UPDATED,this.onLevelUpdated,this),o.off(n.Events.FRAG_PARSED,this.onFragParsed,this),o.off(n.Events.FRAG_CHANGED,this.onFragChanged,this)},E._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new T.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},E.onManifestParsed=function(o,f){var l=2;(f.audio&&!f.video||!f.altAudio)&&(l=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=l,this.details=null,s.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},E.onMediaAttaching=function(o,f){var l=this.media=f.media;if(l&&v){var g=this.mediaSource=new v;g.addEventListener("sourceopen",this._onMediaSourceOpen),g.addEventListener("sourceended",this._onMediaSourceEnded),g.addEventListener("sourceclose",this._onMediaSourceClose),l.src=self.URL.createObjectURL(g),this._objectUrl=l.src}},E.onMediaDetaching=function(){var o=this.media,f=this.mediaSource,l=this._objectUrl;if(f){if(s.logger.log("[buffer-controller]: media source detaching"),f.readyState==="open")try{f.endOfStream()}catch(g){s.logger.warn("[buffer-controller]: onMediaDetaching: "+g.message+" while calling endOfStream")}this.onBufferReset(),f.removeEventListener("sourceopen",this._onMediaSourceOpen),f.removeEventListener("sourceended",this._onMediaSourceEnded),f.removeEventListener("sourceclose",this._onMediaSourceClose),o&&(l&&self.URL.revokeObjectURL(l),o.src===l?(o.removeAttribute("src"),o.load()):s.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(n.Events.MEDIA_DETACHED,void 0)},E.onBufferReset=function(){var o=this;this.getSourceBufferTypes().forEach(function(f){var l=o.sourceBuffer[f];try{l&&(o.removeBufferListeners(f),o.mediaSource&&o.mediaSource.removeSourceBuffer(l),o.sourceBuffer[f]=void 0)}catch(g){s.logger.warn("[buffer-controller]: Failed to reset the "+f+" buffer",g)}}),this._initSourceBuffer()},E.onBufferCodecs=function(o,f){var l=this,g=this.getSourceBufferTypes().length;Object.keys(f).forEach(function(m){if(g){var h=l.tracks[m];if(h&&typeof h.buffer.changeType=="function"){var b=f[m],k=b.codec,_=b.levelCodec,D=b.container;if((h.levelCodec||h.codec).replace(d,"$1")!==(_||k).replace(d,"$1")){var c=D+";codecs="+(_||k);l.appendChangeType(m,c)}}}else l.pendingTracks[m]=f[m]}),g||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},E.appendChangeType=function(o,f){var l=this,g=this.operationQueue,m={execute:function(){var h=l.sourceBuffer[o];h&&(s.logger.log("[buffer-controller]: changing "+o+" sourceBuffer type to "+f),h.changeType(f)),g.shiftAndExecuteNext(o)},onStart:function(){},onComplete:function(){},onError:function(h){s.logger.warn("[buffer-controller]: Failed to change "+o+" SourceBuffer type",h)}};g.append(m,o)},E.onBufferAppending=function(o,f){var l=this,g=this.hls,m=this.operationQueue,h=this.tracks,b=f.data,k=f.type,_=f.frag,D=f.part,c=f.chunkMeta,p=c.buffering[k],S=self.performance.now();p.start=S;var C=_.stats.buffering,I=D?D.stats.buffering:null;C.start===0&&(C.start=S),I&&I.start===0&&(I.start=S);var w=h.audio,O=k==="audio"&&c.id===1&&(w==null?void 0:w.container)==="audio/mpeg",x={execute:function(){if(p.executeStart=self.performance.now(),O){var P=l.sourceBuffer[k];if(P){var F=_.start-P.timestampOffset;Math.abs(F)>=.1&&(s.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+_.start+" (delta: "+F+") sn: "+_.sn+")"),P.timestampOffset=_.start)}}l.appendExecutor(b,k)},onStart:function(){},onComplete:function(){var P=self.performance.now();p.executeEnd=p.end=P,C.first===0&&(C.first=P),I&&I.first===0&&(I.first=P);var F=l.sourceBuffer,N={};for(var U in F)N[U]=A.BufferHelper.getBuffered(F[U]);l.appendError=0,l.hls.trigger(n.Events.BUFFER_APPENDED,{type:k,frag:_,part:D,chunkMeta:c,parent:_.type,timeRanges:N})},onError:function(P){s.logger.error("[buffer-controller]: Error encountered while trying to append to the "+k+" SourceBuffer",P);var F={type:u.ErrorTypes.MEDIA_ERROR,parent:_.type,details:u.ErrorDetails.BUFFER_APPEND_ERROR,err:P,fatal:!1};P.code===DOMException.QUOTA_EXCEEDED_ERR?F.details=u.ErrorDetails.BUFFER_FULL_ERROR:(l.appendError++,F.details=u.ErrorDetails.BUFFER_APPEND_ERROR,l.appendError>g.config.appendErrorMaxRetry&&(s.logger.error("[buffer-controller]: Failed "+g.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),F.fatal=!0)),g.trigger(n.Events.ERROR,F)}};m.append(x,k)},E.onBufferFlushing=function(o,f){var l=this,g=this.operationQueue,m=function(h){return{execute:l.removeExecutor.bind(l,h,f.startOffset,f.endOffset),onStart:function(){},onComplete:function(){l.hls.trigger(n.Events.BUFFER_FLUSHED,{type:h})},onError:function(b){s.logger.warn("[buffer-controller]: Failed to remove from "+h+" SourceBuffer",b)}}};f.type?g.append(m(f.type),f.type):this.getSourceBufferTypes().forEach(function(h){g.append(m(h),h)})},E.onFragParsed=function(o,f){var l=this,g=f.frag,m=f.part,h=[],b=m?m.elementaryStreams:g.elementaryStreams;b[a.ElementaryStreamTypes.AUDIOVIDEO]?h.push("audiovideo"):(b[a.ElementaryStreamTypes.AUDIO]&&h.push("audio"),b[a.ElementaryStreamTypes.VIDEO]&&h.push("video")),h.length===0&&s.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+g.type+" level: "+g.level+" sn: "+g.sn),this.blockBuffers(function(){var k=self.performance.now();g.stats.buffering.end=k,m&&(m.stats.buffering.end=k);var _=m?m.stats:g.stats;l.hls.trigger(n.Events.FRAG_BUFFERED,{frag:g,part:m,stats:_,id:g.type})},h)},E.onFragChanged=function(o,f){this.flushBackBuffer()},E.onBufferEos=function(o,f){var l=this;this.getSourceBufferTypes().reduce(function(g,m){var h=l.sourceBuffer[m];return f.type&&f.type!==m||h&&!h.ended&&(h.ended=!0,s.logger.log("[buffer-controller]: "+m+" sourceBuffer now EOS")),g&&!(h&&!h.ended)},!0)&&this.blockBuffers(function(){var g=l.mediaSource;g&&g.readyState==="open"&&g.endOfStream()})},E.onLevelUpdated=function(o,f){var l=f.details;l.fragments.length&&(this.details=l,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},E.flushBackBuffer=function(){var o=this.hls,f=this.details,l=this.media,g=this.sourceBuffer;if(l&&f!==null){var m=this.getSourceBufferTypes();if(m.length){var h=f.live&&o.config.liveBackBufferLength!==null?o.config.liveBackBufferLength:o.config.backBufferLength;if(Object(i.isFiniteNumber)(h)&&!(h<0)){var b=l.currentTime,k=f.levelTargetDuration,_=Math.max(h,k),D=Math.floor(b/k)*k-_;m.forEach(function(c){var p=g[c];if(p){var S=A.BufferHelper.getBuffered(p);S.length>0&&D>S.start(0)&&(o.trigger(n.Events.BACK_BUFFER_REACHED,{bufferEnd:D}),f.live&&o.trigger(n.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:D}),o.trigger(n.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:D,type:c}))}})}}}},E.updateMediaElementDuration=function(){if(this.details&&this.media&&this.mediaSource&&this.mediaSource.readyState==="open"){var o=this.details,f=this.hls,l=this.media,g=this.mediaSource,m=o.fragments[0].start+o.totalduration,h=l.duration,b=Object(i.isFiniteNumber)(g.duration)?g.duration:0;o.live&&f.config.liveDurationInfinity?(s.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),g.duration=1/0,this.updateSeekableRange(o)):(m>b&&m>h||!Object(i.isFiniteNumber)(h))&&(s.logger.log("[buffer-controller]: Updating Media Source duration to "+m.toFixed(3)),g.duration=m)}},E.updateSeekableRange=function(o){var f=this.mediaSource,l=o.fragments;if(l.length&&o.live&&f!=null&&f.setLiveSeekableRange){var g=Math.max(0,l[0].start),m=Math.max(g,g+o.totalduration);f.setLiveSeekableRange(g,m)}},E.checkPendingTracks=function(){var o=this.bufferCodecEventsExpected,f=this.operationQueue,l=this.pendingTracks,g=Object.keys(l).length;if(g&&!o||g===2){this.createSourceBuffers(l),this.pendingTracks={};var m=this.getSourceBufferTypes();if(m.length===0)return void this.hls.trigger(n.Events.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});m.forEach(function(h){f.executeNext(h)})}},E.createSourceBuffers=function(o){var f=this.sourceBuffer,l=this.mediaSource;if(!l)throw Error("createSourceBuffers called when mediaSource was null");var g=0;for(var m in o)if(!f[m]){var h=o[m];if(!h)throw Error("source buffer exists for track "+m+", however track does not");var b=h.levelCodec||h.codec,k=h.container+";codecs="+b;s.logger.log("[buffer-controller]: creating sourceBuffer("+k+")");try{var _=f[m]=l.addSourceBuffer(k),D=m;this.addBufferListener(D,"updatestart",this._onSBUpdateStart),this.addBufferListener(D,"updateend",this._onSBUpdateEnd),this.addBufferListener(D,"error",this._onSBUpdateError),this.tracks[m]={buffer:_,codec:b,container:h.container,levelCodec:h.levelCodec,id:h.id},g++}catch(c){s.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+c.message),this.hls.trigger(n.Events.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:c,mimeType:k})}}g&&this.hls.trigger(n.Events.BUFFER_CREATED,{tracks:this.tracks})},E._onSBUpdateStart=function(o){this.operationQueue.current(o).onStart()},E._onSBUpdateEnd=function(o){var f=this.operationQueue;f.current(o).onComplete(),f.shiftAndExecuteNext(o)},E._onSBUpdateError=function(o,f){s.logger.error("[buffer-controller]: "+o+" SourceBuffer error",f),this.hls.trigger(n.Events.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var l=this.operationQueue.current(o);l&&l.onError(f)},E.removeExecutor=function(o,f,l){var g=this.media,m=this.mediaSource,h=this.operationQueue,b=this.sourceBuffer[o];if(!g||!m||!b)return s.logger.warn("[buffer-controller]: Attempting to remove from the "+o+" SourceBuffer, but it does not exist"),void h.shiftAndExecuteNext(o);var k=Object(i.isFiniteNumber)(g.duration)?g.duration:1/0,_=Object(i.isFiniteNumber)(m.duration)?m.duration:1/0,D=Math.max(0,f),c=Math.min(l,k,_);c>D?(s.logger.log("[buffer-controller]: Removing ["+D+","+c+"] from the "+o+" SourceBuffer"),console.assert(!b.updating,o+" sourceBuffer must not be updating"),b.remove(D,c)):h.shiftAndExecuteNext(o)},E.appendExecutor=function(o,f){var l=this.operationQueue,g=this.sourceBuffer[f];if(!g)return s.logger.warn("[buffer-controller]: Attempting to append to the "+f+" SourceBuffer, but it does not exist"),void l.shiftAndExecuteNext(f);g.ended=!1,console.assert(!g.updating,f+" sourceBuffer must not be updating"),g.appendBuffer(o)},E.blockBuffers=function(o,f){var l=this;if(f===void 0&&(f=this.getSourceBufferTypes()),!f.length)return s.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve(o);var g=this.operationQueue,m=f.map(function(h){return g.appendBlocker(h)});Promise.all(m).then(function(){o(),f.forEach(function(h){var b=l.sourceBuffer[h];b&&b.updating||g.shiftAndExecuteNext(h)})})},E.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},E.addBufferListener=function(o,f,l){var g=this.sourceBuffer[o];if(g){var m=l.bind(this,o);this.listeners[o].push({event:f,listener:m}),g.addEventListener(f,m)}},E.removeBufferListeners=function(o){var f=this.sourceBuffer[o];f&&this.listeners[o].forEach(function(l){f.removeEventListener(l.event,l.listener)})},R}()},"./src/controller/buffer-operation-queue.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return n});var i=r("./src/utils/logger.ts"),n=function(){function s(A){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=A}var u=s.prototype;return u.append=function(A,y){var a=this.queues[y];a.push(A),a.length===1&&this.buffers[y]&&this.executeNext(y)},u.insertAbort=function(A,y){this.queues[y].unshift(A),this.executeNext(y)},u.appendBlocker=function(A){var y,a=new Promise(function(v){y=v}),T={execute:y,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(T,A),a},u.executeNext=function(A){var y=this.buffers,a=this.queues,T=y[A],v=a[A];if(v.length){var d=v[0];try{d.execute()}catch(L){i.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),d.onError(L),T&&T.updating||(v.shift(),this.executeNext(A))}}},u.shiftAndExecuteNext=function(A){this.queues[A].shift(),this.executeNext(A)},u.current=function(A){return this.queues[A][0]},s}()},"./src/controller/cap-level-controller.ts":function(e,t,r){r.r(t);var i=r("./src/events.ts");function n(u,A){for(var y=0;y<A.length;y++){var a=A[y];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(u,a.key,a)}}var s=function(){function u(v){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=v,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var A,y,a,T=u.prototype;return T.setStreamController=function(v){this.streamController=v},T.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},T.registerListeners=function(){var v=this.hls;v.on(i.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),v.on(i.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),v.on(i.Events.MANIFEST_PARSED,this.onManifestParsed,this),v.on(i.Events.BUFFER_CODECS,this.onBufferCodecs,this),v.on(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},T.unregisterListener=function(){var v=this.hls;v.off(i.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),v.off(i.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),v.off(i.Events.MANIFEST_PARSED,this.onManifestParsed,this),v.off(i.Events.BUFFER_CODECS,this.onBufferCodecs,this),v.off(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},T.onFpsDropLevelCapping=function(v,d){u.isLevelAllowed(d.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(d.droppedLevel)},T.onMediaAttaching=function(v,d){this.media=d.media instanceof HTMLVideoElement?d.media:null},T.onManifestParsed=function(v,d){var L=this.hls;this.restrictedLevels=[],this.firstLevel=d.firstLevel,L.config.capLevelToPlayerSize&&d.video&&this.startCapping()},T.onBufferCodecs=function(v,d){this.hls.config.capLevelToPlayerSize&&d.video&&this.startCapping()},T.onMediaDetaching=function(){this.stopCapping()},T.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var v=this.hls.levels;if(v.length){var d=this.hls;d.autoLevelCapping=this.getMaxLevel(v.length-1),d.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=d.autoLevelCapping}}},T.getMaxLevel=function(v){var d=this,L=this.hls.levels;if(!L.length)return-1;var R=L.filter(function(E,o){return u.isLevelAllowed(o,d.restrictedLevels)&&o<=v});return this.clientRect=null,u.getMaxLevelByMediaSize(R,this.mediaWidth,this.mediaHeight)},T.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},T.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},T.getDimensions=function(){if(this.clientRect)return this.clientRect;var v=this.media,d={width:0,height:0};if(v){var L=v.getBoundingClientRect();d.width=L.width,d.height=L.height,d.width||d.height||(d.width=L.right-L.left||v.width||0,d.height=L.bottom-L.top||v.height||0)}return this.clientRect=d,d},u.isLevelAllowed=function(v,d){return d===void 0&&(d=[]),d.indexOf(v)===-1},u.getMaxLevelByMediaSize=function(v,d,L){if(!v||!v.length)return-1;for(var R,E,o=v.length-1,f=0;f<v.length;f+=1){var l=v[f];if((l.width>=d||l.height>=L)&&(R=l,!(E=v[f+1])||R.width!==E.width||R.height!==E.height)){o=f;break}}return o},A=u,a=[{key:"contentScaleFactor",get:function(){var v=1;try{v=self.devicePixelRatio}catch{}return v}}],(y=[{key:"mediaWidth",get:function(){return this.getDimensions().width*u.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*u.contentScaleFactor}}])&&n(A.prototype,y),a&&n(A,a),u}();t.default=s},"./src/controller/eme-controller.ts":function(e,t,r){r.r(t);var i=r("./src/events.ts"),n=r("./src/errors.ts"),s=r("./src/utils/logger.ts"),u=r("./src/utils/mediakeys-helper.ts");function A(a,T){for(var v=0;v<T.length;v++){var d=T[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}var y=function(){function a(L){this.hls=void 0,this._widevineLicenseUrl=void 0,this._licenseXhrSetup=void 0,this._licenseResponseCallback=void 0,this._emeEnabled=void 0,this._requestMediaKeySystemAccess=void 0,this._drmSystemOptions=void 0,this._config=void 0,this._mediaKeysList=[],this._media=null,this._hasSetMediaKeys=!1,this._requestLicenseFailureCount=0,this.mediaKeysPromise=null,this._onMediaEncrypted=this.onMediaEncrypted.bind(this),this.hls=L,this._config=L.config,this._widevineLicenseUrl=this._config.widevineLicenseUrl,this._licenseXhrSetup=this._config.licenseXhrSetup,this._licenseResponseCallback=this._config.licenseResponseCallback,this._emeEnabled=this._config.emeEnabled,this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc,this._drmSystemOptions=this._config.drmSystemOptions,this._registerListeners()}var T,v,d=a.prototype;return d.destroy=function(){this._unregisterListeners(),this.hls=this._onMediaEncrypted=null,this._requestMediaKeySystemAccess=null},d._registerListeners=function(){this.hls.on(i.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(i.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(i.Events.MANIFEST_PARSED,this.onManifestParsed,this)},d._unregisterListeners=function(){this.hls.off(i.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(i.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(i.Events.MANIFEST_PARSED,this.onManifestParsed,this)},d.getLicenseServerUrl=function(L){switch(L){case u.KeySystems.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+L+'"')},d._attemptKeySystemAccess=function(L,R,E){var o=this,f=function(g,m,h,b){switch(g){case u.KeySystems.WIDEVINE:return function(k,_,D){var c={audioCapabilities:[],videoCapabilities:[]};return k.forEach(function(p){c.audioCapabilities.push({contentType:'audio/mp4; codecs="'+p+'"',robustness:D.audioRobustness||""})}),_.forEach(function(p){c.videoCapabilities.push({contentType:'video/mp4; codecs="'+p+'"',robustness:D.videoRobustness||""})}),[c]}(m,h,b);default:throw new Error("Unknown key-system: "+g)}}(L,R,E,this._drmSystemOptions);s.logger.log("Requesting encrypted media key-system access");var l=this.requestMediaKeySystemAccess(L,f);this.mediaKeysPromise=l.then(function(g){return o._onMediaKeySystemAccessObtained(L,g)}),l.catch(function(g){s.logger.error('Failed to obtain key-system "'+L+'" access:',g)})},d._onMediaKeySystemAccessObtained=function(L,R){var E=this;s.logger.log('Access for key-system "'+L+'" obtained');var o={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:R,mediaKeySystemDomain:L};this._mediaKeysList.push(o);var f=Promise.resolve().then(function(){return R.createMediaKeys()}).then(function(l){return o.mediaKeys=l,s.logger.log('Media-keys created for key-system "'+L+'"'),E._onMediaKeysCreated(),l});return f.catch(function(l){s.logger.error("Failed to create media-keys:",l)}),f},d._onMediaKeysCreated=function(){var L=this;this._mediaKeysList.forEach(function(R){R.mediaKeysSession||(R.mediaKeysSession=R.mediaKeys.createSession(),L._onNewMediaKeySession(R.mediaKeysSession))})},d._onNewMediaKeySession=function(L){var R=this;s.logger.log("New key-system session "+L.sessionId),L.addEventListener("message",function(E){R._onKeySessionMessage(L,E.message)},!1)},d._onKeySessionMessage=function(L,R){s.logger.log("Got EME message event, creating license request"),this._requestLicense(R,function(E){s.logger.log("Received license data (length: "+(E&&E.byteLength)+"), updating key-session"),L.update(E)})},d.onMediaEncrypted=function(L){var R=this;if(s.logger.log('Media is encrypted using "'+L.initDataType+'" init data type'),!this.mediaKeysPromise)return s.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),void this.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.KEY_SYSTEM_ERROR,details:n.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});var E=function(o){R._media&&(R._attemptSetMediaKeys(o),R._generateRequestWithPreferredKeySession(L.initDataType,L.initData))};this.mediaKeysPromise.then(E).catch(E)},d._attemptSetMediaKeys=function(L){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var R=this._mediaKeysList[0];if(!R||!R.mediaKeys)return s.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.KEY_SYSTEM_ERROR,details:n.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});s.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(R.mediaKeys),this._hasSetMediaKeys=!0}},d._generateRequestWithPreferredKeySession=function(L,R){var E=this,o=this._mediaKeysList[0];if(!o)return s.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.KEY_SYSTEM_ERROR,details:n.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(o.mediaKeysSessionInitialized)s.logger.warn("Key-Session already initialized but requested again");else{var f=o.mediaKeysSession;if(!f)return s.logger.error("Fatal: Media is encrypted but no key-session existing"),void this.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.KEY_SYSTEM_ERROR,details:n.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});if(!R)return s.logger.warn("Fatal: initData required for generating a key session is null"),void this.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.KEY_SYSTEM_ERROR,details:n.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});s.logger.log('Generating key-session request for "'+L+'" init data type'),o.mediaKeysSessionInitialized=!0,f.generateRequest(L,R).then(function(){s.logger.debug("Key-session generation succeeded")}).catch(function(l){s.logger.error("Error generating key-session request:",l),E.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.KEY_SYSTEM_ERROR,details:n.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})}},d._createLicenseXhr=function(L,R,E){var o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,o,L,R,E);var f=this._licenseXhrSetup;if(f)try{f.call(this.hls,o,L),f=void 0}catch(l){s.logger.error(l)}try{o.readyState||o.open("POST",L,!0),f&&f.call(this.hls,o,L)}catch(l){throw new Error("issue setting up KeySystem license XHR "+l)}return o},d._onLicenseRequestReadyStageChange=function(L,R,E,o){switch(L.readyState){case 4:if(L.status===200){this._requestLicenseFailureCount=0,s.logger.log("License request succeeded");var f=L.response,l=this._licenseResponseCallback;if(l)try{f=l.call(this.hls,L,R)}catch(m){s.logger.error(m)}o(f)}else{if(s.logger.error("License Request XHR failed ("+R+"). Status: "+L.status+" ("+L.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>3)return void this.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.KEY_SYSTEM_ERROR,details:n.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});var g=3-this._requestLicenseFailureCount+1;s.logger.warn("Retrying license request, "+g+" attempts left"),this._requestLicense(E,o)}}},d._generateLicenseRequestChallenge=function(L,R){switch(L.mediaKeySystemDomain){case u.KeySystems.WIDEVINE:return R}throw new Error("unsupported key-system: "+L.mediaKeySystemDomain)},d._requestLicense=function(L,R){s.logger.log("Requesting content license for key-system");var E=this._mediaKeysList[0];if(!E)return s.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.KEY_SYSTEM_ERROR,details:n.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});try{var o=this.getLicenseServerUrl(E.mediaKeySystemDomain),f=this._createLicenseXhr(o,L,R);s.logger.log("Sending license request to URL: "+o);var l=this._generateLicenseRequestChallenge(E,L);f.send(l)}catch(g){s.logger.error("Failure requesting DRM license: "+g),this.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.KEY_SYSTEM_ERROR,details:n.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},d.onMediaAttached=function(L,R){if(this._emeEnabled){var E=R.media;this._media=E,E.addEventListener("encrypted",this._onMediaEncrypted)}},d.onMediaDetached=function(){var L=this._media,R=this._mediaKeysList;L&&(L.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(R.map(function(E){if(E.mediaKeysSession)return E.mediaKeysSession.close().catch(function(){})})).then(function(){return L.setMediaKeys(null)}).catch(function(){}))},d.onManifestParsed=function(L,R){if(this._emeEnabled){var E=R.levels.map(function(f){return f.audioCodec}).filter(function(f){return!!f}),o=R.levels.map(function(f){return f.videoCodec}).filter(function(f){return!!f});this._attemptKeySystemAccess(u.KeySystems.WIDEVINE,E,o)}},T=a,(v=[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}])&&A(T.prototype,v),a}();t.default=y},"./src/controller/fps-controller.ts":function(e,t,r){r.r(t);var i=r("./src/events.ts"),n=r("./src/utils/logger.ts"),s=function(){function u(y){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=y,this.registerListeners()}var A=u.prototype;return A.setStreamController=function(y){this.streamController=y},A.registerListeners=function(){this.hls.on(i.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},A.unregisterListeners=function(){this.hls.off(i.Events.MEDIA_ATTACHING,this.onMediaAttaching)},A.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},A.onMediaAttaching=function(y,a){var T=this.hls.config;if(T.capLevelOnFPSDrop){var v=a.media instanceof self.HTMLVideoElement?a.media:null;this.media=v,v&&typeof v.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),T.fpsDroppedMonitoringPeriod)}},A.checkFPS=function(y,a,T){var v=performance.now();if(a){if(this.lastTime){var d=v-this.lastTime,L=T-this.lastDroppedFrames,R=a-this.lastDecodedFrames,E=1e3*L/d,o=this.hls;if(o.trigger(i.Events.FPS_DROP,{currentDropped:L,currentDecoded:R,totalDroppedFrames:T}),E>0&&L>o.config.fpsDroppedMonitoringThreshold*R){var f=o.currentLevel;n.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+f),f>0&&(o.autoLevelCapping===-1||o.autoLevelCapping>=f)&&(f-=1,o.trigger(i.Events.FPS_DROP_LEVEL_CAPPING,{level:f,droppedLevel:o.currentLevel}),o.autoLevelCapping=f,this.streamController.nextLevelSwitch())}}this.lastTime=v,this.lastDroppedFrames=T,this.lastDecodedFrames=a}},A.checkFPSInterval=function(){var y=this.media;if(y)if(this.isVideoPlaybackQualityAvailable){var a=y.getVideoPlaybackQuality();this.checkFPS(y,a.totalVideoFrames,a.droppedVideoFrames)}else this.checkFPS(y,y.webkitDecodedFrameCount,y.webkitDroppedFrameCount)},u}();t.default=s},"./src/controller/fragment-finders.ts":function(e,t,r){r.r(t),r.d(t,"findFragmentByPDT",function(){return s}),r.d(t,"findFragmentByPTS",function(){return u}),r.d(t,"fragmentWithinToleranceTest",function(){return A}),r.d(t,"pdtWithinToleranceTest",function(){return y}),r.d(t,"findFragWithCC",function(){return a});var i=r("./src/polyfills/number.ts"),n=r("./src/utils/binary-search.ts");function s(T,v,d){if(v===null||!Array.isArray(T)||!T.length||!Object(i.isFiniteNumber)(v)||v<(T[0].programDateTime||0)||v>=(T[T.length-1].endProgramDateTime||0))return null;d=d||0;for(var L=0;L<T.length;++L){var R=T[L];if(y(v,d,R))return R}return null}function u(T,v,d,L){d===void 0&&(d=0),L===void 0&&(L=0);var R=null;if(T?R=v[T.sn-v[0].sn+1]||null:d===0&&v[0].start===0&&(R=v[0]),R&&A(d,L,R)===0)return R;var E=n.default.search(v,A.bind(null,d,L));return E||R}function A(T,v,d){T===void 0&&(T=0),v===void 0&&(v=0);var L=Math.min(v,d.duration+(d.deltaPTS?d.deltaPTS:0));return d.start+d.duration-L<=T?1:d.start-L>T&&d.start?-1:0}function y(T,v,d){var L=1e3*Math.min(v,d.duration+(d.deltaPTS?d.deltaPTS:0));return(d.endProgramDateTime||0)-L>T}function a(T,v){return n.default.search(T,function(d){return d.cc<v?1:d.cc>v?-1:0})}},"./src/controller/fragment-tracker.ts":function(e,t,r){r.r(t),r.d(t,"FragmentState",function(){return i}),r.d(t,"FragmentTracker",function(){return A});var i,n,s=r("./src/events.ts"),u=r("./src/types/loader.ts");(n=i||(i={})).NOT_LOADED="NOT_LOADED",n.BACKTRACKED="BACKTRACKED",n.APPENDING="APPENDING",n.PARTIAL="PARTIAL",n.OK="OK";var A=function(){function T(d){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=d,this._registerListeners()}var v=T.prototype;return v._registerListeners=function(){var d=this.hls;d.on(s.Events.BUFFER_APPENDED,this.onBufferAppended,this),d.on(s.Events.FRAG_BUFFERED,this.onFragBuffered,this),d.on(s.Events.FRAG_LOADED,this.onFragLoaded,this)},v._unregisterListeners=function(){var d=this.hls;d.off(s.Events.BUFFER_APPENDED,this.onBufferAppended,this),d.off(s.Events.FRAG_BUFFERED,this.onFragBuffered,this),d.off(s.Events.FRAG_LOADED,this.onFragLoaded,this)},v.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},v.getAppendedFrag=function(d,L){if(L===u.PlaylistLevelType.MAIN){var R=this.activeFragment,E=this.activeParts;if(!R)return null;if(E)for(var o=E.length;o--;){var f=E[o],l=f?f.end:R.appendedPTS;if(f.start<=d&&l!==void 0&&d<=l)return o>9&&(this.activeParts=E.slice(o-9)),f}else if(R.start<=d&&R.appendedPTS!==void 0&&d<=R.appendedPTS)return R}return this.getBufferedFrag(d,L)},v.getBufferedFrag=function(d,L){for(var R=this.fragments,E=Object.keys(R),o=E.length;o--;){var f=R[E[o]];if((f==null?void 0:f.body.type)===L&&f.buffered){var l=f.body;if(l.start<=d&&d<=l.end)return l}}return null},v.detectEvictedFragments=function(d,L,R){var E=this;Object.keys(this.fragments).forEach(function(o){var f=E.fragments[o];if(f)if(f.buffered){var l=f.range[d];l&&l.time.some(function(g){var m=!E.isTimeBuffered(g.startPTS,g.endPTS,L);return m&&E.removeFragment(f.body),m})}else f.body.type===R&&E.removeFragment(f.body)})},v.detectPartialFragments=function(d){var L=this,R=this.timeRanges,E=d.frag,o=d.part;if(R&&E.sn!=="initSegment"){var f=a(E),l=this.fragments[f];l&&(Object.keys(R).forEach(function(g){var m=E.elementaryStreams[g];if(m){var h=R[g],b=o!==null||m.partial===!0;l.range[g]=L.getBufferedTimes(E,o,b,h)}}),l.backtrack=l.loaded=null,Object.keys(l.range).length?l.buffered=!0:this.removeFragment(l.body))}},v.fragBuffered=function(d){var L=a(d),R=this.fragments[L];R&&(R.backtrack=R.loaded=null,R.buffered=!0)},v.getBufferedTimes=function(d,L,R,E){for(var o={time:[],partial:R},f=L?L.start:d.start,l=L?L.end:d.end,g=d.minEndPTS||l,m=d.maxStartPTS||f,h=0;h<E.length;h++){var b=E.start(h)-this.bufferPadding,k=E.end(h)+this.bufferPadding;if(m>=b&&g<=k){o.time.push({startPTS:Math.max(f,E.start(h)),endPTS:Math.min(l,E.end(h))});break}if(f<k&&l>b)o.partial=!0,o.time.push({startPTS:Math.max(f,E.start(h)),endPTS:Math.min(l,E.end(h))});else if(l<=b)break}return o},v.getPartialFragment=function(d){var L,R,E,o=null,f=0,l=this.bufferPadding,g=this.fragments;return Object.keys(g).forEach(function(m){var h=g[m];h&&y(h)&&(R=h.body.start-l,E=h.body.end+l,d>=R&&d<=E&&(L=Math.min(d-R,E-d),f<=L&&(o=h.body,f=L)))}),o},v.getState=function(d){var L=a(d),R=this.fragments[L];return R?R.buffered?y(R)?i.PARTIAL:i.OK:R.backtrack?i.BACKTRACKED:i.APPENDING:i.NOT_LOADED},v.backtrack=function(d,L){var R=a(d),E=this.fragments[R];if(!E||E.backtrack)return null;var o=E.backtrack=L||E.loaded;return E.loaded=null,o},v.getBacktrackData=function(d){var L=a(d),R=this.fragments[L];if(R){var E,o=R.backtrack;if(o!=null&&(E=o.payload)!==null&&E!==void 0&&E.byteLength)return o;this.removeFragment(d)}return null},v.isTimeBuffered=function(d,L,R){for(var E,o,f=0;f<R.length;f++){if(E=R.start(f)-this.bufferPadding,o=R.end(f)+this.bufferPadding,d>=E&&L<=o)return!0;if(L<=E)return!1}return!1},v.onFragLoaded=function(d,L){var R=L.frag,E=L.part;if(R.sn!=="initSegment"&&!R.bitrateTest&&!E){var o=a(R);this.fragments[o]={body:R,loaded:L,backtrack:null,buffered:!1,range:Object.create(null)}}},v.onBufferAppended=function(d,L){var R=this,E=L.frag,o=L.part,f=L.timeRanges;if(E.type===u.PlaylistLevelType.MAIN)if(this.activeFragment=E,o){var l=this.activeParts;l||(this.activeParts=l=[]),l.push(o)}else this.activeParts=null;this.timeRanges=f,Object.keys(f).forEach(function(g){var m=f[g];if(R.detectEvictedFragments(g,m),!o)for(var h=0;h<m.length;h++)E.appendedPTS=Math.max(m.end(h),E.appendedPTS||0)})},v.onFragBuffered=function(d,L){this.detectPartialFragments(L)},v.hasFragment=function(d){var L=a(d);return!!this.fragments[L]},v.removeFragmentsInRange=function(d,L,R){var E=this;Object.keys(this.fragments).forEach(function(o){var f=E.fragments[o];if(f&&f.buffered){var l=f.body;l.type===R&&l.start<L&&l.end>d&&E.removeFragment(l)}})},v.removeFragment=function(d){var L=a(d);d.stats.loaded=0,d.clearElementaryStreamInfo(),delete this.fragments[L]},v.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},T}();function y(T){var v,d;return T.buffered&&(((v=T.range.video)===null||v===void 0?void 0:v.partial)||((d=T.range.audio)===null||d===void 0?void 0:d.partial))}function a(T){return T.type+"_"+T.level+"_"+T.urlId+"_"+T.sn}},"./src/controller/gap-controller.ts":function(e,t,r){r.r(t),r.d(t,"STALL_MINIMUM_DURATION_MS",function(){return A}),r.d(t,"MAX_START_GAP_JUMP",function(){return y}),r.d(t,"SKIP_BUFFER_HOLE_STEP_SECONDS",function(){return a}),r.d(t,"SKIP_BUFFER_RANGE_START",function(){return T}),r.d(t,"default",function(){return v});var i=r("./src/utils/buffer-helper.ts"),n=r("./src/errors.ts"),s=r("./src/events.ts"),u=r("./src/utils/logger.ts"),A=250,y=2,a=.1,T=.05,v=function(){function d(R,E,o,f){this.config=void 0,this.media=void 0,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=R,this.media=E,this.fragmentTracker=o,this.hls=f}var L=d.prototype;return L.destroy=function(){this.hls=this.fragmentTracker=this.media=null},L.poll=function(R){var E=this.config,o=this.media,f=this.stalled,l=o.currentTime,g=o.seeking,m=this.seeking&&!g,h=!this.seeking&&g;if(this.seeking=g,l===R){if((h||m)&&(this.stalled=null),!o.paused&&!o.ended&&o.playbackRate!==0&&i.BufferHelper.getBuffered(o).length){var b=i.BufferHelper.bufferInfo(o,l,0),k=b.len>0,_=b.nextStart||0;if(k||_){if(g){var D=b.len>y,c=!_||_-l>y&&!this.fragmentTracker.getPartialFragment(l);if(D||c)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var p,S=Math.max(_,b.start||0)-l,C=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,I=!(C==null||(p=C.details)===null||p===void 0)&&p.live?2*C.details.targetduration:y;if(S>0&&S<=I)return void this._trySkipBufferHole(null)}var w=self.performance.now();if(f!==null){var O=w-f;!g&&O>=A&&this._reportStall(b.len);var x=i.BufferHelper.bufferInfo(o,l,E.maxBufferHole);this._tryFixBufferStall(x,O)}else this.stalled=w}}}else if(this.moved=!0,f!==null){if(this.stallReported){var P=self.performance.now()-f;u.logger.warn("playback not stuck anymore @"+l+", after "+Math.round(P)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}},L._tryFixBufferStall=function(R,E){var o=this.config,f=this.fragmentTracker,l=this.media.currentTime,g=f.getPartialFragment(l);g&&this._trySkipBufferHole(g)||R.len>o.maxBufferHole&&E>1e3*o.highBufferWatchdogPeriod&&(u.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},L._reportStall=function(R){var E=this.hls,o=this.media;this.stallReported||(this.stallReported=!0,u.logger.warn("Playback stalling at @"+o.currentTime+" due to low buffer (buffer="+R+")"),E.trigger(s.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:R}))},L._trySkipBufferHole=function(R){for(var E=this.config,o=this.hls,f=this.media,l=f.currentTime,g=0,m=i.BufferHelper.getBuffered(f),h=0;h<m.length;h++){var b=m.start(h);if(l+E.maxBufferHole>=g&&l<b){var k=Math.max(b+T,f.currentTime+a);return u.logger.warn("skipping hole, adjusting currentTime from "+l+" to "+k),this.moved=!0,this.stalled=null,f.currentTime=k,R&&o.trigger(s.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+l+" to "+k,frag:R}),k}g=m.end(h)}return 0},L._tryNudgeBuffer=function(){var R=this.config,E=this.hls,o=this.media,f=o.currentTime,l=(this.nudgeRetry||0)+1;if(this.nudgeRetry=l,l<R.nudgeMaxRetry){var g=f+l*R.nudgeOffset;u.logger.warn("Nudging 'currentTime' from "+f+" to "+g),o.currentTime=g,E.trigger(s.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else u.logger.error("Playhead still not moving while enough data buffered @"+f+" after "+R.nudgeMaxRetry+" nudges"),E.trigger(s.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},d}()},"./src/controller/id3-track-controller.ts":function(e,t,r){r.r(t);var i=r("./src/events.ts"),n=r("./src/utils/texttrack-utils.ts"),s=r("./src/demux/id3.ts"),u=function(){function A(a){this.hls=void 0,this.id3Track=null,this.media=null,this.hls=a,this._registerListeners()}var y=A.prototype;return y.destroy=function(){this._unregisterListeners()},y._registerListeners=function(){var a=this.hls;a.on(i.Events.MEDIA_ATTACHED,this.onMediaAttached,this),a.on(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),a.on(i.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),a.on(i.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},y._unregisterListeners=function(){var a=this.hls;a.off(i.Events.MEDIA_ATTACHED,this.onMediaAttached,this),a.off(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),a.off(i.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),a.off(i.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},y.onMediaAttached=function(a,T){this.media=T.media},y.onMediaDetaching=function(){this.id3Track&&(Object(n.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null)},y.getID3Track=function(a){if(this.media){for(var T=0;T<a.length;T++){var v=a[T];if(v.kind==="metadata"&&v.label==="id3")return Object(n.sendAddTrackEvent)(v,this.media),v}return this.media.addTextTrack("metadata","id3")}},y.onFragParsingMetadata=function(a,T){if(this.media){var v=T.frag,d=T.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var L=self.WebKitDataCue||self.VTTCue||self.TextTrackCue,R=0;R<d.length;R++){var E=s.getID3Frames(d[R].data);if(E){var o=d[R].pts,f=R<d.length-1?d[R+1].pts:v.end;f-o<=0&&(f=o+.25);for(var l=0;l<E.length;l++){var g=E[l];if(!s.isTimeStampFrame(g)){var m=new L(o,f,"");m.value=g,this.id3Track.addCue(m)}}}}}},y.onBufferFlushing=function(a,T){var v=T.startOffset,d=T.endOffset,L=T.type;if(!L||L==="audio"){var R=this.id3Track;R&&Object(n.removeCuesInRange)(R,v,d)}},A}();t.default=u},"./src/controller/latency-controller.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return A});var i=r("./src/errors.ts"),n=r("./src/events.ts"),s=r("./src/utils/logger.ts");function u(y,a){for(var T=0;T<a.length;T++){var v=a[T];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(y,v.key,v)}}var A=function(){function y(d){var L=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return L.timeupdate()},this.hls=d,this.config=d.config,this.registerListeners()}var a,T,v=y.prototype;return v.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},v.registerListeners=function(){this.hls.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(n.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(n.Events.ERROR,this.onError,this)},v.unregisterListeners=function(){this.hls.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(n.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(n.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(n.Events.ERROR,this.onError)},v.onMediaAttached=function(d,L){this.media=L.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},v.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},v.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},v.onLevelUpdated=function(d,L){var R=L.details;this.levelDetails=R,R.advanced&&this.timeupdate(),!R.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},v.onError=function(d,L){L.details===i.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,s.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},v.timeupdate=function(){var d=this.media,L=this.levelDetails;if(d&&L){this.currentTime=d.currentTime;var R=this.computeLatency();if(R!==null){this._latency=R;var E=this.config,o=E.lowLatencyMode,f=E.maxLiveSyncPlaybackRate;if(o&&f!==1){var l=this.targetLatency;if(l!==null){var g=R-l,m=g<Math.min(this.maxLatency,l+L.targetduration);if(L.live&&m&&g>.05&&this.forwardBufferLength>1){var h=Math.min(2,Math.max(1,f)),b=Math.round(2/(1+Math.exp(-.75*g-this.edgeStalled))*20)/20;d.playbackRate=Math.min(h,Math.max(1,b))}else d.playbackRate!==1&&d.playbackRate!==0&&(d.playbackRate=1)}}}}},v.estimateLiveEdge=function(){var d=this.levelDetails;return d===null?null:d.edge+d.age},v.computeLatency=function(){var d=this.estimateLiveEdge();return d===null?null:d-this.currentTime},a=y,(T=[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var d=this.config,L=this.levelDetails;return d.liveMaxLatencyDuration!==void 0?d.liveMaxLatencyDuration:L?d.liveMaxLatencyDurationCount*L.targetduration:0}},{key:"targetLatency",get:function(){var d=this.levelDetails;if(d===null)return null;var L=d.holdBack,R=d.partHoldBack,E=d.targetduration,o=this.config,f=o.liveSyncDuration,l=o.liveSyncDurationCount,g=o.lowLatencyMode,m=this.hls.userConfig,h=g&&R||L;(m.liveSyncDuration||m.liveSyncDurationCount||h===0)&&(h=f!==void 0?f:l*E);var b=E;return h+Math.min(1*this.stallCount,b)}},{key:"liveSyncPosition",get:function(){var d=this.estimateLiveEdge(),L=this.targetLatency,R=this.levelDetails;if(d===null||L===null||R===null)return null;var E=R.edge,o=d-L-this.edgeStalled,f=E-R.totalduration,l=E-(this.config.lowLatencyMode&&R.partTarget||R.targetduration);return Math.min(Math.max(f,o),l)}},{key:"drift",get:function(){var d=this.levelDetails;return d===null?1:d.drift}},{key:"edgeStalled",get:function(){var d=this.levelDetails;if(d===null)return 0;var L=3*(this.config.lowLatencyMode&&d.partTarget||d.targetduration);return Math.max(d.age-L,0)}},{key:"forwardBufferLength",get:function(){var d=this.media,L=this.levelDetails;if(!d||!L)return 0;var R=d.buffered.length;return R?d.buffered.end(R-1):L.edge-this.currentTime}}])&&u(a.prototype,T),y}()},"./src/controller/level-controller.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return R});var i=r("./src/types/level.ts"),n=r("./src/events.ts"),s=r("./src/errors.ts"),u=r("./src/utils/codecs.ts"),A=r("./src/controller/level-helper.ts"),y=r("./src/controller/base-playlist-controller.ts"),a=r("./src/types/loader.ts");function T(){return(T=Object.assign||function(E){for(var o=1;o<arguments.length;o++){var f=arguments[o];for(var l in f)Object.prototype.hasOwnProperty.call(f,l)&&(E[l]=f[l])}return E}).apply(this,arguments)}function v(E,o){for(var f=0;f<o.length;f++){var l=o[f];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(E,l.key,l)}}function d(E,o){return(d=Object.setPrototypeOf||function(f,l){return f.__proto__=l,f})(E,o)}var L=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),R=function(E){var o,f;function l(b){var k;return(k=E.call(this,b,"[level-controller]")||this)._levels=[],k._firstLevel=-1,k._startLevel=void 0,k.currentLevelIndex=-1,k.manualLevelIndex=-1,k.onParsedComplete=void 0,k._registerListeners(),k}f=E,(o=l).prototype=Object.create(f.prototype),o.prototype.constructor=o,d(o,f);var g,m,h=l.prototype;return h._registerListeners=function(){var b=this.hls;b.on(n.Events.MANIFEST_LOADED,this.onManifestLoaded,this),b.on(n.Events.LEVEL_LOADED,this.onLevelLoaded,this),b.on(n.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),b.on(n.Events.FRAG_LOADED,this.onFragLoaded,this),b.on(n.Events.ERROR,this.onError,this)},h._unregisterListeners=function(){var b=this.hls;b.off(n.Events.MANIFEST_LOADED,this.onManifestLoaded,this),b.off(n.Events.LEVEL_LOADED,this.onLevelLoaded,this),b.off(n.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),b.off(n.Events.FRAG_LOADED,this.onFragLoaded,this),b.off(n.Events.ERROR,this.onError,this)},h.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,E.prototype.destroy.call(this)},h.startLoad=function(){this._levels.forEach(function(b){b.loadError=0}),E.prototype.startLoad.call(this)},h.onManifestLoaded=function(b,k){var _,D,c=[],p=[],S=[],C={},I=!1,w=!1,O=!1;if(k.levels.forEach(function(N){var U=N.attrs;I=I||!(!N.width||!N.height),w=w||!!N.videoCodec,O=O||!!N.audioCodec,L&&N.audioCodec&&N.audioCodec.indexOf("mp4a.40.34")!==-1&&(N.audioCodec=void 0);var j=N.bitrate+"-"+N.attrs.RESOLUTION+"-"+N.attrs.CODECS;(D=C[j])?D.url.push(N.url):(D=new i.Level(N),C[j]=D,c.push(D)),U&&(U.AUDIO&&Object(A.addGroupId)(D,"audio",U.AUDIO),U.SUBTITLES&&Object(A.addGroupId)(D,"text",U.SUBTITLES))}),(I||w)&&O&&(c=c.filter(function(N){var U=N.videoCodec,j=N.width,V=N.height;return!!U||!(!j||!V)})),c=c.filter(function(N){var U=N.audioCodec,j=N.videoCodec;return(!U||Object(u.isCodecSupportedInMp4)(U,"audio"))&&(!j||Object(u.isCodecSupportedInMp4)(j,"video"))}),k.audioTracks&&(p=k.audioTracks.filter(function(N){return!N.audioCodec||Object(u.isCodecSupportedInMp4)(N.audioCodec,"audio")}),Object(A.assignTrackIdsByGroup)(p)),k.subtitles&&(S=k.subtitles,Object(A.assignTrackIdsByGroup)(S)),c.length>0){_=c[0].bitrate,c.sort(function(N,U){return N.bitrate-U.bitrate}),this._levels=c;for(var x=0;x<c.length;x++)if(c[x].bitrate===_){this._firstLevel=x,this.log("manifest loaded, "+c.length+" level(s) found, first bitrate: "+_);break}var P=O&&!w,F={levels:c,audioTracks:p,subtitleTracks:S,firstLevel:this._firstLevel,stats:k.stats,audio:O,video:w,altAudio:!P&&p.some(function(N){return!!N.url})};this.hls.trigger(n.Events.MANIFEST_PARSED,F),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(n.Events.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:k.url,reason:"no level with compatible codecs found in manifest"})},h.onError=function(b,k){if(E.prototype.onError.call(this,b,k),!k.fatal){var _=k.context,D=this._levels[this.currentLevelIndex];if(_&&(_.type===a.PlaylistContextType.AUDIO_TRACK&&D.audioGroupIds&&_.groupId===D.audioGroupIds[D.urlId]||_.type===a.PlaylistContextType.SUBTITLE_TRACK&&D.textGroupIds&&_.groupId===D.textGroupIds[D.urlId]))this.redundantFailover(this.currentLevelIndex);else{var c,p=!1,S=!0;switch(k.details){case s.ErrorDetails.FRAG_LOAD_ERROR:case s.ErrorDetails.FRAG_LOAD_TIMEOUT:case s.ErrorDetails.KEY_LOAD_ERROR:case s.ErrorDetails.KEY_LOAD_TIMEOUT:if(k.frag){var C=this._levels[k.frag.level];C?(C.fragmentError++,C.fragmentError>this.hls.config.fragLoadingMaxRetry&&(c=k.frag.level)):c=k.frag.level}break;case s.ErrorDetails.LEVEL_LOAD_ERROR:case s.ErrorDetails.LEVEL_LOAD_TIMEOUT:_&&(_.deliveryDirectives&&(S=!1),c=_.level),p=!0;break;case s.ErrorDetails.REMUX_ALLOC_ERROR:c=k.level,p=!0}c!==void 0&&this.recoverLevel(k,c,p,S)}}},h.recoverLevel=function(b,k,_,D){var c=b.details,p=this._levels[k];if(p.loadError++,_){if(!this.retryLoadingOrFail(b))return void(this.currentLevelIndex=-1);b.levelRetry=!0}if(D){var S=p.url.length;if(S>1&&p.loadError<S)b.levelRetry=!0,this.redundantFailover(k);else if(this.manualLevelIndex===-1){var C=k===0?this._levels.length-1:k-1;this.currentLevelIndex!==C&&this._levels[C].loadError===0&&(this.warn(c+": switch to "+C),b.levelRetry=!0,this.hls.nextAutoLevel=C)}}},h.redundantFailover=function(b){var k=this._levels[b],_=k.url.length;if(_>1){var D=(k.urlId+1)%_;this.warn("Switching to redundant URL-id "+D),this._levels.forEach(function(c){c.urlId=D}),this.level=b}},h.onFragLoaded=function(b,k){var _=k.frag;if(_!==void 0&&_.type===a.PlaylistLevelType.MAIN){var D=this._levels[_.level];D!==void 0&&(D.fragmentError=0,D.loadError=0)}},h.onLevelLoaded=function(b,k){var _,D,c=k.level,p=k.details,S=this._levels[c];if(!S)return this.warn("Invalid level index "+c),void((D=k.deliveryDirectives)!==null&&D!==void 0&&D.skip&&(p.deltaUpdateFailed=!0));c===this.currentLevelIndex?(S.fragmentError===0&&(S.loadError=0,this.retryCount=0),this.playlistLoaded(c,k,S.details)):(_=k.deliveryDirectives)!==null&&_!==void 0&&_.skip&&(p.deltaUpdateFailed=!0)},h.onAudioTrackSwitched=function(b,k){var _=this.hls.levels[this.currentLevelIndex];if(_&&_.audioGroupIds){for(var D=-1,c=this.hls.audioTracks[k.id].groupId,p=0;p<_.audioGroupIds.length;p++)if(_.audioGroupIds[p]===c){D=p;break}D!==_.urlId&&(_.urlId=D,this.startLoad())}},h.loadPlaylist=function(b){var k=this.currentLevelIndex,_=this._levels[k];if(this.canLoad&&_&&_.url.length>0){var D=_.urlId,c=_.url[D];if(b)try{c=b.addDirectives(c)}catch(p){this.warn("Could not construct new URL with HLS Delivery Directives: "+p)}this.log("Attempt loading level index "+k+(b?" at sn "+b.msn+" part "+b.part:"")+" with URL-id "+D+" "+c),this.clearTimer(),this.hls.trigger(n.Events.LEVEL_LOADING,{url:c,level:k,id:D,deliveryDirectives:b||null})}},h.removeLevel=function(b,k){var _=function(c,p){return p!==k},D=this._levels.filter(function(c,p){return p!==b||c.url.length>1&&k!==void 0&&(c.url=c.url.filter(_),c.audioGroupIds&&(c.audioGroupIds=c.audioGroupIds.filter(_)),c.textGroupIds&&(c.textGroupIds=c.textGroupIds.filter(_)),c.urlId=0,!0)}).map(function(c,p){var S=c.details;return S!=null&&S.fragments&&S.fragments.forEach(function(C){C.level=p}),c});this._levels=D,this.hls.trigger(n.Events.LEVELS_UPDATED,{levels:D})},g=l,(m=[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(b){var k,_=this._levels;if(_.length!==0&&(this.currentLevelIndex!==b||(k=_[b])===null||k===void 0||!k.details)){if(b<0||b>=_.length){var D=b<0;if(this.hls.trigger(n.Events.ERROR,{type:s.ErrorTypes.OTHER_ERROR,details:s.ErrorDetails.LEVEL_SWITCH_ERROR,level:b,fatal:D,reason:"invalid level idx"}),D)return;b=Math.min(b,_.length-1)}this.clearTimer();var c=this.currentLevelIndex,p=_[c],S=_[b];this.log("switching to level "+b+" from "+c),this.currentLevelIndex=b;var C=T({},S,{level:b,maxBitrate:S.maxBitrate,uri:S.uri,urlId:S.urlId});delete C._urlId,this.hls.trigger(n.Events.LEVEL_SWITCHING,C);var I=S.details;if(!I||I.live){var w=this.switchParams(S.uri,p==null?void 0:p.details);this.loadPlaylist(w)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(b){this.manualLevelIndex=b,this._startLevel===void 0&&(this._startLevel=b),b!==-1&&(this.level=b)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(b){this._firstLevel=b}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var b=this.hls.config.startLevel;return b!==void 0?b:this._firstLevel}return this._startLevel},set:function(b){this._startLevel=b}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(b){this.level=b,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=b)}}])&&v(g.prototype,m),l}(y.default)},"./src/controller/level-helper.ts":function(e,t,r){r.r(t),r.d(t,"addGroupId",function(){return s}),r.d(t,"assignTrackIdsByGroup",function(){return u}),r.d(t,"updatePTS",function(){return A}),r.d(t,"updateFragPTSDTS",function(){return a}),r.d(t,"mergeDetails",function(){return T}),r.d(t,"mapPartIntersection",function(){return v}),r.d(t,"mapFragmentIntersection",function(){return d}),r.d(t,"adjustSliding",function(){return L}),r.d(t,"addSliding",function(){return R}),r.d(t,"computeReloadInterval",function(){return E}),r.d(t,"getFragmentWithSN",function(){return o}),r.d(t,"getPartWith",function(){return f});var i=r("./src/polyfills/number.ts"),n=r("./src/utils/logger.ts");function s(l,g,m){switch(g){case"audio":l.audioGroupIds||(l.audioGroupIds=[]),l.audioGroupIds.push(m);break;case"text":l.textGroupIds||(l.textGroupIds=[]),l.textGroupIds.push(m)}}function u(l){var g={};l.forEach(function(m){var h=m.groupId||"";m.id=g[h]=g[h]||0,g[h]++})}function A(l,g,m){y(l[g],l[m])}function y(l,g){var m=g.startPTS;if(Object(i.isFiniteNumber)(m)){var h,b=0;g.sn>l.sn?(b=m-l.start,h=l):(b=l.start-m,h=g),h.duration!==b&&(h.duration=b)}else g.sn>l.sn?l.cc===g.cc&&l.minEndPTS?g.start=l.start+(l.minEndPTS-l.start):g.start=l.start+l.duration:g.start=Math.max(l.start-g.duration,0)}function a(l,g,m,h,b,k){h-m<=0&&(n.logger.warn("Fragment should have a positive duration",g),h=m+g.duration,k=b+g.duration);var _=m,D=h,c=g.startPTS,p=g.endPTS;if(Object(i.isFiniteNumber)(c)){var S=Math.abs(c-m);Object(i.isFiniteNumber)(g.deltaPTS)?g.deltaPTS=Math.max(S,g.deltaPTS):g.deltaPTS=S,_=Math.max(m,c),m=Math.min(m,c),b=Math.min(b,g.startDTS),D=Math.min(h,p),h=Math.max(h,p),k=Math.max(k,g.endDTS)}g.duration=h-m;var C=m-g.start;g.appendedPTS=h,g.start=g.startPTS=m,g.maxStartPTS=_,g.startDTS=b,g.endPTS=h,g.minEndPTS=D,g.endDTS=k;var I,w=g.sn;if(!l||w<l.startSN||w>l.endSN)return 0;var O=w-l.startSN,x=l.fragments;for(x[O]=g,I=O;I>0;I--)y(x[I],x[I-1]);for(I=O;I<x.length-1;I++)y(x[I],x[I+1]);return l.fragmentHint&&y(x[x.length-1],l.fragmentHint),l.PTSKnown=l.alignedSliding=!0,C}function T(l,g){for(var m=null,h=l.fragments,b=h.length-1;b>=0;b--){var k=h[b].initSegment;if(k){m=k;break}}l.fragmentHint&&delete l.fragmentHint.endPTS;var _,D=0;if(d(l,g,function(w,O){var x;w.relurl&&(D=w.cc-O.cc),Object(i.isFiniteNumber)(w.startPTS)&&Object(i.isFiniteNumber)(w.endPTS)&&(O.start=O.startPTS=w.startPTS,O.startDTS=w.startDTS,O.appendedPTS=w.appendedPTS,O.maxStartPTS=w.maxStartPTS,O.endPTS=w.endPTS,O.endDTS=w.endDTS,O.minEndPTS=w.minEndPTS,O.duration=w.endPTS-w.startPTS,O.duration&&(_=O),g.PTSKnown=g.alignedSliding=!0),O.elementaryStreams=w.elementaryStreams,O.loader=w.loader,O.stats=w.stats,O.urlId=w.urlId,w.initSegment?(O.initSegment=w.initSegment,m=w.initSegment):O.initSegment&&O.initSegment.relurl!=((x=m)===null||x===void 0?void 0:x.relurl)||(O.initSegment=m)}),g.skippedSegments&&(g.deltaUpdateFailed=g.fragments.some(function(w){return!w}),g.deltaUpdateFailed)){n.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var c=g.skippedSegments;c--;)g.fragments.shift();g.startSN=g.fragments[0].sn,g.startCC=g.fragments[0].cc}var p=g.fragments;if(D){n.logger.warn("discontinuity sliding from playlist, take drift into account");for(var S=0;S<p.length;S++)p[S].cc+=D}g.skippedSegments&&(g.startCC=g.fragments[0].cc),v(l.partList,g.partList,function(w,O){O.elementaryStreams=w.elementaryStreams,O.stats=w.stats}),_?a(g,_,_.startPTS,_.endPTS,_.startDTS,_.endDTS):L(l,g),p.length&&(g.totalduration=g.edge-p[0].start),g.driftStartTime=l.driftStartTime,g.driftStart=l.driftStart;var C=g.advancedDateTime;if(g.advanced&&C){var I=g.edge;g.driftStart||(g.driftStartTime=C,g.driftStart=I),g.driftEndTime=C,g.driftEnd=I}else g.driftEndTime=l.driftEndTime,g.driftEnd=l.driftEnd,g.advancedDateTime=l.advancedDateTime}function v(l,g,m){if(l&&g)for(var h=0,b=0,k=l.length;b<=k;b++){var _=l[b],D=g[b+h];_&&D&&_.index===D.index&&_.fragment.sn===D.fragment.sn?m(_,D):h--}}function d(l,g,m){for(var h=g.skippedSegments,b=Math.max(l.startSN,g.startSN)-g.startSN,k=(l.fragmentHint?1:0)+(h?g.endSN:Math.min(l.endSN,g.endSN))-g.startSN,_=g.startSN-l.startSN,D=g.fragmentHint?g.fragments.concat(g.fragmentHint):g.fragments,c=l.fragmentHint?l.fragments.concat(l.fragmentHint):l.fragments,p=b;p<=k;p++){var S=c[_+p],C=D[p];h&&!C&&p<h&&(C=g.fragments[p]=S),S&&C&&m(S,C)}}function L(l,g){var m=g.startSN+g.skippedSegments-l.startSN,h=l.fragments;m<0||m>=h.length||R(g,h[m].start)}function R(l,g){if(g){for(var m=l.fragments,h=l.skippedSegments;h<m.length;h++)m[h].start+=g;l.fragmentHint&&(l.fragmentHint.start+=g)}}function E(l,g){var m,h=1e3*l.levelTargetDuration,b=h/2,k=l.age,_=k>0&&k<3*h,D=g.loading.end-g.loading.start,c=l.availabilityDelay;if(l.updated===!1)if(_){var p=333*l.misses;m=Math.max(Math.min(b,2*D),p),l.availabilityDelay=(l.availabilityDelay||0)+m}else m=b;else _?(c=Math.min(c||h/2,k),l.availabilityDelay=c,m=c+h-k):m=h-D;return Math.round(m)}function o(l,g,m){if(!l||!l.details)return null;var h=l.details,b=h.fragments[g-h.startSN];return b||((b=h.fragmentHint)&&b.sn===g?b:g<h.startSN&&m&&m.sn===g?m:null)}function f(l,g,m){if(!l||!l.details)return null;var h=l.details.partList;if(h)for(var b=h.length;b--;){var k=h[b];if(k.index===m&&k.fragment.sn===g)return k}return null}},"./src/controller/stream-controller.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return l});var i=r("./src/polyfills/number.ts"),n=r("./src/controller/base-stream-controller.ts"),s=r("./src/is-supported.ts"),u=r("./src/events.ts"),A=r("./src/utils/buffer-helper.ts"),y=r("./src/controller/fragment-tracker.ts"),a=r("./src/types/loader.ts"),T=r("./src/loader/fragment.ts"),v=r("./src/demux/transmuxer-interface.ts"),d=r("./src/types/transmuxer.ts"),L=r("./src/controller/gap-controller.ts"),R=r("./src/errors.ts"),E=r("./src/utils/logger.ts");function o(g,m){for(var h=0;h<m.length;h++){var b=m[h];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(g,b.key,b)}}function f(g,m){return(f=Object.setPrototypeOf||function(h,b){return h.__proto__=b,h})(g,m)}var l=function(g){var m,h;function b(c,p){var S;return(S=g.call(this,c,p,"[stream-controller]")||this).audioCodecSwap=!1,S.gapController=null,S.level=-1,S._forceStartLoad=!1,S.altAudio=!1,S.audioOnly=!1,S.fragPlaying=null,S.onvplaying=null,S.onvseeked=null,S.fragLastKbps=0,S.stalled=!1,S.couldBacktrack=!1,S.audioCodecSwitch=!1,S.videoBuffer=null,S._registerListeners(),S}h=g,(m=b).prototype=Object.create(h.prototype),m.prototype.constructor=m,f(m,h);var k,_,D=b.prototype;return D._registerListeners=function(){var c=this.hls;c.on(u.Events.MEDIA_ATTACHED,this.onMediaAttached,this),c.on(u.Events.MEDIA_DETACHING,this.onMediaDetaching,this),c.on(u.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.on(u.Events.MANIFEST_PARSED,this.onManifestParsed,this),c.on(u.Events.LEVEL_LOADING,this.onLevelLoading,this),c.on(u.Events.LEVEL_LOADED,this.onLevelLoaded,this),c.on(u.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),c.on(u.Events.ERROR,this.onError,this),c.on(u.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),c.on(u.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),c.on(u.Events.BUFFER_CREATED,this.onBufferCreated,this),c.on(u.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),c.on(u.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),c.on(u.Events.FRAG_BUFFERED,this.onFragBuffered,this)},D._unregisterListeners=function(){var c=this.hls;c.off(u.Events.MEDIA_ATTACHED,this.onMediaAttached,this),c.off(u.Events.MEDIA_DETACHING,this.onMediaDetaching,this),c.off(u.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.off(u.Events.MANIFEST_PARSED,this.onManifestParsed,this),c.off(u.Events.LEVEL_LOADED,this.onLevelLoaded,this),c.off(u.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),c.off(u.Events.ERROR,this.onError,this),c.off(u.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),c.off(u.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),c.off(u.Events.BUFFER_CREATED,this.onBufferCreated,this),c.off(u.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),c.off(u.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),c.off(u.Events.FRAG_BUFFERED,this.onFragBuffered,this)},D.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},D.startLoad=function(c){if(this.levels){var p=this.lastCurrentTime,S=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var C=S.startLevel;C===-1&&(S.config.testBandwidth?(C=0,this.bitrateTest=!0):C=S.nextAutoLevel),this.level=S.nextLoadLevel=C,this.loadedmetadata=!1}p>0&&c===-1&&(this.log("Override startPosition with lastCurrentTime @"+p.toFixed(3)),c=p),this.state=n.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=c,this.tick()}else this._forceStartLoad=!0,this.state=n.State.STOPPED},D.stopLoad=function(){this._forceStartLoad=!1,g.prototype.stopLoad.call(this)},D.doTick=function(){switch(this.state){case n.State.IDLE:this.doTickIdle();break;case n.State.WAITING_LEVEL:var c,p=this.levels,S=this.level,C=p==null||(c=p[S])===null||c===void 0?void 0:c.details;if(C&&(!C.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(C))break;this.state=n.State.IDLE;break}break;case n.State.FRAG_LOADING_WAITING_RETRY:var I,w=self.performance.now(),O=this.retryDate;(!O||w>=O||(I=this.media)!==null&&I!==void 0&&I.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.state=n.State.IDLE)}this.onTickEnd()},D.onTickEnd=function(){g.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},D.doTickIdle=function(){var c,p,S=this.hls,C=this.levelLastLoaded,I=this.levels,w=this.media,O=S.config,x=S.nextLoadLevel;if(C!==null&&(w||!this.startFragRequested&&O.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)&&I&&I[x]){var P=I[x];this.level=S.nextLoadLevel=x;var F=P.details;if(!F||this.state===n.State.WAITING_LEVEL||F.live&&this.levelLastLoaded!==x)this.state=n.State.WAITING_LEVEL;else{var N=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:w,a.PlaylistLevelType.MAIN);if(N!==null&&!(N.len>=this.getMaxBufferLength(P.maxBitrate))){if(this._streamEnded(N,F)){var U={};return this.altAudio&&(U.type="video"),this.hls.trigger(u.Events.BUFFER_EOS,U),void(this.state=n.State.ENDED)}var j=N.end,V=this.getNextFragment(j,F);if(this.couldBacktrack&&!this.fragPrevious&&V&&V.sn!=="initSegment"){var z=V.sn-F.startSN;z>1&&(V=F.fragments[z-1],this.fragmentTracker.removeFragment(V))}if(V&&this.fragmentTracker.getState(V)===y.FragmentState.OK&&this.nextLoadPosition>j){var G=this.audioOnly&&!this.altAudio?T.ElementaryStreamTypes.AUDIO:T.ElementaryStreamTypes.VIDEO;this.afterBufferFlushed(w,G,a.PlaylistLevelType.MAIN),V=this.getNextFragment(this.nextLoadPosition,F)}V&&(!V.initSegment||V.initSegment.data||this.bitrateTest||(V=V.initSegment),((c=V.decryptdata)===null||c===void 0?void 0:c.keyFormat)!=="identity"||(p=V.decryptdata)!==null&&p!==void 0&&p.key?this.loadFragment(V,F,j):this.loadKey(V,F))}}}},D.loadFragment=function(c,p,S){var C,I=this.fragmentTracker.getState(c);if(this.fragCurrent=c,I===y.FragmentState.BACKTRACKED){var w=this.fragmentTracker.getBacktrackData(c);if(w)return this._handleFragmentLoadProgress(w),void this._handleFragmentLoadComplete(w);I=y.FragmentState.NOT_LOADED}I===y.FragmentState.NOT_LOADED||I===y.FragmentState.PARTIAL?c.sn==="initSegment"?this._loadInitSegment(c):this.bitrateTest?(c.bitrateTest=!0,this.log("Fragment "+c.sn+" of level "+c.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(c)):(this.startFragRequested=!0,g.prototype.loadFragment.call(this,c,p,S)):I===y.FragmentState.APPENDING?this.reduceMaxBufferLength(c.duration)&&this.fragmentTracker.removeFragment(c):((C=this.media)===null||C===void 0?void 0:C.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},D.getAppendedFrag=function(c){var p=this.fragmentTracker.getAppendedFrag(c,a.PlaylistLevelType.MAIN);return p&&"fragment"in p?p.fragment:p},D.getBufferedFrag=function(c){return this.fragmentTracker.getBufferedFrag(c,a.PlaylistLevelType.MAIN)},D.followingBufferedFrag=function(c){return c?this.getBufferedFrag(c.end+.5):null},D.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},D.nextLevelSwitch=function(){var c=this.levels,p=this.media;if(p!=null&&p.readyState){var S,C=this.getAppendedFrag(p.currentTime);if(C&&C.start>1&&this.flushMainBuffer(0,C.start-1),!p.paused&&c){var I=c[this.hls.nextLoadLevel],w=this.fragLastKbps;S=w&&this.fragCurrent?this.fragCurrent.duration*I.maxBitrate/(1e3*w)+1:0}else S=0;var O=this.getBufferedFrag(p.currentTime+S);if(O){var x=this.followingBufferedFrag(O);if(x){this.abortCurrentFrag();var P=x.maxStartPTS?x.maxStartPTS:x.start,F=x.duration,N=Math.max(O.end,P+Math.min(Math.max(F-this.config.maxFragLookUpTolerance,.5*F),.75*F));this.flushMainBuffer(N,Number.POSITIVE_INFINITY)}}}},D.abortCurrentFrag=function(){var c=this.fragCurrent;this.fragCurrent=null,c!=null&&c.loader&&c.loader.abort(),this.state===n.State.KEY_LOADING&&(this.state=n.State.IDLE),this.nextLoadPosition=this.getLoadPosition()},D.flushMainBuffer=function(c,p){g.prototype.flushMainBuffer.call(this,c,p,this.altAudio?"video":null)},D.onMediaAttached=function(c,p){g.prototype.onMediaAttached.call(this,c,p);var S=p.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),S.addEventListener("playing",this.onvplaying),S.addEventListener("seeked",this.onvseeked),this.gapController=new L.default(this.config,S,this.fragmentTracker,this.hls)},D.onMediaDetaching=function(){var c=this.media;c&&(c.removeEventListener("playing",this.onvplaying),c.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),g.prototype.onMediaDetaching.call(this)},D.onMediaPlaying=function(){this.tick()},D.onMediaSeeked=function(){var c=this.media,p=c?c.currentTime:null;Object(i.isFiniteNumber)(p)&&this.log("Media seeked to "+p.toFixed(3)),this.tick()},D.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(u.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=this.stalled=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null},D.onManifestParsed=function(c,p){var S,C=!1,I=!1;p.levels.forEach(function(w){(S=w.audioCodec)&&(S.indexOf("mp4a.40.2")!==-1&&(C=!0),S.indexOf("mp4a.40.5")!==-1&&(I=!0))}),this.audioCodecSwitch=C&&I&&!Object(s.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=p.levels,this.startFragRequested=!1},D.onLevelLoading=function(c,p){var S=this.levels;if(S&&this.state===n.State.IDLE){var C=S[p.level];(!C.details||C.details.live&&this.levelLastLoaded!==p.level||this.waitForCdnTuneIn(C.details))&&(this.state=n.State.WAITING_LEVEL)}},D.onLevelLoaded=function(c,p){var S,C=this.levels,I=p.level,w=p.details,O=w.totalduration;if(C){this.log("Level "+I+" loaded ["+w.startSN+","+w.endSN+"], cc ["+w.startCC+", "+w.endCC+"] duration:"+O);var x=this.fragCurrent;!x||this.state!==n.State.FRAG_LOADING&&this.state!==n.State.FRAG_LOADING_WAITING_RETRY||x.level!==p.level&&x.loader&&(this.state=n.State.IDLE,x.loader.abort());var P=C[I],F=0;if(w.live||(S=P.details)!==null&&S!==void 0&&S.live){if(w.fragments[0]||(w.deltaUpdateFailed=!0),w.deltaUpdateFailed)return;F=this.alignPlaylists(w,P.details)}if(P.details=w,this.levelLastLoaded=I,this.hls.trigger(u.Events.LEVEL_UPDATED,{details:w,level:I}),this.state===n.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(w))return;this.state=n.State.IDLE}this.startFragRequested?w.live&&this.synchronizeToLiveEdge(w):this.setStartPosition(w,F),this.tick()}else this.warn("Levels were reset while loading level "+I)},D._handleFragmentLoadProgress=function(c){var p,S=c.frag,C=c.part,I=c.payload,w=this.levels;if(w){var O=w[S.level],x=O.details;if(x){var P=O.videoCodec,F=x.PTSKnown||!x.live,N=(p=S.initSegment)===null||p===void 0?void 0:p.data,U=this._getAudioCodec(O),j=this.transmuxer=this.transmuxer||new v.default(this.hls,a.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),V=C?C.index:-1,z=V!==-1,G=new d.ChunkMetadata(S.level,S.sn,S.stats.chunkCount,I.byteLength,V,z),W=this.initPTS[S.cc];j.push(I,N,U,P,S,C,x.totalduration,F,G,W)}else this.warn("Dropping fragment "+S.sn+" of level "+S.level+" after level details were reset")}else this.warn("Levels were reset while fragment load was in progress. Fragment "+S.sn+" of level "+S.level+" will not be buffered")},D.onAudioTrackSwitching=function(c,p){var S=this.altAudio,C=!!p.url,I=p.id;if(!C){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var w=this.fragCurrent;w!=null&&w.loader&&(this.log("Switching to main audio track, cancel main fragment load"),w.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var O=this.hls;S&&O.trigger(u.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),O.trigger(u.Events.AUDIO_TRACK_SWITCHED,{id:I})}},D.onAudioTrackSwitched=function(c,p){var S=p.id,C=!!this.hls.audioTracks[S].url;if(C){var I=this.videoBuffer;I&&this.mediaBuffer!==I&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=I)}this.altAudio=C,this.tick()},D.onBufferCreated=function(c,p){var S,C,I=p.tracks,w=!1;for(var O in I){var x=I[O];if(x.id==="main"){if(C=O,S=x,O==="video"){var P=I[O];P&&(this.videoBuffer=P.buffer)}}else w=!0}w&&S?(this.log("Alternate track found, use "+C+".buffered to schedule main fragment loading"),this.mediaBuffer=S.buffer):this.mediaBuffer=this.media},D.onFragBuffered=function(c,p){var S=p.frag,C=p.part;if(!S||S.type===a.PlaylistLevelType.MAIN){if(this.fragContextChanged(S))return this.warn("Fragment "+S.sn+(C?" p: "+C.index:"")+" of level "+S.level+" finished buffering, but was aborted. state: "+this.state),void(this.state===n.State.PARSED&&(this.state=n.State.IDLE));var I=C?C.stats:S.stats;this.fragLastKbps=Math.round(8*I.total/(I.buffering.end-I.loading.first)),S.sn!=="initSegment"&&(this.fragPrevious=S),this.fragBufferedComplete(S,C)}},D.onError=function(c,p){switch(p.details){case R.ErrorDetails.FRAG_LOAD_ERROR:case R.ErrorDetails.FRAG_LOAD_TIMEOUT:case R.ErrorDetails.KEY_LOAD_ERROR:case R.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(a.PlaylistLevelType.MAIN,p);break;case R.ErrorDetails.LEVEL_LOAD_ERROR:case R.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==n.State.ERROR&&(p.fatal?(this.warn(""+p.details),this.state=n.State.ERROR):p.levelRetry||this.state!==n.State.WAITING_LEVEL||(this.state=n.State.IDLE));break;case R.ErrorDetails.BUFFER_FULL_ERROR:if(p.parent==="main"&&(this.state===n.State.PARSING||this.state===n.State.PARSED)){var S=!0,C=this.getFwdBufferInfo(this.media,a.PlaylistLevelType.MAIN);C&&C.len>.5&&(S=!this.reduceMaxBufferLength(C.len)),S&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}}},D.checkBuffer=function(){var c=this.media,p=this.gapController;if(c&&p&&c.readyState){var S=A.BufferHelper.getBuffered(c);!this.loadedmetadata&&S.length?(this.loadedmetadata=!0,this.seekToStartPos()):p.poll(this.lastCurrentTime),this.lastCurrentTime=c.currentTime}},D.onFragLoadEmergencyAborted=function(){this.state=n.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},D.onBufferFlushed=function(c,p){var S=p.type;if(S!==T.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var C=(S===T.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(C,S,a.PlaylistLevelType.MAIN)}},D.onLevelsUpdated=function(c,p){this.levels=p.levels},D.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},D.seekToStartPos=function(){var c=this.media,p=c.currentTime,S=this.startPosition;if(S>=0&&p<S){if(c.seeking)return void E.logger.log("could not seek to "+S+", already seeking at "+p);var C=A.BufferHelper.getBuffered(c),I=(C.length?C.start(0):0)-S;I>0&&I<this.config.maxBufferHole&&(E.logger.log("adjusting start position by "+I+" to match buffer start"),S+=I,this.startPosition=S),this.log("seek to target start position "+S+" from current time "+p),c.currentTime=S}},D._getAudioCodec=function(c){var p=this.config.defaultAudioCodec||c.audioCodec;return this.audioCodecSwap&&p&&(this.log("Swapping audio codec"),p=p.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5"),p},D._loadBitrateTestFrag=function(c){var p=this;this._doFragLoad(c).then(function(S){var C=p.hls;if(S&&!C.nextLoadLevel&&!p.fragContextChanged(c)){p.fragLoadError=0,p.state=n.State.IDLE,p.startFragRequested=!1,p.bitrateTest=!1;var I=c.stats;I.parsing.start=I.parsing.end=I.buffering.start=I.buffering.end=self.performance.now(),C.trigger(u.Events.FRAG_LOADED,S)}})},D._handleTransmuxComplete=function(c){var p,S="main",C=this.hls,I=c.remuxResult,w=c.chunkMeta,O=this.getCurrentContext(w);if(!O)return this.warn("The loading context changed while buffering fragment "+w.sn+" of level "+w.level+". This chunk will not be buffered."),void this.resetLiveStartWhenNotLoaded(w.level);var x=O.frag,P=O.part,F=O.level,N=I.video,U=I.text,j=I.id3,V=I.initSegment,z=this.altAudio?void 0:I.audio;if(!this.fragContextChanged(x)){if(this.state=n.State.PARSING,V){V.tracks&&(this._bufferInitSegment(F,V.tracks,x,w),C.trigger(u.Events.FRAG_PARSING_INIT_SEGMENT,{frag:x,id:S,tracks:V.tracks}));var G=V.initPTS,W=V.timescale;Object(i.isFiniteNumber)(G)&&(this.initPTS[x.cc]=G,C.trigger(u.Events.INIT_PTS_FOUND,{frag:x,id:S,initPTS:G,timescale:W}))}if(N&&I.independent!==!1){if(F.details){var $=N.startPTS,Y=N.endPTS,re=N.startDTS,ue=N.endDTS;if(P)P.elementaryStreams[N.type]={startPTS:$,endPTS:Y,startDTS:re,endDTS:ue};else if(N.firstKeyFrame&&N.independent&&(this.couldBacktrack=!0),N.dropped&&N.independent){if(this.getLoadPosition()+this.config.maxBufferHole<$)return void this.backtrack(x);x.setElementaryStreamInfo(N.type,x.start,Y,x.start,ue,!0)}x.setElementaryStreamInfo(N.type,$,Y,re,ue),this.bufferFragmentData(N,x,P,w)}}else if(I.independent===!1)return void this.backtrack(x);if(z){var oe=z.startPTS,M=z.endPTS,B=z.startDTS,K=z.endDTS;P&&(P.elementaryStreams[T.ElementaryStreamTypes.AUDIO]={startPTS:oe,endPTS:M,startDTS:B,endDTS:K}),x.setElementaryStreamInfo(T.ElementaryStreamTypes.AUDIO,oe,M,B,K),this.bufferFragmentData(z,x,P,w)}if(j!=null&&(p=j.samples)!==null&&p!==void 0&&p.length){var H={frag:x,id:S,samples:j.samples};C.trigger(u.Events.FRAG_PARSING_METADATA,H)}if(U){var q={frag:x,id:S,samples:U.samples};C.trigger(u.Events.FRAG_PARSING_USERDATA,q)}}},D._bufferInitSegment=function(c,p,S,C){var I=this;if(this.state===n.State.PARSING){this.audioOnly=!!p.audio&&!p.video,this.altAudio&&!this.audioOnly&&delete p.audio;var w=p.audio,O=p.video,x=p.audiovideo;if(w){var P=c.audioCodec,F=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(P&&(P=P.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5"),w.metadata.channelCount!==1&&F.indexOf("firefox")===-1&&(P="mp4a.40.5")),F.indexOf("android")!==-1&&w.container!=="audio/mpeg"&&(P="mp4a.40.2",this.log("Android: force audio codec to "+P)),c.audioCodec&&c.audioCodec!==P&&this.log('Swapping manifest audio codec "'+c.audioCodec+'" for "'+P+'"'),w.levelCodec=P,w.id="main",this.log("Init audio buffer, container:"+w.container+", codecs[selected/level/parsed]=["+(P||"")+"/"+(c.audioCodec||"")+"/"+w.codec+"]")}O&&(O.levelCodec=c.videoCodec,O.id="main",this.log("Init video buffer, container:"+O.container+", codecs[level/parsed]=["+(c.videoCodec||"")+"/"+O.codec+"]")),x&&this.log("Init audiovideo buffer, container:"+x.container+", codecs[level/parsed]=["+(c.attrs.CODECS||"")+"/"+x.codec+"]"),this.hls.trigger(u.Events.BUFFER_CODECS,p),Object.keys(p).forEach(function(N){var U=p[N].initSegment;U!=null&&U.byteLength&&I.hls.trigger(u.Events.BUFFER_APPENDING,{type:N,data:U,frag:S,part:null,chunkMeta:C,parent:S.type})}),this.tick()}},D.backtrack=function(c){this.couldBacktrack=!0,this.resetTransmuxer(),this.flushBufferGap(c);var p=this.fragmentTracker.backtrack(c);this.fragPrevious=null,this.nextLoadPosition=c.start,p?this.resetFragmentLoading(c):this.state=n.State.BACKTRACKING},D.checkFragmentChanged=function(){var c=this.media,p=null;if(c&&c.readyState>1&&c.seeking===!1){var S=c.currentTime;if(A.BufferHelper.isBuffered(c,S)?p=this.getAppendedFrag(S):A.BufferHelper.isBuffered(c,S+.1)&&(p=this.getAppendedFrag(S+.1)),p){var C=this.fragPlaying,I=p.level;C&&p.sn===C.sn&&C.level===I&&p.urlId===C.urlId||(this.hls.trigger(u.Events.FRAG_CHANGED,{frag:p}),C&&C.level===I||this.hls.trigger(u.Events.LEVEL_SWITCHED,{level:I}),this.fragPlaying=p)}}},k=b,(_=[{key:"nextLevel",get:function(){var c=this.nextBufferedFrag;return c?c.level:-1}},{key:"currentLevel",get:function(){var c=this.media;if(c){var p=this.getAppendedFrag(c.currentTime);if(p)return p.level}return-1}},{key:"nextBufferedFrag",get:function(){var c=this.media;if(c){var p=this.getAppendedFrag(c.currentTime);return this.followingBufferedFrag(p)}return null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}])&&o(k.prototype,_),b}(n.default)},"./src/controller/subtitle-stream-controller.ts":function(e,t,r){r.r(t),r.d(t,"SubtitleStreamController",function(){return E});var i=r("./src/events.ts"),n=r("./src/utils/logger.ts"),s=r("./src/utils/buffer-helper.ts"),u=r("./src/controller/fragment-finders.ts"),A=r("./src/utils/discontinuities.ts"),y=r("./src/controller/level-helper.ts"),a=r("./src/controller/fragment-tracker.ts"),T=r("./src/controller/base-stream-controller.ts"),v=r("./src/types/loader.ts"),d=r("./src/types/level.ts");function L(o,f){for(var l=0;l<f.length;l++){var g=f[l];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(o,g.key,g)}}function R(o,f){return(R=Object.setPrototypeOf||function(l,g){return l.__proto__=g,l})(o,f)}var E=function(o){var f,l;function g(k,_){var D;return(D=o.call(this,k,_,"[subtitle-stream-controller]")||this).levels=[],D.currentTrackId=-1,D.tracksBuffered=[],D.mainDetails=null,D._registerListeners(),D}l=o,(f=g).prototype=Object.create(l.prototype),f.prototype.constructor=f,R(f,l);var m,h,b=g.prototype;return b.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},b._registerListeners=function(){var k=this.hls;k.on(i.Events.MEDIA_ATTACHED,this.onMediaAttached,this),k.on(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),k.on(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),k.on(i.Events.LEVEL_LOADED,this.onLevelLoaded,this),k.on(i.Events.ERROR,this.onError,this),k.on(i.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),k.on(i.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),k.on(i.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),k.on(i.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),k.on(i.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},b._unregisterListeners=function(){var k=this.hls;k.off(i.Events.MEDIA_ATTACHED,this.onMediaAttached,this),k.off(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),k.off(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),k.off(i.Events.LEVEL_LOADED,this.onLevelLoaded,this),k.off(i.Events.ERROR,this.onError,this),k.off(i.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),k.off(i.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),k.off(i.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),k.off(i.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),k.off(i.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},b.startLoad=function(){this.stopLoad(),this.state=T.State.IDLE,this.setInterval(500),this.tick()},b.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},b.onLevelLoaded=function(k,_){this.mainDetails=_.details},b.onSubtitleFragProcessed=function(k,_){var D=_.frag,c=_.success;if(this.fragPrevious=D,this.state=T.State.IDLE,c){var p=this.tracksBuffered[this.currentTrackId];if(p){for(var S,C=D.start,I=0;I<p.length;I++)if(C>=p[I].start&&C<=p[I].end){S=p[I];break}var w=D.start+D.duration;S?S.end=w:(S={start:C,end:w},p.push(S)),this.fragmentTracker.fragBuffered(D)}}},b.onBufferFlushing=function(k,_){var D=_.startOffset,c=_.endOffset;if(D===0&&c!==Number.POSITIVE_INFINITY){var p=this.currentTrackId,S=this.levels;if(!S.length||!S[p]||!S[p].details)return;var C=c-S[p].details.targetduration;if(C<=0)return;_.endOffsetSubtitles=Math.max(0,C),this.tracksBuffered.forEach(function(I){for(var w=0;w<I.length;)if(I[w].end<=C)I.shift();else{if(!(I[w].start<C))break;I[w].start=C,w++}}),this.fragmentTracker.removeFragmentsInRange(D,C,v.PlaylistLevelType.SUBTITLE)}},b.onError=function(k,_){var D,c=_.frag;c&&c.type===v.PlaylistLevelType.SUBTITLE&&((D=this.fragCurrent)!==null&&D!==void 0&&D.loader&&this.fragCurrent.loader.abort(),this.state=T.State.IDLE)},b.onSubtitleTracksUpdated=function(k,_){var D=this,c=_.subtitleTracks;this.tracksBuffered=[],this.levels=c.map(function(p){return new d.Level(p)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(p){D.tracksBuffered[p.id]=[]}),this.mediaBuffer=null},b.onSubtitleTrackSwitch=function(k,_){if(this.currentTrackId=_.id,this.levels.length&&this.currentTrackId!==-1){var D=this.levels[this.currentTrackId];D!=null&&D.details?(this.mediaBuffer=this.mediaBufferTimeRanges,this.setInterval(500)):this.mediaBuffer=null}else this.clearInterval()},b.onSubtitleTrackLoaded=function(k,_){var D,c=_.details,p=_.id,S=this.currentTrackId,C=this.levels;if(C.length){var I=C[S];if(!(p>=C.length||p!==S)&&I){if(this.mediaBuffer=this.mediaBufferTimeRanges,c.live||(D=I.details)!==null&&D!==void 0&&D.live){var w=this.mainDetails;if(c.deltaUpdateFailed||!w)return;var O=w.fragments[0];I.details?this.alignPlaylists(c,I.details)===0&&O&&Object(y.addSliding)(c,O.start):c.hasProgramDateTime&&w.hasProgramDateTime?Object(A.alignPDT)(c,w):O&&Object(y.addSliding)(c,O.start)}I.details=c,this.levelLastLoaded=p,this.tick(),c.live&&!this.fragCurrent&&this.media&&this.state===T.State.IDLE&&(Object(u.findFragmentByPTS)(null,c.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),I.details=void 0))}}},b._handleFragmentLoadComplete=function(k){var _=k.frag,D=k.payload,c=_.decryptdata,p=this.hls;if(!this.fragContextChanged(_)&&D&&D.byteLength>0&&c&&c.key&&c.iv&&c.method==="AES-128"){var S=performance.now();this.decrypter.webCryptoDecrypt(new Uint8Array(D),c.key.buffer,c.iv.buffer).then(function(C){var I=performance.now();p.trigger(i.Events.FRAG_DECRYPTED,{frag:_,payload:C,stats:{tstart:S,tdecrypt:I}})})}},b.doTick=function(){if(this.media){if(this.state===T.State.IDLE){var k,_=this.currentTrackId,D=this.levels;if(!D.length||!D[_]||!D[_].details)return;var c=D[_].details,p=c.targetduration,S=this.config,C=this.media,I=s.BufferHelper.bufferedInfo(this.mediaBufferTimeRanges,C.currentTime-p,S.maxBufferHole),w=I.end;if(I.len>this.getMaxBufferLength()+p)return;console.assert(c,"Subtitle track details are defined on idle subtitle stream controller tick");var O,x=c.fragments,P=x.length,F=c.edge,N=this.fragPrevious;if(w<F){var U=S.maxFragLookUpTolerance;N&&c.hasProgramDateTime&&(O=Object(u.findFragmentByPDT)(x,N.endProgramDateTime,U)),O||!(O=Object(u.findFragmentByPTS)(N,x,w,U))&&N&&N.start<x[0].start&&(O=x[0])}else O=x[P-1];(k=O)!==null&&k!==void 0&&k.encrypted?(n.logger.log("Loading key for "+O.sn),this.state=T.State.KEY_LOADING,this.hls.trigger(i.Events.KEY_LOADING,{frag:O})):O&&this.fragmentTracker.getState(O)===a.FragmentState.NOT_LOADED&&this.loadFragment(O,c,w)}}else this.state=T.State.IDLE},b.loadFragment=function(k,_,D){this.fragCurrent=k,o.prototype.loadFragment.call(this,k,_,D)},m=g,(h=[{key:"mediaBufferTimeRanges",get:function(){return this.tracksBuffered[this.currentTrackId]||[]}}])&&L(m.prototype,h),g}(T.default)},"./src/controller/subtitle-track-controller.ts":function(e,t,r){r.r(t);var i=r("./src/events.ts"),n=r("./src/utils/texttrack-utils.ts"),s=r("./src/controller/base-playlist-controller.ts"),u=r("./src/types/loader.ts");function A(v,d){for(var L=0;L<d.length;L++){var R=d[L];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(v,R.key,R)}}function y(v,d){return(y=Object.setPrototypeOf||function(L,R){return L.__proto__=R,L})(v,d)}var a=function(v){var d,L;function R(l){var g;return(g=v.call(this,l,"[subtitle-track-controller]")||this).media=null,g.tracks=[],g.groupId=null,g.tracksInGroup=[],g.trackId=-1,g.selectDefaultTrack=!0,g.queuedDefaultTrack=-1,g.trackChangeListener=function(){return g.onTextTracksChanged()},g.asyncPollTrackChange=function(){return g.pollTrackChange(0)},g.useTextTrackPolling=!1,g.subtitlePollingInterval=-1,g.subtitleDisplay=!0,g.registerListeners(),g}L=v,(d=R).prototype=Object.create(L.prototype),d.prototype.constructor=d,y(d,L);var E,o,f=R.prototype;return f.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,v.prototype.destroy.call(this)},f.registerListeners=function(){var l=this.hls;l.on(i.Events.MEDIA_ATTACHED,this.onMediaAttached,this),l.on(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.on(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.on(i.Events.MANIFEST_PARSED,this.onManifestParsed,this),l.on(i.Events.LEVEL_LOADING,this.onLevelLoading,this),l.on(i.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),l.on(i.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),l.on(i.Events.ERROR,this.onError,this)},f.unregisterListeners=function(){var l=this.hls;l.off(i.Events.MEDIA_ATTACHED,this.onMediaAttached,this),l.off(i.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.off(i.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.off(i.Events.MANIFEST_PARSED,this.onManifestParsed,this),l.off(i.Events.LEVEL_LOADING,this.onLevelLoading,this),l.off(i.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),l.off(i.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),l.off(i.Events.ERROR,this.onError,this)},f.onMediaAttached=function(l,g){this.media=g.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},f.pollTrackChange=function(l){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,l)},f.onMediaDetaching=function(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),T(this.media.textTracks).forEach(function(l){Object(n.clearCurrentCues)(l)}),this.subtitleTrack=-1,this.media=null)},f.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},f.onManifestParsed=function(l,g){this.tracks=g.subtitleTracks},f.onSubtitleTrackLoaded=function(l,g){var m=g.id,h=g.details,b=this.trackId,k=this.tracksInGroup[b];if(k){var _=k.details;k.details=g.details,this.log("subtitle track "+m+" loaded ["+h.startSN+"-"+h.endSN+"]"),m===this.trackId&&(this.retryCount=0,this.playlistLoaded(m,g,_))}else this.warn("Invalid subtitle track id "+m)},f.onLevelLoading=function(l,g){this.switchLevel(g.level)},f.onLevelSwitching=function(l,g){this.switchLevel(g.level)},f.switchLevel=function(l){var g=this.hls.levels[l];if(g!=null&&g.textGroupIds){var m=g.textGroupIds[g.urlId];if(this.groupId!==m){var h=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,b=this.tracks.filter(function(D){return!m||D.groupId===m});this.tracksInGroup=b;var k=this.findTrackId(h==null?void 0:h.name)||this.findTrackId();this.groupId=m;var _={subtitleTracks:b};this.log("Updating subtitle tracks, "+b.length+' track(s) found in "'+m+'" group-id'),this.hls.trigger(i.Events.SUBTITLE_TRACKS_UPDATED,_),k!==-1&&this.setSubtitleTrack(k,h)}}},f.findTrackId=function(l){for(var g=this.tracksInGroup,m=0;m<g.length;m++){var h=g[m];if((!this.selectDefaultTrack||h.default)&&(!l||l===h.name))return h.id}return-1},f.onError=function(l,g){v.prototype.onError.call(this,l,g),!g.fatal&&g.context&&g.context.type===u.PlaylistContextType.SUBTITLE_TRACK&&g.context.id===this.trackId&&g.context.groupId===this.groupId&&this.retryLoadingOrFail(g)},f.loadPlaylist=function(l){var g=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(g)){var m=g.id,h=g.groupId,b=g.url;if(l)try{b=l.addDirectives(b)}catch(k){this.warn("Could not construct new URL with HLS Delivery Directives: "+k)}this.log("Loading subtitle playlist for id "+m),this.hls.trigger(i.Events.SUBTITLE_TRACK_LOADING,{url:b,id:m,groupId:h,deliveryDirectives:l||null})}},f.toggleTrackModes=function(l){var g=this,m=this.media,h=this.subtitleDisplay,b=this.trackId;if(m){var k=T(m.textTracks),_=k.filter(function(p){return p.groupId===g.groupId});if(l===-1)[].slice.call(k).forEach(function(p){p.mode="disabled"});else{var D=_[b];D&&(D.mode="disabled")}var c=_[l];c&&(c.mode=h?"showing":"hidden")}},f.setSubtitleTrack=function(l,g){var m,h=this.tracksInGroup;if(this.media){if(this.trackId!==l&&this.toggleTrackModes(l),!(this.trackId===l&&(l===-1||(m=h[l])!==null&&m!==void 0&&m.details)||l<-1||l>=h.length)){this.clearTimer();var b=h[l];if(this.log("Switching to subtitle track "+l),this.trackId=l,b){var k=b.id,_=b.groupId,D=_===void 0?"":_,c=b.name,p=b.type,S=b.url;this.hls.trigger(i.Events.SUBTITLE_TRACK_SWITCH,{id:k,groupId:D,name:c,type:p,url:S});var C=this.switchParams(b.url,g==null?void 0:g.details);this.loadPlaylist(C)}else this.hls.trigger(i.Events.SUBTITLE_TRACK_SWITCH,{id:l})}}else this.queuedDefaultTrack=l},f.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),this.media&&this.hls.config.renderTextTracksNatively){for(var l=-1,g=T(this.media.textTracks),m=0;m<g.length;m++)if(g[m].mode==="hidden")l=m;else if(g[m].mode==="showing"){l=m;break}this.subtitleTrack!==l&&(this.subtitleTrack=l)}},E=R,(o=[{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(l){this.selectDefaultTrack=!1;var g=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(l,g)}}])&&A(E.prototype,o),R}(s.default);function T(v){for(var d=[],L=0;L<v.length;L++){var R=v[L];R.kind==="subtitles"&&R.label&&d.push(v[L])}return d}t.default=a},"./src/controller/timeline-controller.ts":function(e,t,r){r.r(t),r.d(t,"TimelineController",function(){return d});var i=r("./src/polyfills/number.ts"),n=r("./src/events.ts"),s=r("./src/utils/cea-608-parser.ts"),u=r("./src/utils/output-filter.ts"),A=r("./src/utils/webvtt-parser.ts"),y=r("./src/utils/texttrack-utils.ts"),a=r("./src/utils/imsc1-ttml-parser.ts"),T=r("./src/types/loader.ts"),v=r("./src/utils/logger.ts"),d=function(){function R(o){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this.captionsProperties=void 0,this.hls=o,this.config=o.config,this.Cues=o.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var f=new u.default(this,"textTrack1"),l=new u.default(this,"textTrack2"),g=new u.default(this,"textTrack3"),m=new u.default(this,"textTrack4");this.cea608Parser1=new s.default(1,f,l),this.cea608Parser2=new s.default(3,g,m)}o.on(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),o.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.on(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.on(n.Events.MANIFEST_LOADED,this.onManifestLoaded,this),o.on(n.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),o.on(n.Events.FRAG_LOADING,this.onFragLoading,this),o.on(n.Events.FRAG_LOADED,this.onFragLoaded,this),o.on(n.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),o.on(n.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),o.on(n.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),o.on(n.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),o.on(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var E=R.prototype;return E.destroy=function(){var o=this.hls;o.off(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),o.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.off(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.off(n.Events.MANIFEST_LOADED,this.onManifestLoaded,this),o.off(n.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),o.off(n.Events.FRAG_LOADING,this.onFragLoading,this),o.off(n.Events.FRAG_LOADED,this.onFragLoaded,this),o.off(n.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),o.off(n.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),o.off(n.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),o.off(n.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),o.off(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},E.addCues=function(o,f,l,g,m){for(var h,b,k,_,D=!1,c=m.length;c--;){var p=m[c],S=(h=p[0],b=p[1],k=f,_=l,Math.min(b,_)-Math.max(h,k));if(S>=0&&(p[0]=Math.min(p[0],f),p[1]=Math.max(p[1],l),D=!0,S/(l-f)>.5))return}if(D||m.push([f,l]),this.config.renderTextTracksNatively){var C=this.captionsTracks[o];this.Cues.newCue(C,f,l,g)}else{var I=this.Cues.newCue(null,f,l,g);this.hls.trigger(n.Events.CUES_PARSED,{type:"captions",cues:I,track:o})}},E.onInitPtsFound=function(o,f){var l=this,g=f.frag,m=f.id,h=f.initPTS,b=f.timescale,k=this.unparsedVttFrags;m==="main"&&(this.initPTS[g.cc]=h,this.timescale[g.cc]=b),k.length&&(this.unparsedVttFrags=[],k.forEach(function(_){l.onFragLoaded(n.Events.FRAG_LOADED,_)}))},E.getExistingTrack=function(o){var f=this.media;if(f)for(var l=0;l<f.textTracks.length;l++){var g=f.textTracks[l];if(g[o])return g}return null},E.createCaptionsTrack=function(o){this.config.renderTextTracksNatively?this.createNativeTrack(o):this.createNonNativeTrack(o)},E.createNativeTrack=function(o){if(!this.captionsTracks[o]){var f=this.captionsProperties,l=this.captionsTracks,g=this.media,m=f[o],h=m.label,b=m.languageCode,k=this.getExistingTrack(o);if(k)l[o]=k,Object(y.clearCurrentCues)(l[o]),Object(y.sendAddTrackEvent)(l[o],g);else{var _=this.createTextTrack("captions",h,b);_&&(_[o]=!0,l[o]=_)}}},E.createNonNativeTrack=function(o){if(!this.nonNativeCaptionsTracks[o]){var f=this.captionsProperties[o];if(f){var l={_id:o,label:f.label,kind:"captions",default:!!f.media&&!!f.media.default,closedCaptions:f.media};this.nonNativeCaptionsTracks[o]=l,this.hls.trigger(n.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[l]})}}},E.createTextTrack=function(o,f,l){var g=this.media;if(g)return g.addTextTrack(o,f,l)},E.onMediaAttaching=function(o,f){this.media=f.media,this._cleanTracks()},E.onMediaDetaching=function(){var o=this.captionsTracks;Object.keys(o).forEach(function(f){Object(y.clearCurrentCues)(o[f]),delete o[f]}),this.nonNativeCaptionsTracks={}},E.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},E._cleanTracks=function(){var o=this.media;if(o){var f=o.textTracks;if(f)for(var l=0;l<f.length;l++)Object(y.clearCurrentCues)(f[l])}},E.onSubtitleTracksUpdated=function(o,f){var l=this;this.textTracks=[];var g=f.subtitleTracks||[],m=g.some(function(_){return _.textCodec===a.IMSC1_CODEC});if(this.config.enableWebVTT||m&&this.config.enableIMSC1){var h=this.tracks&&g&&this.tracks.length===g.length;if(this.tracks=g||[],this.config.renderTextTracksNatively){var b=this.media?this.media.textTracks:[];this.tracks.forEach(function(_,D){var c;if(D<b.length){for(var p=null,S=0;S<b.length;S++)if(L(b[S],_)){p=b[S];break}p&&(c=p)}c?Object(y.clearCurrentCues)(c):(c=l.createTextTrack("subtitles",_.name,_.lang))&&(c.mode="disabled"),c&&(c.groupId=_.groupId,l.textTracks.push(c))})}else if(!h&&this.tracks&&this.tracks.length){var k=this.tracks.map(function(_){return{label:_.name,kind:_.type.toLowerCase(),default:_.default,subtitleTrack:_}});this.hls.trigger(n.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:k})}}},E.onManifestLoaded=function(o,f){var l=this;this.config.enableCEA708Captions&&f.captions&&f.captions.forEach(function(g){var m=/(?:CC|SERVICE)([1-4])/.exec(g.instreamId);if(m){var h="textTrack"+m[1],b=l.captionsProperties[h];b&&(b.label=g.name,g.lang&&(b.languageCode=g.lang),b.media=g)}})},E.onFragLoading=function(o,f){var l=this.cea608Parser1,g=this.cea608Parser2,m=this.lastSn;if(this.enabled&&l&&g&&f.frag.type===T.PlaylistLevelType.MAIN){var h=f.frag.sn;h!==m+1&&(l.reset(),g.reset()),this.lastSn=h}},E.onFragLoaded=function(o,f){var l=f.frag,g=f.payload,m=this.initPTS,h=this.unparsedVttFrags;if(l.type===T.PlaylistLevelType.SUBTITLE)if(g.byteLength){if(!Object(i.isFiniteNumber)(m[l.cc]))return h.push(f),void(m.length&&this.hls.trigger(n.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:l,error:new Error("Missing initial subtitle PTS")}));var b=l.decryptdata;if(b==null||b.key==null||b.method!=="AES-128"){var k=this.tracks[l.level],_=this.vttCCs;_[l.cc]||(_[l.cc]={start:l.start,prevCC:this.prevCC,new:!0},this.prevCC=l.cc),k&&k.textCodec===a.IMSC1_CODEC?this._parseIMSC1(l,g):this._parseVTTs(l,g,_)}}else this.hls.trigger(n.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:l,error:new Error("Empty subtitle payload")})},E._parseIMSC1=function(o,f){var l=this,g=this.hls;Object(a.parseIMSC1)(f,this.initPTS[o.cc],this.timescale[o.cc],function(m){l._appendCues(m,o.level),g.trigger(n.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:o})},function(m){v.logger.log("Failed to parse IMSC1: "+m),g.trigger(n.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:o,error:m})})},E._parseVTTs=function(o,f,l){var g=this,m=this.hls;Object(A.parseWebVTT)(f,this.initPTS[o.cc],this.timescale[o.cc],l,o.cc,o.start,function(h){g._appendCues(h,o.level),m.trigger(n.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:o})},function(h){g._fallbackToIMSC1(o,f),v.logger.log("Failed to parse VTT cue: "+h),m.trigger(n.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:o,error:h})})},E._fallbackToIMSC1=function(o,f){var l=this,g=this.tracks[o.level];g.textCodec||Object(a.parseIMSC1)(f,this.initPTS[o.cc],this.timescale[o.cc],function(){g.textCodec=a.IMSC1_CODEC,l._parseIMSC1(o,f)},function(){g.textCodec="wvtt"})},E._appendCues=function(o,f){var l=this.hls;if(this.config.renderTextTracksNatively){var g=this.textTracks[f];if(g.mode==="disabled")return;o.forEach(function(h){return Object(y.addCueToTrack)(g,h)})}else{var m=this.tracks[f].default?"default":"subtitles"+f;l.trigger(n.Events.CUES_PARSED,{type:"subtitles",cues:o,track:m})}},E.onFragDecrypted=function(o,f){var l=f.frag;if(l.type===T.PlaylistLevelType.SUBTITLE){if(!Object(i.isFiniteNumber)(this.initPTS[l.cc]))return void this.unparsedVttFrags.push(f);this.onFragLoaded(n.Events.FRAG_LOADED,f)}},E.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},E.onFragParsingUserdata=function(o,f){var l=this.cea608Parser1,g=this.cea608Parser2;if(this.enabled&&l&&g)for(var m=0;m<f.samples.length;m++){var h=f.samples[m].bytes;if(h){var b=this.extractCea608Data(h);l.addData(f.samples[m].pts,b[0]),g.addData(f.samples[m].pts,b[1])}}},E.onBufferFlushing=function(o,f){var l=f.startOffset,g=f.endOffset,m=f.endOffsetSubtitles,h=f.type,b=this.media;if(b&&!(b.currentTime<g)){if(!h||h==="video"){var k=this.captionsTracks;Object.keys(k).forEach(function(D){return Object(y.removeCuesInRange)(k[D],l,g)})}if(this.config.renderTextTracksNatively&&l===0&&m!==void 0){var _=this.textTracks;Object.keys(_).forEach(function(D){return Object(y.removeCuesInRange)(_[D],l,m)})}}},E.extractCea608Data=function(o){for(var f=31&o[0],l=2,g=[[],[]],m=0;m<f;m++){var h=o[l++],b=127&o[l++],k=127&o[l++],_=3&h;b===0&&k===0||(4&h)!=0&&(_!==0&&_!==1||(g[_].push(b),g[_].push(k)))}return g},R}();function L(R,E){return R&&R.label===E.name&&!(R.textTrack1||R.textTrack2)}},"./src/crypt/aes-crypto.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return i});var i=function(){function n(s,u){this.subtle=void 0,this.aesIV=void 0,this.subtle=s,this.aesIV=u}return n.prototype.decrypt=function(s,u){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},u,s)},n}()},"./src/crypt/aes-decryptor.ts":function(e,t,r){r.r(t),r.d(t,"removePadding",function(){return n}),r.d(t,"default",function(){return s});var i=r("./src/utils/typed-array.ts");function n(u){var A=u.byteLength,y=A&&new DataView(u.buffer).getUint8(A-1);return y?Object(i.sliceUint8)(u,0,A-y):u}var s=function(){function u(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var A=u.prototype;return A.uint8ArrayToUint32Array_=function(y){for(var a=new DataView(y),T=new Uint32Array(4),v=0;v<4;v++)T[v]=a.getUint32(4*v);return T},A.initTable=function(){var y=this.sBox,a=this.invSBox,T=this.subMix,v=T[0],d=T[1],L=T[2],R=T[3],E=this.invSubMix,o=E[0],f=E[1],l=E[2],g=E[3],m=new Uint32Array(256),h=0,b=0,k=0;for(k=0;k<256;k++)m[k]=k<128?k<<1:k<<1^283;for(k=0;k<256;k++){var _=b^b<<1^b<<2^b<<3^b<<4;_=_>>>8^255&_^99,y[h]=_,a[_]=h;var D=m[h],c=m[D],p=m[c],S=257*m[_]^16843008*_;v[h]=S<<24|S>>>8,d[h]=S<<16|S>>>16,L[h]=S<<8|S>>>24,R[h]=S,S=16843009*p^65537*c^257*D^16843008*h,o[_]=S<<24|S>>>8,f[_]=S<<16|S>>>16,l[_]=S<<8|S>>>24,g[_]=S,h?(h=D^m[m[m[p^D]]],b^=m[m[b]]):h=b=1}},A.expandKey=function(y){for(var a=this.uint8ArrayToUint32Array_(y),T=!0,v=0;v<a.length&&T;)T=a[v]===this.key[v],v++;if(!T){this.key=a;var d=this.keySize=a.length;if(d!==4&&d!==6&&d!==8)throw new Error("Invalid aes key size="+d);var L,R,E,o,f=this.ksRows=4*(d+6+1),l=this.keySchedule=new Uint32Array(f),g=this.invKeySchedule=new Uint32Array(f),m=this.sBox,h=this.rcon,b=this.invSubMix,k=b[0],_=b[1],D=b[2],c=b[3];for(L=0;L<f;L++)L<d?E=l[L]=a[L]:(o=E,L%d==0?(o=m[(o=o<<8|o>>>24)>>>24]<<24|m[o>>>16&255]<<16|m[o>>>8&255]<<8|m[255&o],o^=h[L/d|0]<<24):d>6&&L%d==4&&(o=m[o>>>24]<<24|m[o>>>16&255]<<16|m[o>>>8&255]<<8|m[255&o]),l[L]=E=(l[L-d]^o)>>>0);for(R=0;R<f;R++)L=f-R,o=3&R?l[L]:l[L-4],g[R]=R<4||L<=4?o:k[m[o>>>24]]^_[m[o>>>16&255]]^D[m[o>>>8&255]]^c[m[255&o]],g[R]=g[R]>>>0}},A.networkToHostOrderSwap=function(y){return y<<24|(65280&y)<<8|(16711680&y)>>8|y>>>24},A.decrypt=function(y,a,T){for(var v,d,L,R,E,o,f,l,g,m,h,b,k,_,D=this.keySize+6,c=this.invKeySchedule,p=this.invSBox,S=this.invSubMix,C=S[0],I=S[1],w=S[2],O=S[3],x=this.uint8ArrayToUint32Array_(T),P=x[0],F=x[1],N=x[2],U=x[3],j=new Int32Array(y),V=new Int32Array(j.length),z=this.networkToHostOrderSwap;a<j.length;){for(g=z(j[a]),m=z(j[a+1]),h=z(j[a+2]),b=z(j[a+3]),E=g^c[0],o=b^c[1],f=h^c[2],l=m^c[3],k=4,_=1;_<D;_++)v=C[E>>>24]^I[o>>16&255]^w[f>>8&255]^O[255&l]^c[k],d=C[o>>>24]^I[f>>16&255]^w[l>>8&255]^O[255&E]^c[k+1],L=C[f>>>24]^I[l>>16&255]^w[E>>8&255]^O[255&o]^c[k+2],R=C[l>>>24]^I[E>>16&255]^w[o>>8&255]^O[255&f]^c[k+3],E=v,o=d,f=L,l=R,k+=4;v=p[E>>>24]<<24^p[o>>16&255]<<16^p[f>>8&255]<<8^p[255&l]^c[k],d=p[o>>>24]<<24^p[f>>16&255]<<16^p[l>>8&255]<<8^p[255&E]^c[k+1],L=p[f>>>24]<<24^p[l>>16&255]<<16^p[E>>8&255]<<8^p[255&o]^c[k+2],R=p[l>>>24]<<24^p[E>>16&255]<<16^p[o>>8&255]<<8^p[255&f]^c[k+3],V[a]=z(v^P),V[a+1]=z(R^F),V[a+2]=z(L^N),V[a+3]=z(d^U),P=g,F=m,N=h,U=b,a+=4}return V.buffer},u}()},"./src/crypt/decrypter.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return a});var i=r("./src/crypt/aes-crypto.ts"),n=r("./src/crypt/fast-aes-key.ts"),s=r("./src/crypt/aes-decryptor.ts"),u=r("./src/utils/logger.ts"),A=r("./src/utils/mp4-tools.ts"),y=r("./src/utils/typed-array.ts"),a=function(){function T(d,L,R){var E=(R===void 0?{}:R).removePKCS7Padding,o=E===void 0||E;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=d,this.config=L,this.removePKCS7Padding=o,o)try{var f=self.crypto;f&&(this.subtle=f.subtle||f.webkitSubtle)}catch{}this.subtle===null&&(this.config.enableSoftwareAES=!0)}var v=T.prototype;return v.destroy=function(){this.observer=null},v.isSync=function(){return this.config.enableSoftwareAES},v.flush=function(){var d=this.currentResult;if(d){var L=new Uint8Array(d);return this.reset(),this.removePKCS7Padding?Object(s.removePadding)(L):L}this.reset()},v.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},v.decrypt=function(d,L,R,E){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(d),L,R);var o=this.flush();o&&E(o.buffer)}else this.webCryptoDecrypt(new Uint8Array(d),L,R).then(E)},v.softwareDecrypt=function(d,L,R){var E=this.currentIV,o=this.currentResult,f=this.remainderData;this.logOnce("JS AES decrypt"),f&&(d=Object(A.appendUint8Array)(f,d),this.remainderData=null);var l=this.getValidChunk(d);if(!l.length)return null;E&&(R=E);var g=this.softwareDecrypter;g||(g=this.softwareDecrypter=new s.default),g.expandKey(L);var m=o;return this.currentResult=g.decrypt(l.buffer,0,R),this.currentIV=Object(y.sliceUint8)(l,-16).buffer,m||null},v.webCryptoDecrypt=function(d,L,R){var E=this,o=this.subtle;return this.key===L&&this.fastAesKey||(this.key=L,this.fastAesKey=new n.default(o,L)),this.fastAesKey.expandKey().then(function(f){return o?new i.default(o,R).decrypt(d.buffer,f):Promise.reject(new Error("web crypto not initialized"))}).catch(function(f){return E.onWebCryptoError(f,d,L,R)})},v.onWebCryptoError=function(d,L,R,E){return u.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",d),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(L,R,E)},v.getValidChunk=function(d){var L=d,R=d.length-d.length%16;return R!==d.length&&(L=Object(y.sliceUint8)(d,0,R),this.remainderData=Object(y.sliceUint8)(d,R)),L},v.logOnce=function(d){this.logEnabled&&(u.logger.log("[decrypter.ts]: "+d),this.logEnabled=!1)},T}()},"./src/crypt/fast-aes-key.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return i});var i=function(){function n(s,u){this.subtle=void 0,this.key=void 0,this.subtle=s,this.key=u}return n.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},n}()},"./src/demux/aacdemuxer.ts":function(e,t,r){r.r(t);var i=r("./src/demux/base-audio-demuxer.ts"),n=r("./src/demux/adts.ts"),s=r("./src/utils/logger.ts"),u=r("./src/demux/id3.ts");function A(a,T){return(A=Object.setPrototypeOf||function(v,d){return v.__proto__=d,v})(a,T)}var y=function(a){var T,v;function d(R,E){var o;return(o=a.call(this)||this).observer=void 0,o.config=void 0,o.observer=R,o.config=E,o}v=a,(T=d).prototype=Object.create(v.prototype),T.prototype.constructor=T,A(T,v);var L=d.prototype;return L.resetInitSegment=function(R,E,o){a.prototype.resetInitSegment.call(this,R,E,o),this._audioTrack={container:"audio/adts",type:"audio",id:0,pid:-1,sequenceNumber:0,isAAC:!0,samples:[],manifestCodec:R,duration:o,inputTimeScale:9e4,dropped:0}},d.probe=function(R){if(!R)return!1;for(var E=(u.getID3Data(R,0)||[]).length,o=R.length;E<o;E++)if(n.probe(R,E))return s.logger.log("ADTS sync word found !"),!0;return!1},L.canParse=function(R,E){return n.canParse(R,E)},L.appendFrame=function(R,E,o){n.initTrackConfig(R,this.observer,E,o,R.manifestCodec);var f=n.appendFrame(R,E,o,this.initPTS,this.frameIndex);if(f&&f.missing===0)return f},d}(i.default);y.minProbeByteLength=9,t.default=y},"./src/demux/adts.ts":function(e,t,r){r.r(t),r.d(t,"getAudioConfig",function(){return u}),r.d(t,"isHeaderPattern",function(){return A}),r.d(t,"getHeaderLength",function(){return y}),r.d(t,"getFullFrameLength",function(){return a}),r.d(t,"canGetFrameLength",function(){return T}),r.d(t,"isHeader",function(){return v}),r.d(t,"canParse",function(){return d}),r.d(t,"probe",function(){return L}),r.d(t,"initTrackConfig",function(){return R}),r.d(t,"getFrameDuration",function(){return E}),r.d(t,"parseFrameHeader",function(){return o}),r.d(t,"appendFrame",function(){return f});var i=r("./src/utils/logger.ts"),n=r("./src/errors.ts"),s=r("./src/events.ts");function u(l,g,m,h){var b,k,_,D,c=navigator.userAgent.toLowerCase(),p=h,S=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];b=1+((192&g[m+2])>>>6);var C=(60&g[m+2])>>>2;if(!(C>S.length-1))return _=(1&g[m+2])<<2,_|=(192&g[m+3])>>>6,i.logger.log("manifest codec:"+h+", ADTS type:"+b+", samplingIndex:"+C),/firefox/i.test(c)?C>=6?(b=5,D=new Array(4),k=C-3):(b=2,D=new Array(2),k=C):c.indexOf("android")!==-1?(b=2,D=new Array(2),k=C):(b=5,D=new Array(4),h&&(h.indexOf("mp4a.40.29")!==-1||h.indexOf("mp4a.40.5")!==-1)||!h&&C>=6?k=C-3:((h&&h.indexOf("mp4a.40.2")!==-1&&(C>=6&&_===1||/vivaldi/i.test(c))||!h&&_===1)&&(b=2,D=new Array(2)),k=C)),D[0]=b<<3,D[0]|=(14&C)>>1,D[1]|=(1&C)<<7,D[1]|=_<<3,b===5&&(D[1]|=(14&k)>>1,D[2]=(1&k)<<7,D[2]|=8,D[3]=0),{config:D,samplerate:S[C],channelCount:_,codec:"mp4a.40."+b,manifestCodec:p};l.trigger(s.Events.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+C})}function A(l,g){return l[g]===255&&(246&l[g+1])==240}function y(l,g){return 1&l[g+1]?7:9}function a(l,g){return(3&l[g+3])<<11|l[g+4]<<3|(224&l[g+5])>>>5}function T(l,g){return g+5<l.length}function v(l,g){return g+1<l.length&&A(l,g)}function d(l,g){return T(l,g)&&A(l,g)&&a(l,g)<=l.length-g}function L(l,g){if(v(l,g)){var m=y(l,g);if(g+m>=l.length)return!1;var h=a(l,g);if(h<=m)return!1;var b=g+h;return b===l.length||v(l,b)}return!1}function R(l,g,m,h,b){if(!l.samplerate){var k=u(g,m,h,b);if(!k)return;l.config=k.config,l.samplerate=k.samplerate,l.channelCount=k.channelCount,l.codec=k.codec,l.manifestCodec=k.manifestCodec,i.logger.log("parsed codec:"+l.codec+", rate:"+k.samplerate+", channels:"+k.channelCount)}}function E(l){return 9216e4/l}function o(l,g,m,h,b){var k=y(l,g),_=a(l,g);if((_-=k)>0)return{headerLength:k,frameLength:_,stamp:m+h*b}}function f(l,g,m,h,b){var k=o(g,m,h,b,E(l.samplerate));if(k){var _,D=k.frameLength,c=k.headerLength,p=k.stamp,S=c+D,C=Math.max(0,m+S-g.length);C?(_=new Uint8Array(S-c)).set(g.subarray(m+c,g.length),0):_=g.subarray(m+c,m+S);var I={unit:_,pts:p};return C||l.samples.push(I),{sample:I,length:S,missing:C}}}},"./src/demux/base-audio-demuxer.ts":function(e,t,r){r.r(t),r.d(t,"initPTSFn",function(){return a});var i=r("./src/polyfills/number.ts"),n=r("./src/demux/id3.ts"),s=r("./src/demux/dummy-demuxed-track.ts"),u=r("./src/utils/mp4-tools.ts"),A=r("./src/utils/typed-array.ts"),y=function(){function T(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.initPTS=null}var v=T.prototype;return v.resetInitSegment=function(d,L,R){this._id3Track={type:"id3",id:0,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},v.resetTimeStamp=function(){},v.resetContiguity=function(){},v.canParse=function(d,L){return!1},v.appendFrame=function(d,L,R){},v.demux=function(d,L){this.cachedData&&(d=Object(u.appendUint8Array)(this.cachedData,d),this.cachedData=null);var R,E,o=n.getID3Data(d,0),f=o?o.length:0,l=this._audioTrack,g=this._id3Track,m=o?n.getTimeStamp(o):void 0,h=d.length;for(this.frameIndex!==0&&this.initPTS!==null||(this.initPTS=a(m,L)),o&&o.length>0&&g.samples.push({pts:this.initPTS,dts:this.initPTS,data:o}),E=this.initPTS;f<h;){if(this.canParse(d,f)){var b=this.appendFrame(l,d,f);b?(this.frameIndex++,E=b.sample.pts,R=f+=b.length):f=h}else n.canParse(d,f)?(o=n.getID3Data(d,f),g.samples.push({pts:E,dts:E,data:o}),R=f+=o.length):f++;if(f===h&&R!==h){var k=Object(A.sliceUint8)(d,R);this.cachedData?this.cachedData=Object(u.appendUint8Array)(this.cachedData,k):this.cachedData=k}}return{audioTrack:l,avcTrack:Object(s.dummyTrack)(),id3Track:g,textTrack:Object(s.dummyTrack)()}},v.demuxSampleAes=function(d,L,R){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},v.flush=function(d){var L=this.cachedData;return L&&(this.cachedData=null,this.demux(L,0)),this.frameIndex=0,{audioTrack:this._audioTrack,avcTrack:Object(s.dummyTrack)(),id3Track:this._id3Track,textTrack:Object(s.dummyTrack)()}},v.destroy=function(){},T}(),a=function(T,v){return Object(i.isFiniteNumber)(T)?90*T:9e4*v};t.default=y},"./src/demux/chunk-cache.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return i});var i=function(){function n(){this.chunks=[],this.dataLength=0}var s=n.prototype;return s.push=function(u){this.chunks.push(u),this.dataLength+=u.length},s.flush=function(){var u,A=this.chunks,y=this.dataLength;return A.length?(u=A.length===1?A[0]:function(a,T){for(var v=new Uint8Array(T),d=0,L=0;L<a.length;L++){var R=a[L];v.set(R,d),d+=R.length}return v}(A,y),this.reset(),u):new Uint8Array(0)},s.reset=function(){this.chunks.length=0,this.dataLength=0},n}()},"./src/demux/dummy-demuxed-track.ts":function(e,t,r){function i(){return{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}r.r(t),r.d(t,"dummyTrack",function(){return i})},"./src/demux/exp-golomb.ts":function(e,t,r){r.r(t);var i=r("./src/utils/logger.ts"),n=function(){function s(A){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=A,this.bytesAvailable=A.byteLength,this.word=0,this.bitsAvailable=0}var u=s.prototype;return u.loadWord=function(){var A=this.data,y=this.bytesAvailable,a=A.byteLength-y,T=new Uint8Array(4),v=Math.min(4,y);if(v===0)throw new Error("no bytes available");T.set(A.subarray(a,a+v)),this.word=new DataView(T.buffer).getUint32(0),this.bitsAvailable=8*v,this.bytesAvailable-=v},u.skipBits=function(A){var y;this.bitsAvailable>A?(this.word<<=A,this.bitsAvailable-=A):(A-=this.bitsAvailable,A-=(y=A>>3)>>3,this.bytesAvailable-=y,this.loadWord(),this.word<<=A,this.bitsAvailable-=A)},u.readBits=function(A){var y=Math.min(this.bitsAvailable,A),a=this.word>>>32-y;return A>32&&i.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=y,this.bitsAvailable>0?this.word<<=y:this.bytesAvailable>0&&this.loadWord(),(y=A-y)>0&&this.bitsAvailable?a<<y|this.readBits(y):a},u.skipLZ=function(){var A;for(A=0;A<this.bitsAvailable;++A)if((this.word&2147483648>>>A)!=0)return this.word<<=A,this.bitsAvailable-=A,A;return this.loadWord(),A+this.skipLZ()},u.skipUEG=function(){this.skipBits(1+this.skipLZ())},u.skipEG=function(){this.skipBits(1+this.skipLZ())},u.readUEG=function(){var A=this.skipLZ();return this.readBits(A+1)-1},u.readEG=function(){var A=this.readUEG();return 1&A?1+A>>>1:-1*(A>>>1)},u.readBoolean=function(){return this.readBits(1)===1},u.readUByte=function(){return this.readBits(8)},u.readUShort=function(){return this.readBits(16)},u.readUInt=function(){return this.readBits(32)},u.skipScalingList=function(A){for(var y=8,a=8,T=0;T<A;T++)a!==0&&(a=(y+this.readEG()+256)%256),y=a===0?y:a},u.readSPS=function(){var A,y,a,T=0,v=0,d=0,L=0,R=this.readUByte.bind(this),E=this.readBits.bind(this),o=this.readUEG.bind(this),f=this.readBoolean.bind(this),l=this.skipBits.bind(this),g=this.skipEG.bind(this),m=this.skipUEG.bind(this),h=this.skipScalingList.bind(this);R();var b=R();if(E(5),l(3),R(),m(),b===100||b===110||b===122||b===244||b===44||b===83||b===86||b===118||b===128){var k=o();if(k===3&&l(1),m(),m(),l(1),f())for(y=k!==3?8:12,a=0;a<y;a++)f()&&h(a<6?16:64)}m();var _=o();if(_===0)o();else if(_===1)for(l(1),g(),g(),A=o(),a=0;a<A;a++)g();m(),l(1);var D=o(),c=o(),p=E(1);p===0&&l(1),l(1),f()&&(T=o(),v=o(),d=o(),L=o());var S=[1,1];if(f()&&f())switch(R()){case 1:S=[1,1];break;case 2:S=[12,11];break;case 3:S=[10,11];break;case 4:S=[16,11];break;case 5:S=[40,33];break;case 6:S=[24,11];break;case 7:S=[20,11];break;case 8:S=[32,11];break;case 9:S=[80,33];break;case 10:S=[18,11];break;case 11:S=[15,11];break;case 12:S=[64,33];break;case 13:S=[160,99];break;case 14:S=[4,3];break;case 15:S=[3,2];break;case 16:S=[2,1];break;case 255:S=[R()<<8|R(),R()<<8|R()]}return{width:Math.ceil(16*(D+1)-2*T-2*v),height:(2-p)*(c+1)*16-(p?2:4)*(d+L),pixelRatio:S}},u.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},s}();t.default=n},"./src/demux/id3.ts":function(e,t,r){r.r(t),r.d(t,"isHeader",function(){return n}),r.d(t,"isFooter",function(){return s}),r.d(t,"getID3Data",function(){return u}),r.d(t,"canParse",function(){return y}),r.d(t,"getTimeStamp",function(){return a}),r.d(t,"isTimeStampFrame",function(){return T}),r.d(t,"getID3Frames",function(){return d}),r.d(t,"decodeFrame",function(){return L}),r.d(t,"utf8ArrayToStr",function(){return l}),r.d(t,"testables",function(){return g});var i,n=function(m,h){return h+10<=m.length&&m[h]===73&&m[h+1]===68&&m[h+2]===51&&m[h+3]<255&&m[h+4]<255&&m[h+6]<128&&m[h+7]<128&&m[h+8]<128&&m[h+9]<128},s=function(m,h){return h+10<=m.length&&m[h]===51&&m[h+1]===68&&m[h+2]===73&&m[h+3]<255&&m[h+4]<255&&m[h+6]<128&&m[h+7]<128&&m[h+8]<128&&m[h+9]<128},u=function(m,h){for(var b=h,k=0;n(m,h);)k+=10,k+=A(m,h+6),s(m,h+10)&&(k+=10),h+=k;if(k>0)return m.subarray(b,b+k)},A=function(m,h){var b=0;return b=(127&m[h])<<21,b|=(127&m[h+1])<<14,b|=(127&m[h+2])<<7,b|=127&m[h+3]},y=function(m,h){return n(m,h)&&A(m,h+6)+10<=m.length-h},a=function(m){for(var h=d(m),b=0;b<h.length;b++){var k=h[b];if(T(k))return f(k)}},T=function(m){return m&&m.key==="PRIV"&&m.info==="com.apple.streaming.transportStreamTimestamp"},v=function(m){var h=String.fromCharCode(m[0],m[1],m[2],m[3]),b=A(m,4);return{type:h,size:b,data:m.subarray(10,10+b)}},d=function(m){for(var h=0,b=[];n(m,h);){for(var k=A(m,h+6),_=(h+=10)+k;h+8<_;){var D=v(m.subarray(h)),c=L(D);c&&b.push(c),h+=D.size+10}s(m,h)&&(h+=10)}return b},L=function(m){return m.type==="PRIV"?R(m):m.type[0]==="W"?o(m):E(m)},R=function(m){if(!(m.size<2)){var h=l(m.data,!0),b=new Uint8Array(m.data.subarray(h.length+1));return{key:m.type,info:h,data:b.buffer}}},E=function(m){if(!(m.size<2)){if(m.type==="TXXX"){var h=1,b=l(m.data.subarray(h),!0);h+=b.length+1;var k=l(m.data.subarray(h));return{key:m.type,info:b,data:k}}var _=l(m.data.subarray(1));return{key:m.type,data:_}}},o=function(m){if(m.type==="WXXX"){if(m.size<2)return;var h=1,b=l(m.data.subarray(h),!0);h+=b.length+1;var k=l(m.data.subarray(h));return{key:m.type,info:b,data:k}}var _=l(m.data);return{key:m.type,data:_}},f=function(m){if(m.data.byteLength===8){var h=new Uint8Array(m.data),b=1&h[3],k=(h[4]<<23)+(h[5]<<15)+(h[6]<<7)+h[7];return k/=45,b&&(k+=4772185884e-2),Math.round(k)}},l=function(m,h){h===void 0&&(h=!1);var b=(i||self.TextDecoder===void 0||(i=new self.TextDecoder("utf-8")),i);if(b){var k=b.decode(m);if(h){var _=k.indexOf("\0");return _!==-1?k.substring(0,_):k}return k.replace(/\0/g,"")}for(var D,c,p,S=m.length,C="",I=0;I<S;){if((D=m[I++])===0&&h)return C;if(D!==0&&D!==3)switch(D>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:C+=String.fromCharCode(D);break;case 12:case 13:c=m[I++],C+=String.fromCharCode((31&D)<<6|63&c);break;case 14:c=m[I++],p=m[I++],C+=String.fromCharCode((15&D)<<12|(63&c)<<6|(63&p)<<0)}}return C},g={decodeTextFrame:E}},"./src/demux/mp3demuxer.ts":function(e,t,r){r.r(t);var i=r("./src/demux/base-audio-demuxer.ts"),n=r("./src/demux/id3.ts"),s=r("./src/utils/logger.ts"),u=r("./src/demux/mpegaudio.ts");function A(a,T){return(A=Object.setPrototypeOf||function(v,d){return v.__proto__=d,v})(a,T)}var y=function(a){var T,v;function d(){return a.apply(this,arguments)||this}v=a,(T=d).prototype=Object.create(v.prototype),T.prototype.constructor=T,A(T,v);var L=d.prototype;return L.resetInitSegment=function(R,E,o){a.prototype.resetInitSegment.call(this,R,E,o),this._audioTrack={container:"audio/mpeg",type:"audio",id:0,pid:-1,sequenceNumber:0,isAAC:!1,samples:[],manifestCodec:R,duration:o,inputTimeScale:9e4,dropped:0}},d.probe=function(R){if(!R)return!1;for(var E=(n.getID3Data(R,0)||[]).length,o=R.length;E<o;E++)if(u.probe(R,E))return s.logger.log("MPEG Audio sync word found !"),!0;return!1},L.canParse=function(R,E){return u.canParse(R,E)},L.appendFrame=function(R,E,o){if(this.initPTS!==null)return u.appendFrame(R,E,o,this.initPTS,this.frameIndex)},d}(i.default);y.minProbeByteLength=4,t.default=y},"./src/demux/mp4demuxer.ts":function(e,t,r){r.r(t);var i=r("./src/utils/mp4-tools.ts"),n=r("./src/demux/dummy-demuxed-track.ts"),s=function(){function u(y,a){this.remainderData=null,this.config=void 0,this.config=a}var A=u.prototype;return A.resetTimeStamp=function(){},A.resetInitSegment=function(){},A.resetContiguity=function(){},u.probe=function(y){return Object(i.findBox)({data:y,start:0,end:Math.min(y.length,16384)},["moof"]).length>0},A.demux=function(y){var a=y,T=Object(n.dummyTrack)();if(this.config.progressive){this.remainderData&&(a=Object(i.appendUint8Array)(this.remainderData,y));var v=Object(i.segmentValidRange)(a);this.remainderData=v.remainder,T.samples=v.valid||new Uint8Array}else T.samples=a;return{audioTrack:Object(n.dummyTrack)(),avcTrack:T,id3Track:Object(n.dummyTrack)(),textTrack:Object(n.dummyTrack)()}},A.flush=function(){var y=Object(n.dummyTrack)();return y.samples=this.remainderData||new Uint8Array,this.remainderData=null,{audioTrack:Object(n.dummyTrack)(),avcTrack:y,id3Track:Object(n.dummyTrack)(),textTrack:Object(n.dummyTrack)()}},A.demuxSampleAes=function(y,a,T){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},A.destroy=function(){},u}();s.minProbeByteLength=1024,t.default=s},"./src/demux/mpegaudio.ts":function(e,t,r){r.r(t),r.d(t,"appendFrame",function(){return y}),r.d(t,"parseHeader",function(){return a}),r.d(t,"isHeaderPattern",function(){return T}),r.d(t,"isHeader",function(){return v}),r.d(t,"canParse",function(){return d}),r.d(t,"probe",function(){return L});var i=null,n=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],s=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],u=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],A=[0,1,1,4];function y(R,E,o,f,l){if(!(o+24>E.length)){var g=a(E,o);if(g&&o+g.frameLength<=E.length){var m=f+l*(9e4*g.samplesPerFrame/g.sampleRate),h={unit:E.subarray(o,o+g.frameLength),pts:m,dts:m};return R.config=[],R.channelCount=g.channelCount,R.samplerate=g.sampleRate,R.samples.push(h),{sample:h,length:g.frameLength,missing:0}}}}function a(R,E){var o=R[E+1]>>3&3,f=R[E+1]>>1&3,l=R[E+2]>>4&15,g=R[E+2]>>2&3;if(o!==1&&l!==0&&l!==15&&g!==3){var m=R[E+2]>>1&1,h=R[E+3]>>6,b=1e3*n[14*(o===3?3-f:f===3?3:4)+l-1],k=s[3*(o===3?0:o===2?1:2)+g],_=h===3?1:2,D=u[o][f],c=A[f],p=8*D*c,S=Math.floor(D*b/k+m)*c;if(i===null){var C=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);i=C?parseInt(C[1]):0}return!!i&&i<=87&&f===2&&b>=224e3&&h===0&&(R[E+3]=128|R[E+3]),{sampleRate:k,channelCount:_,frameLength:S,samplesPerFrame:p}}}function T(R,E){return R[E]===255&&(224&R[E+1])==224&&(6&R[E+1])!=0}function v(R,E){return E+1<R.length&&T(R,E)}function d(R,E){return T(R,E)&&4<=R.length-E}function L(R,E){if(E+1<R.length&&T(R,E)){var o=a(R,E),f=4;o!=null&&o.frameLength&&(f=o.frameLength);var l=E+f;return l===R.length||v(R,l)}return!1}},"./src/demux/sample-aes.ts":function(e,t,r){r.r(t);var i=r("./src/crypt/decrypter.ts"),n=r("./src/demux/tsdemuxer.ts"),s=function(){function u(y,a,T){this.keyData=void 0,this.decrypter=void 0,this.keyData=T,this.decrypter=new i.default(y,a,{removePKCS7Padding:!1})}var A=u.prototype;return A.decryptBuffer=function(y,a){this.decrypter.decrypt(y,this.keyData.key.buffer,this.keyData.iv.buffer,a)},A.decryptAacSample=function(y,a,T,v){var d=y[a].unit,L=d.subarray(16,d.length-d.length%16),R=L.buffer.slice(L.byteOffset,L.byteOffset+L.length),E=this;this.decryptBuffer(R,function(o){var f=new Uint8Array(o);d.set(f,16),v||E.decryptAacSamples(y,a+1,T)})},A.decryptAacSamples=function(y,a,T){for(;;a++){if(a>=y.length)return void T();if(!(y[a].unit.length<32)){var v=this.decrypter.isSync();if(this.decryptAacSample(y,a,T,v),!v)return}}},A.getAvcEncryptedData=function(y){for(var a=16*Math.floor((y.length-48)/160)+16,T=new Int8Array(a),v=0,d=32;d<=y.length-16;d+=160,v+=16)T.set(y.subarray(d,d+16),v);return T},A.getAvcDecryptedUnit=function(y,a){for(var T=new Uint8Array(a),v=0,d=32;d<=y.length-16;d+=160,v+=16)y.set(T.subarray(v,v+16),d);return y},A.decryptAvcSample=function(y,a,T,v,d,L){var R=Object(n.discardEPB)(d.data),E=this.getAvcEncryptedData(R),o=this;this.decryptBuffer(E.buffer,function(f){d.data=o.getAvcDecryptedUnit(R,f),L||o.decryptAvcSamples(y,a,T+1,v)})},A.decryptAvcSamples=function(y,a,T,v){if(y instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;a++,T=0){if(a>=y.length)return void v();for(var d=y[a].units;!(T>=d.length);T++){var L=d[T];if(!(L.data.length<=48||L.type!==1&&L.type!==5)){var R=this.decrypter.isSync();if(this.decryptAvcSample(y,a,T,v,L,R),!R)return}}}},u}();t.default=s},"./src/demux/transmuxer-interface.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return v});var i=r("./node_modules/webworkify-webpack/index.js"),n=r("./src/events.ts"),s=r("./src/demux/transmuxer.ts"),u=r("./src/utils/logger.ts"),A=r("./src/errors.ts"),y=r("./src/utils/mediasource-helper.ts"),a=r("./node_modules/eventemitter3/index.js"),T=Object(y.getMediaSource)()||{isTypeSupported:function(){return!1}},v=function(){function d(R,E,o,f){var l=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.hls=R,this.id=E,this.onTransmuxComplete=o,this.onFlush=f;var g=R.config,m=function(_,D){(D=D||{}).frag=l.frag,D.id=l.id,R.trigger(_,D)};this.observer=new a.EventEmitter,this.observer.on(n.Events.FRAG_DECRYPTED,m),this.observer.on(n.Events.ERROR,m);var h={mp4:T.isTypeSupported("video/mp4"),mpeg:T.isTypeSupported("audio/mpeg"),mp3:T.isTypeSupported('audio/mp4; codecs="mp3"')},b=navigator.vendor;if(g.enableWorker&&typeof Worker<"u"){var k;u.logger.log("demuxing in webworker");try{k=this.worker=i("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),k.addEventListener("message",this.onwmsg),k.onerror=function(_){R.trigger(n.Events.ERROR,{type:A.ErrorTypes.OTHER_ERROR,details:A.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",error:new Error(_.message+"  ("+_.filename+":"+_.lineno+")")})},k.postMessage({cmd:"init",typeSupported:h,vendor:b,id:E,config:JSON.stringify(g)})}catch(_){u.logger.warn("Error in worker:",_),u.logger.error("Error while initializing DemuxerWorker, fallback to inline"),k&&self.URL.revokeObjectURL(k.objectURL),this.transmuxer=new s.default(this.observer,h,g,b,E),this.worker=null}}else this.transmuxer=new s.default(this.observer,h,g,b,E)}var L=d.prototype;return L.destroy=function(){var R=this.worker;if(R)R.removeEventListener("message",this.onwmsg),R.terminate(),this.worker=null;else{var E=this.transmuxer;E&&(E.destroy(),this.transmuxer=null)}var o=this.observer;o&&o.removeAllListeners(),this.observer=null},L.push=function(R,E,o,f,l,g,m,h,b,k){var _=this;b.transmuxing.start=self.performance.now();var D=this.transmuxer,c=this.worker,p=g?g.start:l.start,S=l.decryptdata,C=this.frag,I=!(C&&l.cc===C.cc),w=!(C&&b.level===C.level),O=C?b.sn-C.sn:-1,x=this.part?b.part-this.part.index:1,P=!w&&(O===1||O===0&&x===1),F=self.performance.now();(w||O||l.stats.parsing.start===0)&&(l.stats.parsing.start=F),!g||!x&&P||(g.stats.parsing.start=F);var N=new s.TransmuxState(I,P,h,w,p);if(!P||I){u.logger.log("[transmuxer-interface, "+l.type+"]: Starting new transmux session for sn: "+b.sn+" p: "+b.part+" level: "+b.level+" id: "+b.id+`
        discontinuity: `+I+`
        trackSwitch: `+w+`
        contiguous: `+P+`
        accurateTimeOffset: `+h+`
        timeOffset: `+p);var U=new s.TransmuxConfig(o,f,E,m,k);this.configureTransmuxer(U)}if(this.frag=l,this.part=g,c)c.postMessage({cmd:"demux",data:R,decryptdata:S,chunkMeta:b,state:N},R instanceof ArrayBuffer?[R]:[]);else if(D){var j=D.push(R,S,b,N);Object(s.isPromise)(j)?j.then(function(V){_.handleTransmuxComplete(V)}):this.handleTransmuxComplete(j)}},L.flush=function(R){var E=this;R.transmuxing.start=self.performance.now();var o=this.transmuxer,f=this.worker;if(f)f.postMessage({cmd:"flush",chunkMeta:R});else if(o){var l=o.flush(R);Object(s.isPromise)(l)?l.then(function(g){E.handleFlushResult(g,R)}):this.handleFlushResult(l,R)}},L.handleFlushResult=function(R,E){var o=this;R.forEach(function(f){o.handleTransmuxComplete(f)}),this.onFlush(E)},L.onWorkerMessage=function(R){var E=R.data,o=this.hls;switch(E.event){case"init":self.URL.revokeObjectURL(this.worker.objectURL);break;case"transmuxComplete":this.handleTransmuxComplete(E.data);break;case"flush":this.onFlush(E.data);break;default:E.data=E.data||{},E.data.frag=this.frag,E.data.id=this.id,o.trigger(E.event,E.data)}},L.configureTransmuxer=function(R){var E=this.worker,o=this.transmuxer;E?E.postMessage({cmd:"configure",config:R}):o&&o.configure(R)},L.handleTransmuxComplete=function(R){R.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(R)},d}()},"./src/demux/transmuxer-worker.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return A});var i=r("./src/demux/transmuxer.ts"),n=r("./src/events.ts"),s=r("./src/utils/logger.ts"),u=r("./node_modules/eventemitter3/index.js");function A(v){var d=new u.EventEmitter,L=function(R,E){v.postMessage({event:R,data:E})};d.on(n.Events.FRAG_DECRYPTED,L),d.on(n.Events.ERROR,L),v.addEventListener("message",function(R){var E=R.data;switch(E.cmd){case"init":var o=JSON.parse(E.config);v.transmuxer=new i.default(d,E.typeSupported,o,E.vendor,E.id),Object(s.enableLogs)(o.debug),L("init",null);break;case"configure":v.transmuxer.configure(E.config);break;case"demux":var f=v.transmuxer.push(E.data,E.decryptdata,E.chunkMeta,E.state);Object(i.isPromise)(f)?f.then(function(m){y(v,m)}):y(v,f);break;case"flush":var l=E.chunkMeta,g=v.transmuxer.flush(l);Object(i.isPromise)(g)?g.then(function(m){T(v,m,l)}):T(v,g,l)}})}function y(v,d){if((L=d.remuxResult).audio||L.video||L.text||L.id3||L.initSegment){var L,R=[],E=d.remuxResult,o=E.audio,f=E.video;o&&a(R,o),f&&a(R,f),v.postMessage({event:"transmuxComplete",data:d},R)}}function a(v,d){d.data1&&v.push(d.data1.buffer),d.data2&&v.push(d.data2.buffer)}function T(v,d,L){d.forEach(function(R){y(v,R)}),v.postMessage({event:"flush",data:L})}},"./src/demux/transmuxer.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return l}),r.d(t,"isPromise",function(){return m}),r.d(t,"TransmuxConfig",function(){return h}),r.d(t,"TransmuxState",function(){return b});var i,n=r("./src/events.ts"),s=r("./src/errors.ts"),u=r("./src/crypt/decrypter.ts"),A=r("./src/demux/aacdemuxer.ts"),y=r("./src/demux/mp4demuxer.ts"),a=r("./src/demux/tsdemuxer.ts"),T=r("./src/demux/mp3demuxer.ts"),v=r("./src/remux/mp4-remuxer.ts"),d=r("./src/remux/passthrough-remuxer.ts"),L=r("./src/demux/chunk-cache.ts"),R=r("./src/utils/mp4-tools.ts"),E=r("./src/utils/logger.ts");try{i=self.performance.now.bind(self.performance)}catch{E.logger.debug("Unable to use Performance API on this environment"),i=self.Date.now}var o=[{demux:a.default,remux:v.default},{demux:y.default,remux:d.default},{demux:A.default,remux:v.default},{demux:T.default,remux:v.default}],f=1024;o.forEach(function(k){var _=k.demux;f=Math.max(f,_.minProbeByteLength)});var l=function(){function k(D,c,p,S,C){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.cache=new L.default,this.observer=D,this.typeSupported=c,this.config=p,this.vendor=S,this.id=C}var _=k.prototype;return _.configure=function(D){this.transmuxConfig=D,this.decrypter&&this.decrypter.reset()},_.push=function(D,c,p,S){var C=this,I=p.transmuxing;I.executeStart=i();var w=new Uint8Array(D),O=this.cache,x=this.config,P=this.currentTransmuxState,F=this.transmuxConfig;S&&(this.currentTransmuxState=S);var N=function(Q,J){var Z=null;return Q.byteLength>0&&J!=null&&J.key!=null&&J.iv!==null&&J.method!=null&&(Z=J),Z}(w,c);if(N&&N.method==="AES-128"){var U=this.getDecrypter();if(!x.enableSoftwareAES)return this.decryptionPromise=U.webCryptoDecrypt(w,N.key.buffer,N.iv.buffer).then(function(Q){var J=C.push(Q,null,p);return C.decryptionPromise=null,J}),this.decryptionPromise;var j=U.softwareDecrypt(w,N.key.buffer,N.iv.buffer);if(!j)return I.executeEnd=i(),g(p);w=new Uint8Array(j)}var V=S||P,z=V.contiguous,G=V.discontinuity,W=V.trackSwitch,$=V.accurateTimeOffset,Y=V.timeOffset,re=F.audioCodec,ue=F.videoCodec,oe=F.defaultInitPts,M=F.duration,B=F.initSegmentData;if((G||W)&&this.resetInitSegment(B,re,ue,M),G&&this.resetInitialTimestamp(oe),z||this.resetContiguity(),this.needsProbing(w,G,W)){if(O.dataLength){var K=O.flush();w=Object(R.appendUint8Array)(K,w)}this.configureTransmuxer(w,F)}var H=this.transmux(w,N,Y,$,p),q=this.currentTransmuxState;return q.contiguous=!0,q.discontinuity=!1,q.trackSwitch=!1,I.executeEnd=i(),H},_.flush=function(D){var c=this,p=D.transmuxing;p.executeStart=i();var S=this.decrypter,C=this.cache,I=this.currentTransmuxState,w=this.decryptionPromise;if(w)return w.then(function(){return c.flush(D)});var O=[],x=I.timeOffset;if(S){var P=S.flush();P&&O.push(this.push(P,null,D))}var F=C.dataLength;C.reset();var N=this.demuxer,U=this.remuxer;if(!N||!U)return F>=f&&this.observer.emit(n.Events.ERROR,n.Events.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),p.executeEnd=i(),[g(D)];var j=N.flush(x);return m(j)?j.then(function(V){return c.flushRemux(O,V,D),O}):(this.flushRemux(O,j,D),O)},_.flushRemux=function(D,c,p){var S=c.audioTrack,C=c.avcTrack,I=c.id3Track,w=c.textTrack,O=this.currentTransmuxState,x=O.accurateTimeOffset,P=O.timeOffset;E.logger.log("[transmuxer.ts]: Flushed fragment "+p.sn+(p.part>-1?" p: "+p.part:"")+" of level "+p.level);var F=this.remuxer.remux(S,C,I,w,P,x,!0,this.id);D.push({remuxResult:F,chunkMeta:p}),p.transmuxing.executeEnd=i()},_.resetInitialTimestamp=function(D){var c=this.demuxer,p=this.remuxer;c&&p&&(c.resetTimeStamp(D),p.resetTimeStamp(D))},_.resetContiguity=function(){var D=this.demuxer,c=this.remuxer;D&&c&&(D.resetContiguity(),c.resetNextTimestamp())},_.resetInitSegment=function(D,c,p,S){var C=this.demuxer,I=this.remuxer;C&&I&&(C.resetInitSegment(c,p,S),I.resetInitSegment(D,c,p))},_.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},_.transmux=function(D,c,p,S,C){return c&&c.method==="SAMPLE-AES"?this.transmuxSampleAes(D,c,p,S,C):this.transmuxUnencrypted(D,p,S,C)},_.transmuxUnencrypted=function(D,c,p,S){var C=this.demuxer.demux(D,c,!1,!this.config.progressive),I=C.audioTrack,w=C.avcTrack,O=C.id3Track,x=C.textTrack;return{remuxResult:this.remuxer.remux(I,w,O,x,c,p,!1,this.id),chunkMeta:S}},_.transmuxSampleAes=function(D,c,p,S,C){var I=this;return this.demuxer.demuxSampleAes(D,c,p).then(function(w){return{remuxResult:I.remuxer.remux(w.audioTrack,w.avcTrack,w.id3Track,w.textTrack,p,S,!1,I.id),chunkMeta:C}})},_.configureTransmuxer=function(D,c){for(var p,S=this.config,C=this.observer,I=this.typeSupported,w=this.vendor,O=c.audioCodec,x=c.defaultInitPts,P=c.duration,F=c.initSegmentData,N=c.videoCodec,U=0,j=o.length;U<j;U++)if(o[U].demux.probe(D)){p=o[U];break}p||(E.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),p={demux:y.default,remux:d.default});var V=this.demuxer,z=this.remuxer,G=p.remux,W=p.demux;z&&z instanceof G||(this.remuxer=new G(C,S,I,w)),V&&V instanceof W||(this.demuxer=new W(C,S,I),this.probe=W.probe),this.resetInitSegment(F,O,N,P),this.resetInitialTimestamp(x)},_.needsProbing=function(D,c,p){return!this.demuxer||!this.remuxer||c||p},_.getDecrypter=function(){var D=this.decrypter;return D||(D=this.decrypter=new u.default(this.observer,this.config)),D},k}(),g=function(k){return{remuxResult:{},chunkMeta:k}};function m(k){return"then"in k&&k.then instanceof Function}var h=function(k,_,D,c,p){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=k,this.videoCodec=_,this.initSegmentData=D,this.duration=c,this.defaultInitPts=p},b=function(k,_,D,c,p){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.discontinuity=k,this.contiguous=_,this.accurateTimeOffset=D,this.trackSwitch=c,this.timeOffset=p}},"./src/demux/tsdemuxer.ts":function(e,t,r){r.r(t),r.d(t,"discardEPB",function(){return m});var i=r("./src/demux/adts.ts"),n=r("./src/demux/mpegaudio.ts"),s=r("./src/demux/exp-golomb.ts"),u=r("./src/demux/id3.ts"),A=r("./src/demux/sample-aes.ts"),y=r("./src/events.ts"),a=r("./src/utils/mp4-tools.ts"),T=r("./src/utils/logger.ts"),v=r("./src/errors.ts"),d={video:1,audio:2,id3:3,text:4},L=function(){function h(k,_,D){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this.aacLastPTS=null,this._initPTS=null,this._initDTS=null,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=k,this.config=_,this.typeSupported=D}h.probe=function(k){var _=h.syncOffset(k);return!(_<0||(_&&T.logger.warn("MPEG2-TS detected but first sync word found @ offset "+_+", junk ahead ?"),0))},h.syncOffset=function(k){for(var _=Math.min(1e3,k.length-564),D=0;D<_;){if(k[D]===71&&k[D+188]===71&&k[D+376]===71)return D;D++}return-1},h.createTrack=function(k,_){return{container:k==="video"||k==="audio"?"video/mp2t":void 0,type:k,id:d[k],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:k==="audio"?_:void 0}};var b=h.prototype;return b.resetInitSegment=function(k,_,D){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=h.createTrack("video",D),this._audioTrack=h.createTrack("audio",D),this._id3Track=h.createTrack("id3",D),this._txtTrack=h.createTrack("text",D),this._audioTrack.isAAC=!0,this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=k,this.videoCodec=_,this._duration=D},b.resetTimeStamp=function(){},b.resetContiguity=function(){var k=this._audioTrack,_=this._avcTrack,D=this._id3Track;k&&(k.pesData=null),_&&(_.pesData=null),D&&(D.pesData=null),this.aacOverFlow=null,this.aacLastPTS=null},b.demux=function(k,_,D,c){var p;D===void 0&&(D=!1),c===void 0&&(c=!1),D||(this.sampleAes=null);var S=this._avcTrack,C=this._audioTrack,I=this._id3Track,w=S.pid,O=S.pesData,x=C.pid,P=I.pid,F=C.pesData,N=I.pesData,U=!1,j=this.pmtParsed,V=this._pmtId,z=k.length;if(this.remainderData&&(z=(k=Object(a.appendUint8Array)(this.remainderData,k)).length,this.remainderData=null),z<188&&!c)return this.remainderData=k,{audioTrack:C,avcTrack:S,id3Track:I,textTrack:this._txtTrack};var G=Math.max(0,h.syncOffset(k));(z-=(z+G)%188)<k.byteLength&&!c&&(this.remainderData=new Uint8Array(k.buffer,z,k.buffer.byteLength-z));for(var W=G;W<z;W+=188)if(k[W]===71){var $=!!(64&k[W+1]),Y=((31&k[W+1])<<8)+k[W+2],re=void 0;if((48&k[W+3])>>4>1){if((re=W+5+k[W+4])===W+188)continue}else re=W+4;switch(Y){case w:$&&(O&&(p=f(O))&&this.parseAVCPES(p,!1),O={data:[],size:0}),O&&(O.data.push(k.subarray(re,W+188)),O.size+=W+188-re);break;case x:$&&(F&&(p=f(F))&&(C.isAAC?this.parseAACPES(p):this.parseMPEGPES(p)),F={data:[],size:0}),F&&(F.data.push(k.subarray(re,W+188)),F.size+=W+188-re);break;case P:$&&(N&&(p=f(N))&&this.parseID3PES(p),N={data:[],size:0}),N&&(N.data.push(k.subarray(re,W+188)),N.size+=W+188-re);break;case 0:$&&(re+=k[re]+1),V=this._pmtId=E(k,re);break;case V:$&&(re+=k[re]+1);var ue=o(k,re,this.typeSupported.mpeg===!0||this.typeSupported.mp3===!0,D);(w=ue.avc)>0&&(S.pid=w),(x=ue.audio)>0&&(C.pid=x,C.isAAC=ue.isAAC),(P=ue.id3)>0&&(I.pid=P),U&&!j&&(T.logger.log("reparse from beginning"),U=!1,W=G-188),j=this.pmtParsed=!0;break;case 17:case 8191:break;default:U=!0}}else this.observer.emit(y.Events.ERROR,y.Events.ERROR,{type:v.ErrorTypes.MEDIA_ERROR,details:v.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});S.pesData=O,C.pesData=F,I.pesData=N;var oe={audioTrack:C,avcTrack:S,id3Track:I,textTrack:this._txtTrack};return c&&this.extractRemainingSamples(oe),oe},b.flush=function(){var k,_=this.remainderData;return this.remainderData=null,k=_?this.demux(_,-1,!1,!0):{audioTrack:this._audioTrack,avcTrack:this._avcTrack,textTrack:this._txtTrack,id3Track:this._id3Track},this.extractRemainingSamples(k),this.sampleAes?this.decrypt(k,this.sampleAes):k},b.extractRemainingSamples=function(k){var _,D=k.audioTrack,c=k.avcTrack,p=k.id3Track,S=c.pesData,C=D.pesData,I=p.pesData;S&&(_=f(S))?(this.parseAVCPES(_,!0),c.pesData=null):c.pesData=S,C&&(_=f(C))?(D.isAAC?this.parseAACPES(_):this.parseMPEGPES(_),D.pesData=null):(C!=null&&C.size&&T.logger.log("last AAC PES packet truncated,might overlap between fragments"),D.pesData=C),I&&(_=f(I))?(this.parseID3PES(_),p.pesData=null):p.pesData=I},b.demuxSampleAes=function(k,_,D){var c=this.demux(k,D,!0,!this.config.progressive),p=this.sampleAes=new A.default(this.observer,this.config,_);return this.decrypt(c,p)},b.decrypt=function(k,_){return new Promise(function(D){var c=k.audioTrack,p=k.avcTrack;c.samples&&c.isAAC?_.decryptAacSamples(c.samples,0,function(){p.samples?_.decryptAvcSamples(p.samples,0,0,function(){D(k)}):D(k)}):p.samples&&_.decryptAvcSamples(p.samples,0,0,function(){D(k)})})},b.destroy=function(){this._initPTS=this._initDTS=null,this._duration=0},b.parseAVCPES=function(k,_){var D,c=this,p=this._avcTrack,S=this.parseAVCNALu(k.data),C=this.avcSample,I=!1;k.data=null,C&&S.length&&!p.audFound&&(l(C,p),C=this.avcSample=R(!1,k.pts,k.dts,"")),S.forEach(function(w){switch(w.type){case 1:D=!0,C||(C=c.avcSample=R(!0,k.pts,k.dts,"")),C.frame=!0;var O=w.data;if(I&&O.length>4){var x=new s.default(O).readSliceType();x!==2&&x!==4&&x!==7&&x!==9||(C.key=!0)}break;case 5:D=!0,C||(C=c.avcSample=R(!0,k.pts,k.dts,"")),C.key=!0,C.frame=!0;break;case 6:D=!0;var P=new s.default(m(w.data));P.readUByte();for(var F=0,N=0,U=!1,j=0;!U&&P.bytesAvailable>1;){F=0;do F+=j=P.readUByte();while(j===255);N=0;do N+=j=P.readUByte();while(j===255);if(F===4&&P.bytesAvailable!==0){if(U=!0,P.readUByte()===181&&P.readUShort()===49&&P.readUInt()===1195456820&&P.readUByte()===3){for(var V=P.readUByte(),z=31&V,G=[V,P.readUByte()],W=0;W<z;W++)G.push(P.readUByte()),G.push(P.readUByte()),G.push(P.readUByte());g(c._txtTrack.samples,{type:3,pts:k.pts,bytes:G})}}else if(F===5&&P.bytesAvailable!==0){if(U=!0,N>16){for(var $=[],Y=0;Y<16;Y++)$.push(P.readUByte().toString(16)),Y!==3&&Y!==5&&Y!==7&&Y!==9||$.push("-");for(var re=N-16,ue=new Uint8Array(re),oe=0;oe<re;oe++)ue[oe]=P.readUByte();g(c._txtTrack.samples,{pts:k.pts,payloadType:F,uuid:$.join(""),userData:Object(u.utf8ArrayToStr)(ue),userDataBytes:ue})}}else if(N<P.bytesAvailable)for(var M=0;M<N;M++)P.readUByte()}break;case 7:if(D=!0,I=!0,!p.sps){var B=new s.default(w.data).readSPS();p.width=B.width,p.height=B.height,p.pixelRatio=B.pixelRatio,p.sps=[w.data],p.duration=c._duration;for(var K=w.data.subarray(1,4),H="avc1.",q=0;q<3;q++){var Q=K[q].toString(16);Q.length<2&&(Q="0"+Q),H+=Q}p.codec=H}break;case 8:D=!0,p.pps||(p.pps=[w.data]);break;case 9:D=!1,p.audFound=!0,C&&l(C,p),C=c.avcSample=R(!1,k.pts,k.dts,"");break;case 12:D=!1;break;default:D=!1,C&&(C.debug+="unknown NAL "+w.type+" ")}C&&D&&C.units.push(w)}),_&&C&&(l(C,p),this.avcSample=null)},b.getLastNalUnit=function(){var k,_,D=this.avcSample;if(!D||D.units.length===0){var c=this._avcTrack.samples;D=c[c.length-1]}if((k=D)!==null&&k!==void 0&&k.units){var p=D.units;_=p[p.length-1]}return _},b.parseAVCNALu=function(k){var _,D,c=k.byteLength,p=this._avcTrack,S=p.naluState||0,C=S,I=[],w=0,O=-1,x=0;for(S===-1&&(O=0,x=31&k[0],S=0,w=1);w<c;)if(_=k[w++],S)if(S!==1)if(_)if(_===1){if(O>=0){var P={data:k.subarray(O,w-S-1),type:x};I.push(P)}else{var F=this.getLastNalUnit();if(F&&(C&&w<=4-C&&F.state&&(F.data=F.data.subarray(0,F.data.byteLength-C)),(D=w-S-1)>0)){var N=new Uint8Array(F.data.byteLength+D);N.set(F.data,0),N.set(k.subarray(0,D),F.data.byteLength),F.data=N}}w<c?(O=w,x=31&k[w],S=0):S=-1}else S=0;else S=3;else S=_?0:2;else S=_?0:1;if(O>=0&&S>=0){var U={data:k.subarray(O,c),type:x,state:S};I.push(U)}if(I.length===0){var j=this.getLastNalUnit();if(j){var V=new Uint8Array(j.data.byteLength+k.byteLength);V.set(j.data,0),V.set(k,j.data.byteLength),j.data=V}}return p.naluState=S,I},b.parseAACPES=function(k){var _,D,c,p,S,C=0,I=this._audioTrack,w=this.aacOverFlow,O=k.data;if(w){this.aacOverFlow=null;var x=w.sample.unit.byteLength,P=Math.min(w.missing,x),F=x-P;w.sample.unit.set(O.subarray(0,P),F),I.samples.push(w.sample),C=w.missing}for(_=C,D=O.length;_<D-1&&!i.isHeader(O,_);_++);if(_===C||(_<D-1?(c="AAC PES did not start with ADTS header,offset:"+_,p=!1):(c="no ADTS header found in AAC PES",p=!0),T.logger.warn("parsing error:"+c),this.observer.emit(y.Events.ERROR,y.Events.ERROR,{type:v.ErrorTypes.MEDIA_ERROR,details:v.ErrorDetails.FRAG_PARSING_ERROR,fatal:p,reason:c}),!p)){if(i.initTrackConfig(I,this.observer,O,_,this.audioCodec),k.pts!==void 0)S=k.pts;else{if(!w)return void T.logger.warn("[tsdemuxer]: AAC PES unknown PTS");var N=i.getFrameDuration(I.samplerate);S=w.sample.pts+N}for(var U=0;_<D;){if(i.isHeader(O,_)){if(_+5<D){var j=i.appendFrame(I,O,_,S,U);if(j){if(!j.missing){_+=j.length,U++;continue}this.aacOverFlow=j}}break}_++}}},b.parseMPEGPES=function(k){var _=k.data,D=_.length,c=0,p=0,S=k.pts;if(S!==void 0)for(;p<D;)if(n.isHeader(_,p)){var C=n.appendFrame(this._audioTrack,_,p,S,c);if(!C)break;p+=C.length,c++}else p++;else T.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")},b.parseID3PES=function(k){k.pts!==void 0?this._id3Track.samples.push(k):T.logger.warn("[tsdemuxer]: ID3 PES unknown PTS")},h}();function R(h,b,k,_){return{key:h,frame:!1,pts:b,dts:k,units:[],debug:_,length:0}}function E(h,b){return(31&h[b+10])<<8|h[b+11]}function o(h,b,k,_){var D={audio:-1,avc:-1,id3:-1,isAAC:!0},c=b+3+((15&h[b+1])<<8|h[b+2])-4;for(b+=12+((15&h[b+10])<<8|h[b+11]);b<c;){var p=(31&h[b+1])<<8|h[b+2];switch(h[b]){case 207:if(!_){T.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:D.audio===-1&&(D.audio=p);break;case 21:D.id3===-1&&(D.id3=p);break;case 219:if(!_){T.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:D.avc===-1&&(D.avc=p);break;case 3:case 4:k?D.audio===-1&&(D.audio=p,D.isAAC=!1):T.logger.log("MPEG audio found, not supported in this browser");break;case 36:T.logger.warn("Unsupported HEVC stream type found")}b+=5+((15&h[b+3])<<8|h[b+4])}return D}function f(h){var b,k,_,D,c,p=0,S=h.data;if(!h||h.size===0)return null;for(;S[0].length<19&&S.length>1;){var C=new Uint8Array(S[0].length+S[1].length);C.set(S[0]),C.set(S[1],S[0].length),S[0]=C,S.splice(1,1)}if(((b=S[0])[0]<<16)+(b[1]<<8)+b[2]===1){if((k=(b[4]<<8)+b[5])&&k>h.size-6)return null;var I=b[7];192&I&&(D=536870912*(14&b[9])+4194304*(255&b[10])+16384*(254&b[11])+128*(255&b[12])+(254&b[13])/2,64&I?D-(c=536870912*(14&b[14])+4194304*(255&b[15])+16384*(254&b[16])+128*(255&b[17])+(254&b[18])/2)>54e5&&(T.logger.warn(Math.round((D-c)/9e4)+"s delta between PTS and DTS, align them"),D=c):c=D);var w=(_=b[8])+9;if(h.size<=w)return null;h.size-=w;for(var O=new Uint8Array(h.size),x=0,P=S.length;x<P;x++){var F=(b=S[x]).byteLength;if(w){if(w>F){w-=F;continue}b=b.subarray(w),F-=w,w=0}O.set(b,p),p+=F}return k&&(k-=_+3),{data:O,pts:D,dts:c,len:k}}return null}function l(h,b){if(h.units.length&&h.frame){if(h.pts===void 0){var k=b.samples,_=k.length;if(!_)return void b.dropped++;var D=k[_-1];h.pts=D.pts,h.dts=D.dts}b.samples.push(h)}h.debug.length&&T.logger.log(h.pts+"/"+h.dts+":"+h.debug)}function g(h,b){var k=h.length;if(k>0){if(b.pts>=h[k-1].pts)h.push(b);else for(var _=k-1;_>=0;_--)if(b.pts<h[_].pts){h.splice(_,0,b);break}}else h.push(b)}function m(h){for(var b=h.byteLength,k=[],_=1;_<b-2;)h[_]===0&&h[_+1]===0&&h[_+2]===3?(k.push(_+2),_+=2):_++;if(k.length===0)return h;var D=b-k.length,c=new Uint8Array(D),p=0;for(_=0;_<D;p++,_++)p===k[0]&&(p++,k.shift()),c[_]=h[p];return c}L.minProbeByteLength=188,t.default=L},"./src/errors.ts":function(e,t,r){var i,n,s,u;r.r(t),r.d(t,"ErrorTypes",function(){return i}),r.d(t,"ErrorDetails",function(){return s}),(n=i||(i={})).NETWORK_ERROR="networkError",n.MEDIA_ERROR="mediaError",n.KEY_SYSTEM_ERROR="keySystemError",n.MUX_ERROR="muxError",n.OTHER_ERROR="otherError",(u=s||(s={})).KEY_SYSTEM_NO_KEYS="keySystemNoKeys",u.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",u.KEY_SYSTEM_NO_SESSION="keySystemNoSession",u.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",u.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",u.MANIFEST_LOAD_ERROR="manifestLoadError",u.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",u.MANIFEST_PARSING_ERROR="manifestParsingError",u.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",u.LEVEL_EMPTY_ERROR="levelEmptyError",u.LEVEL_LOAD_ERROR="levelLoadError",u.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",u.LEVEL_SWITCH_ERROR="levelSwitchError",u.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",u.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",u.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",u.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",u.FRAG_LOAD_ERROR="fragLoadError",u.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",u.FRAG_DECRYPT_ERROR="fragDecryptError",u.FRAG_PARSING_ERROR="fragParsingError",u.REMUX_ALLOC_ERROR="remuxAllocError",u.KEY_LOAD_ERROR="keyLoadError",u.KEY_LOAD_TIMEOUT="keyLoadTimeOut",u.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",u.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",u.BUFFER_APPEND_ERROR="bufferAppendError",u.BUFFER_APPENDING_ERROR="bufferAppendingError",u.BUFFER_STALLED_ERROR="bufferStalledError",u.BUFFER_FULL_ERROR="bufferFullError",u.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",u.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",u.INTERNAL_EXCEPTION="internalException",u.INTERNAL_ABORTED="aborted",u.UNKNOWN="unknown"},"./src/events.ts":function(e,t,r){var i,n;r.r(t),r.d(t,"Events",function(){return i}),(n=i||(i={})).MEDIA_ATTACHING="hlsMediaAttaching",n.MEDIA_ATTACHED="hlsMediaAttached",n.MEDIA_DETACHING="hlsMediaDetaching",n.MEDIA_DETACHED="hlsMediaDetached",n.BUFFER_RESET="hlsBufferReset",n.BUFFER_CODECS="hlsBufferCodecs",n.BUFFER_CREATED="hlsBufferCreated",n.BUFFER_APPENDING="hlsBufferAppending",n.BUFFER_APPENDED="hlsBufferAppended",n.BUFFER_EOS="hlsBufferEos",n.BUFFER_FLUSHING="hlsBufferFlushing",n.BUFFER_FLUSHED="hlsBufferFlushed",n.MANIFEST_LOADING="hlsManifestLoading",n.MANIFEST_LOADED="hlsManifestLoaded",n.MANIFEST_PARSED="hlsManifestParsed",n.LEVEL_SWITCHING="hlsLevelSwitching",n.LEVEL_SWITCHED="hlsLevelSwitched",n.LEVEL_LOADING="hlsLevelLoading",n.LEVEL_LOADED="hlsLevelLoaded",n.LEVEL_UPDATED="hlsLevelUpdated",n.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",n.LEVELS_UPDATED="hlsLevelsUpdated",n.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",n.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",n.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",n.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",n.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",n.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",n.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",n.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",n.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",n.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",n.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",n.CUES_PARSED="hlsCuesParsed",n.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",n.INIT_PTS_FOUND="hlsInitPtsFound",n.FRAG_LOADING="hlsFragLoading",n.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",n.FRAG_LOADED="hlsFragLoaded",n.FRAG_DECRYPTED="hlsFragDecrypted",n.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",n.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",n.FRAG_PARSING_METADATA="hlsFragParsingMetadata",n.FRAG_PARSED="hlsFragParsed",n.FRAG_BUFFERED="hlsFragBuffered",n.FRAG_CHANGED="hlsFragChanged",n.FPS_DROP="hlsFpsDrop",n.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",n.ERROR="hlsError",n.DESTROYING="hlsDestroying",n.KEY_LOADING="hlsKeyLoading",n.KEY_LOADED="hlsKeyLoaded",n.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",n.BACK_BUFFER_REACHED="hlsBackBufferReached"},"./src/hls.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return l});var i=r("./node_modules/url-toolkit/src/url-toolkit.js"),n=r("./src/loader/playlist-loader.ts"),s=r("./src/loader/key-loader.ts"),u=r("./src/controller/id3-track-controller.ts"),A=r("./src/controller/latency-controller.ts"),y=r("./src/controller/level-controller.ts"),a=r("./src/controller/fragment-tracker.ts"),T=r("./src/controller/stream-controller.ts"),v=r("./src/is-supported.ts"),d=r("./src/utils/logger.ts"),L=r("./src/config.ts"),R=r("./node_modules/eventemitter3/index.js"),E=r("./src/events.ts"),o=r("./src/errors.ts");function f(g,m){for(var h=0;h<m.length;h++){var b=m[h];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(g,b.key,b)}}var l=function(){function g(_){_===void 0&&(_={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new R.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this._media=null,this.url=null;var D=this.config=Object(L.mergeConfig)(g.DefaultConfig,_);this.userConfig=_,Object(d.enableLogs)(D.debug),this._autoLevelCapping=-1,D.progressive&&Object(L.enableStreamingMode)(D);var c=D.abrController,p=D.bufferController,S=D.capLevelController,C=D.fpsController,I=this.abrController=new c(this),w=this.bufferController=new p(this),O=this.capLevelController=new S(this),x=new C(this),P=new n.default(this),F=new s.default(this),N=new u.default(this),U=this.levelController=new y.default(this),j=new a.FragmentTracker(this),V=this.streamController=new T.default(this,j);O.setStreamController(V),x.setStreamController(V);var z=[U,V];this.networkControllers=z;var G=[P,F,I,w,O,x,N,j];this.audioTrackController=this.createController(D.audioTrackController,null,z),this.createController(D.audioStreamController,j,z),this.subtitleTrackController=this.createController(D.subtitleTrackController,null,z),this.createController(D.subtitleStreamController,j,z),this.createController(D.timelineController,null,G),this.emeController=this.createController(D.emeController,null,G),this.latencyController=this.createController(A.default,null,G),this.coreComponents=G}g.isSupported=function(){return Object(v.isSupported)()};var m,h,b,k=g.prototype;return k.createController=function(_,D,c){if(_){var p=D?new _(this,D):new _(this);return c&&c.push(p),p}return null},k.on=function(_,D,c){c===void 0&&(c=this),this._emitter.on(_,D,c)},k.once=function(_,D,c){c===void 0&&(c=this),this._emitter.once(_,D,c)},k.removeAllListeners=function(_){this._emitter.removeAllListeners(_)},k.off=function(_,D,c,p){c===void 0&&(c=this),this._emitter.off(_,D,c,p)},k.listeners=function(_){return this._emitter.listeners(_)},k.emit=function(_,D,c){return this._emitter.emit(_,D,c)},k.trigger=function(_,D){if(this.config.debug)return this.emit(_,_,D);try{return this.emit(_,_,D)}catch(c){d.logger.error("An internal error happened while handling event "+_+'. Error message: "'+c.message+'". Here is a stacktrace:',c),this.trigger(E.Events.ERROR,{type:o.ErrorTypes.OTHER_ERROR,details:o.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:_,error:c})}return!1},k.listenerCount=function(_){return this._emitter.listenerCount(_)},k.destroy=function(){d.logger.log("destroy"),this.trigger(E.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(_){return _.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(_){return _.destroy()}),this.coreComponents.length=0},k.attachMedia=function(_){d.logger.log("attachMedia"),this._media=_,this.trigger(E.Events.MEDIA_ATTACHING,{media:_})},k.detachMedia=function(){d.logger.log("detachMedia"),this.trigger(E.Events.MEDIA_DETACHING,void 0),this._media=null},k.loadSource=function(_){this.stopLoad();var D=this.media,c=this.url,p=this.url=i.buildAbsoluteURL(self.location.href,_,{alwaysNormalize:!0});d.logger.log("loadSource:"+p),D&&c&&c!==p&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(D)),this.trigger(E.Events.MANIFEST_LOADING,{url:_})},k.startLoad=function(_){_===void 0&&(_=-1),d.logger.log("startLoad("+_+")"),this.networkControllers.forEach(function(D){D.startLoad(_)})},k.stopLoad=function(){d.logger.log("stopLoad"),this.networkControllers.forEach(function(_){_.stopLoad()})},k.swapAudioCodec=function(){d.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},k.recoverMediaError=function(){d.logger.log("recoverMediaError");var _=this._media;this.detachMedia(),_&&this.attachMedia(_)},k.removeLevel=function(_,D){D===void 0&&(D=0),this.levelController.removeLevel(_,D)},m=g,b=[{key:"version",get:function(){return"1.0.10"}},{key:"Events",get:function(){return E.Events}},{key:"ErrorTypes",get:function(){return o.ErrorTypes}},{key:"ErrorDetails",get:function(){return o.ErrorDetails}},{key:"DefaultConfig",get:function(){return g.defaultConfig?g.defaultConfig:L.hlsDefaultConfig},set:function(_){g.defaultConfig=_}}],(h=[{key:"levels",get:function(){var _=this.levelController.levels;return _||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(_){d.logger.log("set currentLevel:"+_),this.loadLevel=_,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(_){d.logger.log("set nextLevel:"+_),this.levelController.manualLevel=_,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(_){d.logger.log("set loadLevel:"+_),this.levelController.manualLevel=_}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(_){this.levelController.nextLoadLevel=_}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(_){d.logger.log("set firstLevel:"+_),this.levelController.firstLevel=_}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(_){d.logger.log("set startLevel:"+_),_!==-1&&(_=Math.max(_,this.minAutoLevel)),this.levelController.startLevel=_}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(_){var D=!!_;D!==this.config.capLevelToPlayerSize&&(D?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=D)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(_){this._autoLevelCapping!==_&&(d.logger.log("set autoLevelCapping:"+_),this._autoLevelCapping=_)}},{key:"bandwidthEstimate",get:function(){var _=this.abrController.bwEstimator;return _?_.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var _=this.levels,D=this.config.minAutoBitrate;if(!_)return 0;for(var c=_.length,p=0;p<c;p++)if(_[p].maxBitrate>D)return p;return 0}},{key:"maxAutoLevel",get:function(){var _=this.levels,D=this.autoLevelCapping;return D===-1&&_&&_.length?_.length-1:D}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(_){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,_)}},{key:"audioTracks",get:function(){var _=this.audioTrackController;return _?_.audioTracks:[]}},{key:"audioTrack",get:function(){var _=this.audioTrackController;return _?_.audioTrack:-1},set:function(_){var D=this.audioTrackController;D&&(D.audioTrack=_)}},{key:"subtitleTracks",get:function(){var _=this.subtitleTrackController;return _?_.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var _=this.subtitleTrackController;return _?_.subtitleTrack:-1},set:function(_){var D=this.subtitleTrackController;D&&(D.subtitleTrack=_)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var _=this.subtitleTrackController;return!!_&&_.subtitleDisplay},set:function(_){var D=this.subtitleTrackController;D&&(D.subtitleDisplay=_)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(_){this.config.lowLatencyMode=_}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}])&&f(m.prototype,h),b&&f(m,b),g}();l.defaultConfig=void 0},"./src/is-supported.ts":function(e,t,r){r.r(t),r.d(t,"isSupported",function(){return s}),r.d(t,"changeTypeSupported",function(){return u});var i=r("./src/utils/mediasource-helper.ts");function n(){return self.SourceBuffer||self.WebKitSourceBuffer}function s(){var A=Object(i.getMediaSource)();if(!A)return!1;var y=n(),a=A&&typeof A.isTypeSupported=="function"&&A.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),T=!y||y.prototype&&typeof y.prototype.appendBuffer=="function"&&typeof y.prototype.remove=="function";return!!a&&!!T}function u(){var A,y=n();return typeof(y==null||(A=y.prototype)===null||A===void 0?void 0:A.changeType)=="function"}},"./src/loader/fragment-loader.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return v}),r.d(t,"LoadError",function(){return L});var i=r("./src/polyfills/number.ts"),n=r("./src/errors.ts");function s(R){var E=typeof Map=="function"?new Map:void 0;return(s=function(o){if(o===null||(f=o,Function.toString.call(f).indexOf("[native code]")===-1))return o;var f;if(typeof o!="function")throw new TypeError("Super expression must either be null or a function");if(E!==void 0){if(E.has(o))return E.get(o);E.set(o,l)}function l(){return u(o,arguments,a(this).constructor)}return l.prototype=Object.create(o.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),y(l,o)})(R)}function u(R,E,o){return(u=A()?Reflect.construct:function(f,l,g){var m=[null];m.push.apply(m,l);var h=new(Function.bind.apply(f,m));return g&&y(h,g.prototype),h}).apply(null,arguments)}function A(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function y(R,E){return(y=Object.setPrototypeOf||function(o,f){return o.__proto__=f,o})(R,E)}function a(R){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(E){return E.__proto__||Object.getPrototypeOf(E)})(R)}var T=Math.pow(2,17),v=function(){function R(o){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=o}var E=R.prototype;return E.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},E.abort=function(){this.loader&&this.loader.abort()},E.load=function(o,f){var l=this,g=o.url;if(!g)return Promise.reject(new L({type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:o,networkDetails:null},"Fragment does not have a "+(g?"part list":"url")));this.abort();var m=this.config,h=m.fLoader,b=m.loader;return new Promise(function(k,_){l.loader&&l.loader.destroy();var D=l.loader=o.loader=h?new h(m):new b(m),c=d(o),p={timeout:m.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:m.fragLoadingMaxRetryTimeout,highWaterMark:T};o.stats=D.stats,D.load(c,p,{onSuccess:function(S,C,I,w){l.resetLoader(o,D),k({frag:o,part:null,payload:S.data,networkDetails:w})},onError:function(S,C,I){l.resetLoader(o,D),_(new L({type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:o,response:S,networkDetails:I}))},onAbort:function(S,C,I){l.resetLoader(o,D),_(new L({type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:o,networkDetails:I}))},onTimeout:function(S,C,I){l.resetLoader(o,D),_(new L({type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:o,networkDetails:I}))},onProgress:function(S,C,I,w){f&&f({frag:o,part:null,payload:I,networkDetails:w})}})})},E.loadPart=function(o,f,l){var g=this;this.abort();var m=this.config,h=m.fLoader,b=m.loader;return new Promise(function(k,_){g.loader&&g.loader.destroy();var D=g.loader=o.loader=h?new h(m):new b(m),c=d(o,f),p={timeout:m.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:m.fragLoadingMaxRetryTimeout,highWaterMark:T};f.stats=D.stats,D.load(c,p,{onSuccess:function(S,C,I,w){g.resetLoader(o,D),g.updateStatsFromPart(o,f);var O={frag:o,part:f,payload:S.data,networkDetails:w};l(O),k(O)},onError:function(S,C,I){g.resetLoader(o,D),_(new L({type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:o,part:f,response:S,networkDetails:I}))},onAbort:function(S,C,I){o.stats.aborted=f.stats.aborted,g.resetLoader(o,D),_(new L({type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:o,part:f,networkDetails:I}))},onTimeout:function(S,C,I){g.resetLoader(o,D),_(new L({type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:o,part:f,networkDetails:I}))}})})},E.updateStatsFromPart=function(o,f){var l=o.stats,g=f.stats,m=g.total;if(l.loaded+=g.loaded,m){var h=Math.round(o.duration/f.duration),b=Math.min(Math.round(l.loaded/m),h),k=(h-b)*Math.round(l.loaded/b);l.total=l.loaded+k}else l.total=Math.max(l.loaded,l.total);var _=l.loading,D=g.loading;_.start?_.first+=D.first-D.start:(_.start=D.start,_.first=D.first),_.end=D.end},E.resetLoader=function(o,f){o.loader=null,this.loader===f&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),f.destroy()},R}();function d(R,E){E===void 0&&(E=null);var o=E||R,f={frag:R,part:E,responseType:"arraybuffer",url:o.url,rangeStart:0,rangeEnd:0},l=o.byteRangeStartOffset,g=o.byteRangeEndOffset;return Object(i.isFiniteNumber)(l)&&Object(i.isFiniteNumber)(g)&&(f.rangeStart=l,f.rangeEnd=g),f}var L=function(R){var E,o;function f(l){for(var g,m=arguments.length,h=new Array(m>1?m-1:0),b=1;b<m;b++)h[b-1]=arguments[b];return(g=R.call.apply(R,[this].concat(h))||this).data=void 0,g.data=l,g}return o=R,(E=f).prototype=Object.create(o.prototype),E.prototype.constructor=E,y(E,o),f}(s(Error))},"./src/loader/fragment.ts":function(e,t,r){r.r(t),r.d(t,"ElementaryStreamTypes",function(){return i}),r.d(t,"BaseSegment",function(){return R}),r.d(t,"Fragment",function(){return E}),r.d(t,"Part",function(){return o});var i,n,s=r("./src/polyfills/number.ts"),u=r("./node_modules/url-toolkit/src/url-toolkit.js"),A=r("./src/utils/logger.ts"),y=r("./src/loader/level-key.ts"),a=r("./src/loader/load-stats.ts");function T(f,l){f.prototype=Object.create(l.prototype),f.prototype.constructor=f,v(f,l)}function v(f,l){return(v=Object.setPrototypeOf||function(g,m){return g.__proto__=m,g})(f,l)}function d(f,l){for(var g=0;g<l.length;g++){var m=l[g];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}function L(f,l,g){return l&&d(f.prototype,l),g&&d(f,g),f}(n=i||(i={})).AUDIO="audio",n.VIDEO="video",n.AUDIOVIDEO="audiovideo";var R=function(){function f(l){var g;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=((g={})[i.AUDIO]=null,g[i.VIDEO]=null,g[i.AUDIOVIDEO]=null,g),this.baseurl=l}return f.prototype.setByteRange=function(l,g){var m=l.split("@",2),h=[];m.length===1?h[0]=g?g.byteRangeEndOffset:0:h[0]=parseInt(m[1]),h[1]=parseInt(m[0])+h[0],this._byteRange=h},L(f,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Object(u.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(l){this._url=l}}]),f}(),E=function(f){function l(m,h){var b;return(b=f.call(this,h)||this)._decryptdata=null,b.rawProgramDateTime=null,b.programDateTime=null,b.tagList=[],b.duration=0,b.sn=0,b.levelkey=void 0,b.type=void 0,b.loader=null,b.level=-1,b.cc=0,b.startPTS=void 0,b.endPTS=void 0,b.appendedPTS=void 0,b.startDTS=void 0,b.endDTS=void 0,b.start=0,b.deltaPTS=void 0,b.maxStartPTS=void 0,b.minEndPTS=void 0,b.stats=new a.LoadStats,b.urlId=0,b.data=void 0,b.bitrateTest=!1,b.title=null,b.initSegment=null,b.type=m,b}T(l,f);var g=l.prototype;return g.createInitializationVector=function(m){for(var h=new Uint8Array(16),b=12;b<16;b++)h[b]=m>>8*(15-b)&255;return h},g.setDecryptDataFromLevelKey=function(m,h){var b=m;return(m==null?void 0:m.method)==="AES-128"&&m.uri&&!m.iv&&((b=y.LevelKey.fromURI(m.uri)).method=m.method,b.iv=this.createInitializationVector(h),b.keyFormat="identity"),b},g.setElementaryStreamInfo=function(m,h,b,k,_,D){D===void 0&&(D=!1);var c=this.elementaryStreams,p=c[m];p?(p.startPTS=Math.min(p.startPTS,h),p.endPTS=Math.max(p.endPTS,b),p.startDTS=Math.min(p.startDTS,k),p.endDTS=Math.max(p.endDTS,_)):c[m]={startPTS:h,endPTS:b,startDTS:k,endDTS:_,partial:D}},g.clearElementaryStreamInfo=function(){var m=this.elementaryStreams;m[i.AUDIO]=null,m[i.VIDEO]=null,m[i.AUDIOVIDEO]=null},L(l,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var m=this.sn;typeof m!="number"&&(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv&&A.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),m=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,m)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!Object(s.isFiniteNumber)(this.programDateTime))return null;var m=Object(s.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+1e3*m}},{key:"encrypted",get:function(){var m;return!((m=this.decryptdata)===null||m===void 0||!m.keyFormat||!this.decryptdata.uri)}}]),l}(R),o=function(f){function l(g,m,h,b,k){var _;(_=f.call(this,h)||this).fragOffset=0,_.duration=0,_.gap=!1,_.independent=!1,_.relurl=void 0,_.fragment=void 0,_.index=void 0,_.stats=new a.LoadStats,_.duration=g.decimalFloatingPoint("DURATION"),_.gap=g.bool("GAP"),_.independent=g.bool("INDEPENDENT"),_.relurl=g.enumeratedString("URI"),_.fragment=m,_.index=b;var D=g.enumeratedString("BYTERANGE");return D&&_.setByteRange(D,k),k&&(_.fragOffset=k.fragOffset+k.duration),_}return T(l,f),L(l,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var g=this.elementaryStreams;return!!(g.audio||g.video||g.audiovideo)}}]),l}(R)},"./src/loader/key-loader.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return u});var i=r("./src/events.ts"),n=r("./src/errors.ts"),s=r("./src/utils/logger.ts"),u=function(){function A(a){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=a,this._registerListeners()}var y=A.prototype;return y._registerListeners=function(){this.hls.on(i.Events.KEY_LOADING,this.onKeyLoading,this)},y._unregisterListeners=function(){this.hls.off(i.Events.KEY_LOADING,this.onKeyLoading)},y.destroy=function(){for(var a in this._unregisterListeners(),this.loaders){var T=this.loaders[a];T&&T.destroy()}this.loaders={}},y.onKeyLoading=function(a,T){var v=T.frag,d=v.type,L=this.loaders[d];if(v.decryptdata){var R=v.decryptdata.uri;if(R!==this.decrypturl||this.decryptkey===null){var E=this.hls.config;if(L&&(s.logger.warn("abort previous key loader for type:"+d),L.abort()),!R)return void s.logger.warn("key uri is falsy");var o=E.loader,f=v.loader=this.loaders[d]=new o(E);this.decrypturl=R,this.decryptkey=null;var l={url:R,frag:v,responseType:"arraybuffer"},g={timeout:E.fragLoadingTimeOut,maxRetry:0,retryDelay:E.fragLoadingRetryDelay,maxRetryDelay:E.fragLoadingMaxRetryTimeout,highWaterMark:0},m={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};f.load(l,g,m)}else this.decryptkey&&(v.decryptdata.key=this.decryptkey,this.hls.trigger(i.Events.KEY_LOADED,{frag:v}))}else s.logger.warn("Missing decryption data on fragment in onKeyLoading")},y.loadsuccess=function(a,T,v){var d=v.frag;d.decryptdata?(this.decryptkey=d.decryptdata.key=new Uint8Array(a.data),d.loader=null,delete this.loaders[d.type],this.hls.trigger(i.Events.KEY_LOADED,{frag:d})):s.logger.error("after key load, decryptdata unset")},y.loaderror=function(a,T){var v=T.frag,d=v.loader;d&&d.abort(),delete this.loaders[v.type],this.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:v,response:a})},y.loadtimeout=function(a,T){var v=T.frag,d=v.loader;d&&d.abort(),delete this.loaders[v.type],this.hls.trigger(i.Events.ERROR,{type:n.ErrorTypes.NETWORK_ERROR,details:n.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:v})},A}()},"./src/loader/level-details.ts":function(e,t,r){r.r(t),r.d(t,"LevelDetails",function(){return s});var i=r("./src/polyfills/number.ts");function n(u,A){for(var y=0;y<A.length;y++){var a=A[y];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(u,a.key,a)}}var s=function(){function u(a){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.url=a}var A,y;return u.prototype.reloaded=function(a){if(!a)return this.advanced=!0,void(this.updated=!0);var T=this.lastPartSn-a.lastPartSn,v=this.lastPartIndex-a.lastPartIndex;this.updated=this.endSN!==a.endSN||!!v||!!T,this.advanced=this.endSN>a.endSN||T>0||T===0&&v>0,this.updated||this.advanced?this.misses=Math.floor(.6*a.misses):this.misses=a.misses+1,this.availabilityDelay=a.availabilityDelay},A=u,(y=[{key:"hasProgramDateTime",get:function(){return!!this.fragments.length&&Object(i.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||10}},{key:"drift",get:function(){var a=this.driftEndTime-this.driftStartTime;return a>0?1e3*(this.driftEnd-this.driftStart)/a:1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var a;return(a=this.partList)!==null&&a!==void 0&&a.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var a;return(a=this.fragments)!==null&&a!==void 0&&a.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var a;return(a=this.partList)!==null&&a!==void 0&&a.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var a;return(a=this.partList)!==null&&a!==void 0&&a.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}])&&n(A.prototype,y),u}()},"./src/loader/level-key.ts":function(e,t,r){r.r(t),r.d(t,"LevelKey",function(){return s});var i=r("./node_modules/url-toolkit/src/url-toolkit.js");function n(u,A){for(var y=0;y<A.length;y++){var a=A[y];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(u,a.key,a)}}var s=function(){function u(a,T){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,this._uri=T?Object(i.buildAbsoluteURL)(a,T,{alwaysNormalize:!0}):a}var A,y;return u.fromURL=function(a,T){return new u(a,T)},u.fromURI=function(a){return new u(a)},A=u,(y=[{key:"uri",get:function(){return this._uri}}])&&n(A.prototype,y),u}()},"./src/loader/load-stats.ts":function(e,t,r){r.r(t),r.d(t,"LoadStats",function(){return i});var i=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return o});var i=r("./src/polyfills/number.ts"),n=r("./node_modules/url-toolkit/src/url-toolkit.js"),s=r("./src/loader/fragment.ts"),u=r("./src/loader/level-details.ts"),A=r("./src/loader/level-key.ts"),y=r("./src/utils/attr-list.ts"),a=r("./src/utils/logger.ts"),T=r("./src/utils/codecs.ts"),v=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,d=/#EXT-X-MEDIA:(.*)/g,L=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),R=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(PLAYLIST-TYPE):(.+)/.source,/#EXT-X-(MEDIA-SEQUENCE): *(\d+)/.source,/#EXT-X-(SKIP):(.+)/.source,/#EXT-X-(TARGETDURATION): *(\d+)/.source,/#EXT-X-(KEY):(.+)/.source,/#EXT-X-(START):(.+)/.source,/#EXT-X-(ENDLIST)/.source,/#EXT-X-(DISCONTINUITY-SEQ)UENCE: *(\d+)/.source,/#EXT-X-(DIS)CONTINUITY/.source,/#EXT-X-(VERSION):(\d+)/.source,/#EXT-X-(MAP):(.+)/.source,/#EXT-X-(SERVER-CONTROL):(.+)/.source,/#EXT-X-(PART-INF):(.+)/.source,/#EXT-X-(GAP)/.source,/#EXT-X-(BITRATE):\s*(\d+)/.source,/#EXT-X-(PART):(.+)/.source,/#EXT-X-(PRELOAD-HINT):(.+)/.source,/#EXT-X-(RENDITION-REPORT):(.+)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),E=/\.(mp4|m4s|m4v|m4a)$/i,o=function(){function m(){}return m.findGroup=function(h,b){for(var k=0;k<h.length;k++){var _=h[k];if(_.id===b)return _}},m.convertAVC1ToAVCOTI=function(h){var b=h.split(".");if(b.length>2){var k=b.shift()+".";return k+=parseInt(b.shift()).toString(16),k+=("000"+parseInt(b.shift()).toString(16)).substr(-4)}return h},m.resolve=function(h,b){return n.buildAbsoluteURL(b,h,{alwaysNormalize:!0})},m.parseMasterPlaylist=function(h,b){var k,_=[],D={},c=!1;for(v.lastIndex=0;(k=v.exec(h))!=null;)if(k[1]){var p=new y.AttrList(k[1]),S={attrs:p,bitrate:p.decimalInteger("AVERAGE-BANDWIDTH")||p.decimalInteger("BANDWIDTH"),name:p.NAME,url:m.resolve(k[2],b)},C=p.decimalResolution("RESOLUTION");C&&(S.width=C.width,S.height=C.height),f((p.CODECS||"").split(/[ ,]+/).filter(function(w){return w}),S),S.videoCodec&&S.videoCodec.indexOf("avc1")!==-1&&(S.videoCodec=m.convertAVC1ToAVCOTI(S.videoCodec)),_.push(S)}else if(k[3]){var I=new y.AttrList(k[3]);I["DATA-ID"]&&(c=!0,D[I["DATA-ID"]]=I)}return{levels:_,sessionData:c?D:null}},m.parseMasterPlaylistMedia=function(h,b,k,_){var D;_===void 0&&(_=[]);var c=[],p=0;for(d.lastIndex=0;(D=d.exec(h))!==null;){var S=new y.AttrList(D[1]);if(S.TYPE===k){var C={attrs:S,bitrate:0,id:p++,groupId:S["GROUP-ID"],instreamId:S["INSTREAM-ID"],name:S.NAME||S.LANGUAGE||"",type:k,default:S.bool("DEFAULT"),autoselect:S.bool("AUTOSELECT"),forced:S.bool("FORCED"),lang:S.LANGUAGE,url:S.URI?m.resolve(S.URI,b):""};if(_.length){var I=m.findGroup(_,C.groupId)||_[0];l(C,I,"audioCodec"),l(C,I,"textCodec")}c.push(C)}}return c},m.parseLevelPlaylist=function(h,b,k,_,D){var c,p,S,C=new u.LevelDetails(b),I=C.fragments,w=null,O=0,x=0,P=0,F=0,N=null,U=new s.Fragment(_,b),j=-1,V=!1;for(L.lastIndex=0,C.m3u8=h;(c=L.exec(h))!==null;){V&&(V=!1,(U=new s.Fragment(_,b)).start=P,U.sn=O,U.cc=F,U.level=k,w&&(U.initSegment=w,U.rawProgramDateTime=w.rawProgramDateTime));var z=c[1];if(z){U.duration=parseFloat(z);var G=(" "+c[2]).slice(1);U.title=G||null,U.tagList.push(G?["INF",z,G]:["INF",z])}else if(c[3])Object(i.isFiniteNumber)(U.duration)&&(U.start=P,S&&(U.levelkey=S),U.sn=O,U.level=k,U.cc=F,U.urlId=D,I.push(U),U.relurl=(" "+c[3]).slice(1),g(U,N),N=U,P+=U.duration,O++,x=0,V=!0);else if(c[4]){var W=(" "+c[4]).slice(1);N?U.setByteRange(W,N):U.setByteRange(W)}else if(c[5])U.rawProgramDateTime=(" "+c[5]).slice(1),U.tagList.push(["PROGRAM-DATE-TIME",U.rawProgramDateTime]),j===-1&&(j=I.length);else{if(!(c=c[0].match(R))){a.logger.warn("No matches on slow regex match for level playlist!");continue}for(p=1;p<c.length&&c[p]===void 0;p++);var $=(" "+c[p]).slice(1),Y=(" "+c[p+1]).slice(1),re=c[p+2]?(" "+c[p+2]).slice(1):"";switch($){case"PLAYLIST-TYPE":C.type=Y.toUpperCase();break;case"MEDIA-SEQUENCE":O=C.startSN=parseInt(Y);break;case"SKIP":var ue=new y.AttrList(Y),oe=ue.decimalInteger("SKIPPED-SEGMENTS");if(Object(i.isFiniteNumber)(oe)){C.skippedSegments=oe;for(var M=oe;M--;)I.unshift(null);O+=oe}var B=ue.enumeratedString("RECENTLY-REMOVED-DATERANGES");B&&(C.recentlyRemovedDateranges=B.split("	"));break;case"TARGETDURATION":C.targetduration=parseFloat(Y);break;case"VERSION":C.version=parseInt(Y);break;case"EXTM3U":break;case"ENDLIST":C.live=!1;break;case"#":(Y||re)&&U.tagList.push(re?[Y,re]:[Y]);break;case"DIS":F++;case"GAP":U.tagList.push([$]);break;case"BITRATE":U.tagList.push([$,Y]);break;case"DISCONTINUITY-SEQ":F=parseInt(Y);break;case"KEY":var K,H=new y.AttrList(Y),q=H.enumeratedString("METHOD"),Q=H.URI,J=H.hexadecimalInteger("IV"),Z=H.enumeratedString("KEYFORMATVERSIONS"),te=H.enumeratedString("KEYID"),X=(K=H.enumeratedString("KEYFORMAT"))!=null?K:"identity";if(["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"].indexOf(X)>-1){a.logger.warn("Keyformat "+X+" is not supported from the manifest");continue}if(X!=="identity")continue;q&&(S=A.LevelKey.fromURL(b,Q),Q&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(q)>=0&&(S.method=q,S.keyFormat=X,te&&(S.keyID=te),Z&&(S.keyFormatVersions=Z),S.iv=J));break;case"START":var le=new y.AttrList(Y).decimalFloatingPoint("TIME-OFFSET");Object(i.isFiniteNumber)(le)&&(C.startTimeOffset=le);break;case"MAP":var ie=new y.AttrList(Y);U.relurl=ie.URI,ie.BYTERANGE&&U.setByteRange(ie.BYTERANGE),U.level=k,U.sn="initSegment",S&&(U.levelkey=S),U.initSegment=null,w=U,V=!0;break;case"SERVER-CONTROL":var ae=new y.AttrList(Y);C.canBlockReload=ae.bool("CAN-BLOCK-RELOAD"),C.canSkipUntil=ae.optionalFloat("CAN-SKIP-UNTIL",0),C.canSkipDateRanges=C.canSkipUntil>0&&ae.bool("CAN-SKIP-DATERANGES"),C.partHoldBack=ae.optionalFloat("PART-HOLD-BACK",0),C.holdBack=ae.optionalFloat("HOLD-BACK",0);break;case"PART-INF":var ce=new y.AttrList(Y);C.partTarget=ce.decimalFloatingPoint("PART-TARGET");break;case"PART":var de=C.partList;de||(de=C.partList=[]);var ge=x>0?de[de.length-1]:void 0,pe=x++,Te=new s.Part(new y.AttrList(Y),U,b,pe,ge);de.push(Te),U.duration+=Te.duration;break;case"PRELOAD-HINT":var Le=new y.AttrList(Y);C.preloadHint=Le;break;case"RENDITION-REPORT":var Ye=new y.AttrList(Y);C.renditionReports=C.renditionReports||[],C.renditionReports.push(Ye);break;default:a.logger.warn("line parsed but not handled: "+c)}}}N&&!N.relurl?(I.pop(),P-=N.duration,C.partList&&(C.fragmentHint=N)):C.partList&&(g(U,N),U.cc=F,C.fragmentHint=U);var Et=I.length,Be=I[0],Ct=I[Et-1];if((P+=C.skippedSegments*C.targetduration)>0&&Et&&Ct){C.averagetargetduration=P/Et;var ke=Ct.sn;C.endSN=ke!=="initSegment"?ke:0,Be&&(C.startCC=Be.cc,Be.initSegment||C.fragments.every(function(Ie){return Ie.relurl&&(Je=Ie.relurl,E.test((Gt=(ut=n.parseURL(Je))===null||ut===void 0?void 0:ut.path)!=null?Gt:""));var Je,Gt,ut})&&(a.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(U=new s.Fragment(_,b)).relurl=Ct.relurl,U.level=k,U.sn="initSegment",Be.initSegment=U,C.needSidxRanges=!0))}else C.endSN=0,C.startCC=0;return C.fragmentHint&&(P+=C.fragmentHint.duration),C.totalduration=P,C.endCC=F,j>0&&function(Ie,Je){for(var Gt=Ie[Je],ut=Je;ut--;){var jt=Ie[ut];if(!jt)return;jt.programDateTime=Gt.programDateTime-1e3*jt.duration,Gt=jt}}(I,j),C},m}();function f(m,h){["video","audio","text"].forEach(function(b){var k=m.filter(function(D){return Object(T.isCodecType)(D,b)});if(k.length){var _=k.filter(function(D){return D.lastIndexOf("avc1",0)===0||D.lastIndexOf("mp4a",0)===0});h[b+"Codec"]=_.length>0?_[0]:k[0],m=m.filter(function(D){return k.indexOf(D)===-1})}}),h.unknownCodecs=m}function l(m,h,b){var k=h[b];k&&(m[b]=k)}function g(m,h){m.rawProgramDateTime?m.programDateTime=Date.parse(m.rawProgramDateTime):h!=null&&h.programDateTime&&(m.programDateTime=h.endProgramDateTime),Object(i.isFiniteNumber)(m.programDateTime)||(m.programDateTime=null,m.rawProgramDateTime=null)}},"./src/loader/playlist-loader.ts":function(e,t,r){r.r(t);var i=r("./src/polyfills/number.ts"),n=r("./src/events.ts"),s=r("./src/errors.ts"),u=r("./src/utils/logger.ts"),A=r("./src/utils/mp4-tools.ts"),y=r("./src/loader/m3u8-parser.ts"),a=r("./src/types/loader.ts"),T=r("./src/utils/attr-list.ts");function v(L,R){var E=L.url;return E!==void 0&&E.indexOf("data:")!==0||(E=R.url),E}var d=function(){function L(E){this.hls=void 0,this.loaders=Object.create(null),this.hls=E,this.registerListeners()}var R=L.prototype;return R.registerListeners=function(){var E=this.hls;E.on(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),E.on(n.Events.LEVEL_LOADING,this.onLevelLoading,this),E.on(n.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),E.on(n.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},R.unregisterListeners=function(){var E=this.hls;E.off(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),E.off(n.Events.LEVEL_LOADING,this.onLevelLoading,this),E.off(n.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),E.off(n.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},R.createInternalLoader=function(E){var o=this.hls.config,f=o.pLoader,l=o.loader,g=new(f||l)(o);return E.loader=g,this.loaders[E.type]=g,g},R.getInternalLoader=function(E){return this.loaders[E.type]},R.resetInternalLoader=function(E){this.loaders[E]&&delete this.loaders[E]},R.destroyInternalLoaders=function(){for(var E in this.loaders){var o=this.loaders[E];o&&o.destroy(),this.resetInternalLoader(E)}},R.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},R.onManifestLoading=function(E,o){var f=o.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:a.PlaylistContextType.MANIFEST,url:f,deliveryDirectives:null})},R.onLevelLoading=function(E,o){var f=o.id,l=o.level,g=o.url,m=o.deliveryDirectives;this.load({id:f,groupId:null,level:l,responseType:"text",type:a.PlaylistContextType.LEVEL,url:g,deliveryDirectives:m})},R.onAudioTrackLoading=function(E,o){var f=o.id,l=o.groupId,g=o.url,m=o.deliveryDirectives;this.load({id:f,groupId:l,level:null,responseType:"text",type:a.PlaylistContextType.AUDIO_TRACK,url:g,deliveryDirectives:m})},R.onSubtitleTrackLoading=function(E,o){var f=o.id,l=o.groupId,g=o.url,m=o.deliveryDirectives;this.load({id:f,groupId:l,level:null,responseType:"text",type:a.PlaylistContextType.SUBTITLE_TRACK,url:g,deliveryDirectives:m})},R.load=function(E){var o,f,l,g,m,h,b=this.hls.config,k=this.getInternalLoader(E);if(k){var _=k.context;if(_&&_.url===E.url)return void u.logger.trace("[playlist-loader]: playlist request ongoing");u.logger.log("[playlist-loader]: aborting previous loader for type: "+E.type),k.abort()}switch(E.type){case a.PlaylistContextType.MANIFEST:f=b.manifestLoadingMaxRetry,l=b.manifestLoadingTimeOut,g=b.manifestLoadingRetryDelay,m=b.manifestLoadingMaxRetryTimeout;break;case a.PlaylistContextType.LEVEL:case a.PlaylistContextType.AUDIO_TRACK:case a.PlaylistContextType.SUBTITLE_TRACK:f=0,l=b.levelLoadingTimeOut;break;default:f=b.levelLoadingMaxRetry,l=b.levelLoadingTimeOut,g=b.levelLoadingRetryDelay,m=b.levelLoadingMaxRetryTimeout}if(k=this.createInternalLoader(E),(o=E.deliveryDirectives)!==null&&o!==void 0&&o.part&&(E.type===a.PlaylistContextType.LEVEL&&E.level!==null?h=this.hls.levels[E.level].details:E.type===a.PlaylistContextType.AUDIO_TRACK&&E.id!==null?h=this.hls.audioTracks[E.id].details:E.type===a.PlaylistContextType.SUBTITLE_TRACK&&E.id!==null&&(h=this.hls.subtitleTracks[E.id].details),h)){var D=h.partTarget,c=h.targetduration;D&&c&&(l=Math.min(1e3*Math.max(3*D,.8*c),l))}var p={timeout:l,maxRetry:f,retryDelay:g,maxRetryDelay:m,highWaterMark:0},S={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};k.load(E,p,S)},R.loadsuccess=function(E,o,f,l){if(l===void 0&&(l=null),f.isSidxRequest)return this.handleSidxRequest(E,f),void this.handlePlaylistLoaded(E,o,f,l);this.resetInternalLoader(f.type);var g=E.data;g.indexOf("#EXTM3U")===0?(o.parsing.start=performance.now(),g.indexOf("#EXTINF:")>0||g.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(E,o,f,l):this.handleMasterPlaylist(E,o,f,l)):this.handleManifestParsingError(E,f,"no EXTM3U delimiter",l)},R.loaderror=function(E,o,f){f===void 0&&(f=null),this.handleNetworkError(o,f,!1,E)},R.loadtimeout=function(E,o,f){f===void 0&&(f=null),this.handleNetworkError(o,f,!0)},R.handleMasterPlaylist=function(E,o,f,l){var g=this.hls,m=E.data,h=v(E,f),b=y.default.parseMasterPlaylist(m,h),k=b.levels,_=b.sessionData;if(k.length){var D=k.map(function(I){return{id:I.attrs.AUDIO,audioCodec:I.audioCodec}}),c=k.map(function(I){return{id:I.attrs.SUBTITLES,textCodec:I.textCodec}}),p=y.default.parseMasterPlaylistMedia(m,h,"AUDIO",D),S=y.default.parseMasterPlaylistMedia(m,h,"SUBTITLES",c),C=y.default.parseMasterPlaylistMedia(m,h,"CLOSED-CAPTIONS");p.length&&(p.some(function(I){return!I.url})||!k[0].audioCodec||k[0].attrs.AUDIO||(u.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new T.AttrList({}),bitrate:0,url:""}))),g.trigger(n.Events.MANIFEST_LOADED,{levels:k,audioTracks:p,subtitles:S,captions:C,url:h,stats:o,networkDetails:l,sessionData:_})}else this.handleManifestParsingError(E,f,"no level found in manifest",l)},R.handleTrackOrLevelPlaylist=function(E,o,f,l){var g=this.hls,m=f.id,h=f.level,b=f.type,k=v(E,f),_=Object(i.isFiniteNumber)(m)?m:0,D=Object(i.isFiniteNumber)(h)?h:_,c=function(w){switch(w.type){case a.PlaylistContextType.AUDIO_TRACK:return a.PlaylistLevelType.AUDIO;case a.PlaylistContextType.SUBTITLE_TRACK:return a.PlaylistLevelType.SUBTITLE;default:return a.PlaylistLevelType.MAIN}}(f),p=y.default.parseLevelPlaylist(E.data,k,D,c,_);if(p.fragments.length){if(b===a.PlaylistContextType.MANIFEST){var S={attrs:new T.AttrList({}),bitrate:0,details:p,name:"",url:k};g.trigger(n.Events.MANIFEST_LOADED,{levels:[S],audioTracks:[],url:k,stats:o,networkDetails:l,sessionData:null})}if(o.parsing.end=performance.now(),p.needSidxRanges){var C,I=(C=p.fragments[0].initSegment)===null||C===void 0?void 0:C.url;this.load({url:I,isSidxRequest:!0,type:b,level:h,levelDetails:p,id:m,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null})}else f.levelDetails=p,this.handlePlaylistLoaded(E,o,f,l)}else g.trigger(n.Events.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:k,reason:"no fragments found in level",level:typeof f.level=="number"?f.level:void 0})},R.handleSidxRequest=function(E,o){var f=Object(A.parseSegmentIndex)(new Uint8Array(E.data));if(f){var l=f.references,g=o.levelDetails;l.forEach(function(m,h){var b=m.info,k=g.fragments[h];k.byteRange.length===0&&k.setByteRange(String(1+b.end-b.start)+"@"+String(b.start)),k.initSegment&&k.initSegment.setByteRange(String(f.moovEndOffset)+"@0")})}},R.handleManifestParsingError=function(E,o,f,l){this.hls.trigger(n.Events.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:o.type===a.PlaylistContextType.MANIFEST,url:E.url,reason:f,response:E,context:o,networkDetails:l})},R.handleNetworkError=function(E,o,f,l){f===void 0&&(f=!1),u.logger.warn("[playlist-loader]: A network "+(f?"timeout":"error")+" occurred while loading "+E.type+" level: "+E.level+" id: "+E.id+' group-id: "'+E.groupId+'"');var g=s.ErrorDetails.UNKNOWN,m=!1,h=this.getInternalLoader(E);switch(E.type){case a.PlaylistContextType.MANIFEST:g=f?s.ErrorDetails.MANIFEST_LOAD_TIMEOUT:s.ErrorDetails.MANIFEST_LOAD_ERROR,m=!0;break;case a.PlaylistContextType.LEVEL:g=f?s.ErrorDetails.LEVEL_LOAD_TIMEOUT:s.ErrorDetails.LEVEL_LOAD_ERROR,m=!1;break;case a.PlaylistContextType.AUDIO_TRACK:g=f?s.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:s.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,m=!1;break;case a.PlaylistContextType.SUBTITLE_TRACK:g=f?s.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:s.ErrorDetails.SUBTITLE_LOAD_ERROR,m=!1}h&&this.resetInternalLoader(E.type);var b={type:s.ErrorTypes.NETWORK_ERROR,details:g,fatal:m,url:E.url,loader:h,context:E,networkDetails:o};l&&(b.response=l),this.hls.trigger(n.Events.ERROR,b)},R.handlePlaylistLoaded=function(E,o,f,l){var g=f.type,m=f.level,h=f.id,b=f.groupId,k=f.loader,_=f.levelDetails,D=f.deliveryDirectives;if(_!=null&&_.targetduration){if(k)switch(_.live&&(k.getCacheAge&&(_.ageHeader=k.getCacheAge()||0),k.getCacheAge&&!isNaN(_.ageHeader)||(_.ageHeader=0)),g){case a.PlaylistContextType.MANIFEST:case a.PlaylistContextType.LEVEL:this.hls.trigger(n.Events.LEVEL_LOADED,{details:_,level:m||0,id:h||0,stats:o,networkDetails:l,deliveryDirectives:D});break;case a.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(n.Events.AUDIO_TRACK_LOADED,{details:_,id:h||0,groupId:b||"",stats:o,networkDetails:l,deliveryDirectives:D});break;case a.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(n.Events.SUBTITLE_TRACK_LOADED,{details:_,id:h||0,groupId:b||"",stats:o,networkDetails:l,deliveryDirectives:D})}}else this.handleManifestParsingError(E,f,"invalid target duration",l)},L}();t.default=d},"./src/polyfills/number.ts":function(e,t,r){r.r(t),r.d(t,"isFiniteNumber",function(){return i}),r.d(t,"MAX_SAFE_INTEGER",function(){return n});var i=Number.isFinite||function(s){return typeof s=="number"&&isFinite(s)},n=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":function(e,t,r){r.r(t);var i=function(){function n(){}return n.getSilentFrame=function(s,u){switch(s){case"mp4a.40.2":if(u===1)return new Uint8Array([0,200,0,128,35,128]);if(u===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(u===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(u===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(u===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(u===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(u===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(u===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(u===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}},n}();t.default=i},"./src/remux/mp4-generator.ts":function(e,t,r){r.r(t);var i=Math.pow(2,32)-1,n=function(){function s(){}return s.init=function(){var u;for(u in s.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},s.types)s.types.hasOwnProperty(u)&&(s.types[u]=[u.charCodeAt(0),u.charCodeAt(1),u.charCodeAt(2),u.charCodeAt(3)]);var A=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),y=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);s.HDLR_TYPES={video:A,audio:y};var a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),T=new Uint8Array([0,0,0,0,0,0,0,0]);s.STTS=s.STSC=s.STCO=T,s.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),s.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),s.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),s.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var v=new Uint8Array([105,115,111,109]),d=new Uint8Array([97,118,99,49]),L=new Uint8Array([0,0,0,1]);s.FTYP=s.box(s.types.ftyp,v,L,v,d),s.DINF=s.box(s.types.dinf,s.box(s.types.dref,a))},s.box=function(u){for(var A=8,y=arguments.length,a=new Array(y>1?y-1:0),T=1;T<y;T++)a[T-1]=arguments[T];for(var v=a.length,d=v;v--;)A+=a[v].byteLength;var L=new Uint8Array(A);for(L[0]=A>>24&255,L[1]=A>>16&255,L[2]=A>>8&255,L[3]=255&A,L.set(u,4),v=0,A=8;v<d;v++)L.set(a[v],A),A+=a[v].byteLength;return L},s.hdlr=function(u){return s.box(s.types.hdlr,s.HDLR_TYPES[u])},s.mdat=function(u){return s.box(s.types.mdat,u)},s.mdhd=function(u,A){A*=u;var y=Math.floor(A/(i+1)),a=Math.floor(A%(i+1));return s.box(s.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,u>>24&255,u>>16&255,u>>8&255,255&u,y>>24,y>>16&255,y>>8&255,255&y,a>>24,a>>16&255,a>>8&255,255&a,85,196,0,0]))},s.mdia=function(u){return s.box(s.types.mdia,s.mdhd(u.timescale,u.duration),s.hdlr(u.type),s.minf(u))},s.mfhd=function(u){return s.box(s.types.mfhd,new Uint8Array([0,0,0,0,u>>24,u>>16&255,u>>8&255,255&u]))},s.minf=function(u){return u.type==="audio"?s.box(s.types.minf,s.box(s.types.smhd,s.SMHD),s.DINF,s.stbl(u)):s.box(s.types.minf,s.box(s.types.vmhd,s.VMHD),s.DINF,s.stbl(u))},s.moof=function(u,A,y){return s.box(s.types.moof,s.mfhd(u),s.traf(y,A))},s.moov=function(u){for(var A=u.length,y=[];A--;)y[A]=s.trak(u[A]);return s.box.apply(null,[s.types.moov,s.mvhd(u[0].timescale,u[0].duration)].concat(y).concat(s.mvex(u)))},s.mvex=function(u){for(var A=u.length,y=[];A--;)y[A]=s.trex(u[A]);return s.box.apply(null,[s.types.mvex].concat(y))},s.mvhd=function(u,A){A*=u;var y=Math.floor(A/(i+1)),a=Math.floor(A%(i+1)),T=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,u>>24&255,u>>16&255,u>>8&255,255&u,y>>24,y>>16&255,y>>8&255,255&y,a>>24,a>>16&255,a>>8&255,255&a,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return s.box(s.types.mvhd,T)},s.sdtp=function(u){var A,y,a=u.samples||[],T=new Uint8Array(4+a.length);for(A=0;A<a.length;A++)y=a[A].flags,T[A+4]=y.dependsOn<<4|y.isDependedOn<<2|y.hasRedundancy;return s.box(s.types.sdtp,T)},s.stbl=function(u){return s.box(s.types.stbl,s.stsd(u),s.box(s.types.stts,s.STTS),s.box(s.types.stsc,s.STSC),s.box(s.types.stsz,s.STSZ),s.box(s.types.stco,s.STCO))},s.avc1=function(u){var A,y,a,T=[],v=[];for(A=0;A<u.sps.length;A++)a=(y=u.sps[A]).byteLength,T.push(a>>>8&255),T.push(255&a),T=T.concat(Array.prototype.slice.call(y));for(A=0;A<u.pps.length;A++)a=(y=u.pps[A]).byteLength,v.push(a>>>8&255),v.push(255&a),v=v.concat(Array.prototype.slice.call(y));var d=s.box(s.types.avcC,new Uint8Array([1,T[3],T[4],T[5],255,224|u.sps.length].concat(T).concat([u.pps.length]).concat(v))),L=u.width,R=u.height,E=u.pixelRatio[0],o=u.pixelRatio[1];return s.box(s.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,L>>8&255,255&L,R>>8&255,255&R,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),d,s.box(s.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),s.box(s.types.pasp,new Uint8Array([E>>24,E>>16&255,E>>8&255,255&E,o>>24,o>>16&255,o>>8&255,255&o])))},s.esds=function(u){var A=u.config.length;return new Uint8Array([0,0,0,0,3,23+A,0,1,0,4,15+A,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([A]).concat(u.config).concat([6,1,2]))},s.mp4a=function(u){var A=u.samplerate;return s.box(s.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,u.channelCount,0,16,0,0,0,0,A>>8&255,255&A,0,0]),s.box(s.types.esds,s.esds(u)))},s.mp3=function(u){var A=u.samplerate;return s.box(s.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,u.channelCount,0,16,0,0,0,0,A>>8&255,255&A,0,0]))},s.stsd=function(u){return u.type==="audio"?u.isAAC||u.codec!=="mp3"?s.box(s.types.stsd,s.STSD,s.mp4a(u)):s.box(s.types.stsd,s.STSD,s.mp3(u)):s.box(s.types.stsd,s.STSD,s.avc1(u))},s.tkhd=function(u){var A=u.id,y=u.duration*u.timescale,a=u.width,T=u.height,v=Math.floor(y/(i+1)),d=Math.floor(y%(i+1));return s.box(s.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,A>>24&255,A>>16&255,A>>8&255,255&A,0,0,0,0,v>>24,v>>16&255,v>>8&255,255&v,d>>24,d>>16&255,d>>8&255,255&d,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>8&255,255&a,0,0,T>>8&255,255&T,0,0]))},s.traf=function(u,A){var y=s.sdtp(u),a=u.id,T=Math.floor(A/(i+1)),v=Math.floor(A%(i+1));return s.box(s.types.traf,s.box(s.types.tfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a])),s.box(s.types.tfdt,new Uint8Array([1,0,0,0,T>>24,T>>16&255,T>>8&255,255&T,v>>24,v>>16&255,v>>8&255,255&v])),s.trun(u,y.length+16+20+8+16+8+8),y)},s.trak=function(u){return u.duration=u.duration||4294967295,s.box(s.types.trak,s.tkhd(u),s.mdia(u))},s.trex=function(u){var A=u.id;return s.box(s.types.trex,new Uint8Array([0,0,0,0,A>>24,A>>16&255,A>>8&255,255&A,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},s.trun=function(u,A){var y,a,T,v,d,L,R=u.samples||[],E=R.length,o=12+16*E,f=new Uint8Array(o);for(A+=8+o,f.set([0,0,15,1,E>>>24&255,E>>>16&255,E>>>8&255,255&E,A>>>24&255,A>>>16&255,A>>>8&255,255&A],0),y=0;y<E;y++)T=(a=R[y]).duration,v=a.size,d=a.flags,L=a.cts,f.set([T>>>24&255,T>>>16&255,T>>>8&255,255&T,v>>>24&255,v>>>16&255,v>>>8&255,255&v,d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|d.isNonSync,61440&d.degradPrio,15&d.degradPrio,L>>>24&255,L>>>16&255,L>>>8&255,255&L],12+16*y);return s.box(s.types.trun,f)},s.initSegment=function(u){s.types||s.init();var A=s.moov(u),y=new Uint8Array(s.FTYP.byteLength+A.byteLength);return y.set(s.FTYP),y.set(A,s.FTYP.byteLength),y},s}();n.types=void 0,n.HDLR_TYPES=void 0,n.STTS=void 0,n.STSC=void 0,n.STCO=void 0,n.STSZ=void 0,n.VMHD=void 0,n.SMHD=void 0,n.STSD=void 0,n.FTYP=void 0,n.DINF=void 0,t.default=n},"./src/remux/mp4-remuxer.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return E}),r.d(t,"normalizePts",function(){return o});var i=r("./src/polyfills/number.ts"),n=r("./src/remux/aac-helper.ts"),s=r("./src/remux/mp4-generator.ts"),u=r("./src/events.ts"),A=r("./src/errors.ts"),y=r("./src/utils/logger.ts"),a=r("./src/types/loader.ts"),T=r("./src/utils/timescale-conversion.ts");function v(){return(v=Object.assign||function(g){for(var m=1;m<arguments.length;m++){var h=arguments[m];for(var b in h)Object.prototype.hasOwnProperty.call(h,b)&&(g[b]=h[b])}return g}).apply(this,arguments)}var d=null,L=null,R=!1,E=function(){function g(h,b,k,_){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=h,this.config=b,this.typeSupported=k,this.ISGenerated=!1,d===null){var D=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);d=D?parseInt(D[1]):0}if(L===null){var c=navigator.userAgent.match(/Safari\/(\d+)/i);L=c?parseInt(c[1]):0}R=!!d&&d<75||!!L&&L<600}var m=g.prototype;return m.destroy=function(){},m.resetTimeStamp=function(h){y.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=h},m.resetNextTimestamp=function(){y.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},m.resetInitSegment=function(){y.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},m.getVideoStartPts=function(h){var b=!1,k=h.reduce(function(_,D){var c=D.pts-_;return c<-4294967296?(b=!0,o(_,D.pts)):c>0?_:D.pts},h[0].pts);return b&&y.logger.debug("PTS rollover detected"),k},m.remux=function(h,b,k,_,D,c,p,S){var C,I,w,O,x,P,F=D,N=D,U=h.pid>-1,j=b.pid>-1,V=b.samples.length,z=h.samples.length>0,G=V>1;if((!U||z)&&(!j||G)||this.ISGenerated||p){this.ISGenerated||(w=this.generateIS(h,b,D));var W=this.isVideoContiguous,$=-1;if(G&&($=function(M){for(var B=0;B<M.length;B++)if(M[B].key)return B;return-1}(b.samples),!W&&this.config.forceKeyFrameOnDiscontinuity))if(P=!0,$>0){y.logger.warn("[mp4-remuxer]: Dropped "+$+" out of "+V+" video samples due to a missing keyframe");var Y=this.getVideoStartPts(b.samples);b.samples=b.samples.slice($),b.dropped+=$,N+=(b.samples[0].pts-Y)/(b.timescale||9e4)}else $===-1&&(y.logger.warn("[mp4-remuxer]: No keyframe found out of "+V+" video samples"),P=!1);if(this.ISGenerated){if(z&&G){var re=this.getVideoStartPts(b.samples),ue=(o(h.samples[0].pts,re)-re)/b.inputTimeScale;F+=Math.max(0,ue),N+=Math.max(0,-ue)}if(z){if(h.samplerate||(y.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),w=this.generateIS(h,b,D)),I=this.remuxAudio(h,F,this.isAudioContiguous,c,j||G||S===a.PlaylistLevelType.AUDIO?N:void 0),G){var oe=I?I.endPTS-I.startPTS:0;b.inputTimeScale||(y.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),w=this.generateIS(h,b,D)),C=this.remuxVideo(b,N,W,oe)}}else G&&(C=this.remuxVideo(b,N,W,0));C&&(C.firstKeyFrame=$,C.independent=$!==-1)}}return this.ISGenerated&&(k.samples.length&&(x=this.remuxID3(k,D)),_.samples.length&&(O=this.remuxText(_,D))),{audio:I,video:C,initSegment:w,independent:P,text:O,id3:x}},m.generateIS=function(h,b,k){var _,D,c,p=h.samples,S=b.samples,C=this.typeSupported,I={},w=!Object(i.isFiniteNumber)(this._initPTS),O="audio/mp4";if(w&&(_=D=1/0),h.config&&p.length&&(h.timescale=h.samplerate,h.isAAC||(C.mpeg?(O="audio/mpeg",h.codec=""):C.mp3&&(h.codec="mp3")),I.audio={id:"audio",container:O,codec:h.codec,initSegment:!h.isAAC&&C.mpeg?new Uint8Array(0):s.default.initSegment([h]),metadata:{channelCount:h.channelCount}},w&&(c=h.inputTimeScale,_=D=p[0].pts-Math.round(c*k))),b.sps&&b.pps&&S.length&&(b.timescale=b.inputTimeScale,I.video={id:"main",container:"video/mp4",codec:b.codec,initSegment:s.default.initSegment([b]),metadata:{width:b.width,height:b.height}},w)){c=b.inputTimeScale;var x=this.getVideoStartPts(S),P=Math.round(c*k);D=Math.min(D,o(S[0].dts,x)-P),_=Math.min(_,x-P)}if(Object.keys(I).length)return this.ISGenerated=!0,w&&(this._initPTS=_,this._initDTS=D),{tracks:I,initPTS:_,timescale:c}},m.remuxVideo=function(h,b,k,_){var D,c,p,S=h.inputTimeScale,C=h.samples,I=[],w=C.length,O=this._initPTS,x=this.nextAvcDts,P=8,F=Number.POSITIVE_INFINITY,N=Number.NEGATIVE_INFINITY,U=0,j=!1;k&&x!==null||(x=b*S-(C[0].pts-o(C[0].dts,C[0].pts)));for(var V=0;V<w;V++){var z=C[V];z.pts=o(z.pts-O,x),z.dts=o(z.dts-O,x),z.dts>z.pts&&(U=Math.max(Math.min(U,z.pts-z.dts),-18e3)),z.dts<C[V>0?V-1:V].dts&&(j=!0)}j&&C.sort(function(ut,jt){var No=ut.dts-jt.dts,Bo=ut.pts-jt.pts;return No||Bo}),c=C[0].dts,p=C[C.length-1].dts;var G=Math.round((p-c)/(w-1));if(U<0){if(U<-2*G){y.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+Object(T.toMsFromMpegTsClock)(-G,!0)+" ms");for(var W=U,$=0;$<w;$++)C[$].dts=W=Math.max(W,C[$].pts-G),C[$].pts=Math.max(W,C[$].pts)}else{y.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Object(T.toMsFromMpegTsClock)(U,!0)+" ms to overcome this issue");for(var Y=0;Y<w;Y++)C[Y].dts=C[Y].dts+U}c=C[0].dts}if(k){var re=c-x,ue=re>G;if(ue||re<-1){ue?y.logger.warn("AVC: "+Object(T.toMsFromMpegTsClock)(re,!0)+" ms ("+re+"dts) hole between fragments detected, filling it"):y.logger.warn("AVC: "+Object(T.toMsFromMpegTsClock)(-re,!0)+" ms ("+re+"dts) overlapping between fragments detected"),c=x;var oe=C[0].pts-re;C[0].dts=c,C[0].pts=oe,y.logger.log("Video: First PTS/DTS adjusted: "+Object(T.toMsFromMpegTsClock)(oe,!0)+"/"+Object(T.toMsFromMpegTsClock)(c,!0)+", delta: "+Object(T.toMsFromMpegTsClock)(re,!0)+" ms")}}R&&(c=Math.max(0,c));for(var M=0,B=0,K=0;K<w;K++){for(var H=C[K],q=H.units,Q=q.length,J=0,Z=0;Z<Q;Z++)J+=q[Z].data.length;B+=J,M+=Q,H.length=J,H.dts=Math.max(H.dts,c),H.pts=Math.max(H.pts,H.dts,0),F=Math.min(H.pts,F),N=Math.max(H.pts,N)}p=C[w-1].dts;var te,X=B+4*M+8;try{te=new Uint8Array(X)}catch{return void this.observer.emit(u.Events.ERROR,u.Events.ERROR,{type:A.ErrorTypes.MUX_ERROR,details:A.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:X,reason:"fail allocating video mdat "+X})}var le=new DataView(te.buffer);le.setUint32(0,X),te.set(s.default.types.mdat,4);for(var ie=0;ie<w;ie++){for(var ae=C[ie],ce=ae.units,de=0,ge=0,pe=ce.length;ge<pe;ge++){var Te=ce[ge],Le=Te.data,Ye=Te.data.byteLength;le.setUint32(P,Ye),P+=4,te.set(Le,P),P+=Ye,de+=4+Ye}if(ie<w-1)D=C[ie+1].dts-ae.dts;else{var Et=this.config,Be=ae.dts-C[ie>0?ie-1:ie].dts;if(Et.stretchShortVideoTrack&&this.nextAudioPts!==null){var Ct=Math.floor(Et.maxBufferHole*S),ke=(_?F+_*S:this.nextAudioPts)-ae.pts;ke>Ct?((D=ke-Be)<0&&(D=Be),y.logger.log("[mp4-remuxer]: It is approximately "+ke/90+" ms to the next segment; using duration "+D/90+" ms for the last video frame.")):D=Be}else D=Be}var Ie=Math.round(ae.pts-ae.dts);I.push(new f(ae.key,D,de,Ie))}if(I.length&&d&&d<70){var Je=I[0].flags;Je.dependsOn=2,Je.isNonSync=0}console.assert(D!==void 0,"mp4SampleDuration must be computed"),this.nextAvcDts=x=p+D,this.isVideoContiguous=!0;var Gt={data1:s.default.moof(h.sequenceNumber++,c,v({},h,{samples:I})),data2:te,startPTS:F/S,endPTS:(N+D)/S,startDTS:c/S,endDTS:x/S,type:"video",hasAudio:!1,hasVideo:!0,nb:I.length,dropped:h.dropped};return h.samples=[],h.dropped=0,console.assert(te.length,"MDAT length must not be zero"),Gt},m.remuxAudio=function(h,b,k,_,D){var c=h.inputTimeScale,p=c/(h.samplerate?h.samplerate:c),S=h.isAAC?1024:1152,C=S*p,I=this._initPTS,w=!h.isAAC&&this.typeSupported.mpeg,O=[],x=h.samples,P=w?0:8,F=this.nextAudioPts||-1,N=b*c;if(this.isAudioContiguous=k=k||x.length&&F>0&&(_&&Math.abs(N-F)<9e3||Math.abs(o(x[0].pts-I,N)-F)<20*C),x.forEach(function(Le){Le.pts=o(Le.pts-I,N)}),!k||F<0){if(!(x=x.filter(function(Le){return Le.pts>=0})).length)return;F=D===0?0:_?Math.max(0,N):x[0].pts}if(h.isAAC)for(var U=D!==void 0,j=this.config.maxAudioFramesDrift,V=0,z=F;V<x.length;V++){var G=x[V],W=G.pts,$=W-z,Y=Math.abs(1e3*$/c);if($<=-j*C&&U)V===0&&(y.logger.warn("Audio frame @ "+(W/c).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*$/c)+" ms."),this.nextAudioPts=F=z=W);else if($>=j*C&&Y<1e4&&U){var re=Math.round($/C);(z=W-re*C)<0&&(re--,z+=C),V===0&&(this.nextAudioPts=F=z),y.logger.warn("[mp4-remuxer]: Injecting "+re+" audio frame @ "+(z/c).toFixed(3)+"s due to "+Math.round(1e3*$/c)+" ms gap.");for(var ue=0;ue<re;ue++){var oe=Math.max(z,0),M=n.default.getSilentFrame(h.manifestCodec||h.codec,h.channelCount);M||(y.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),M=G.unit.subarray()),x.splice(V,0,{unit:M,pts:oe}),z+=C,V++}}G.pts=z,z+=C}for(var B,K=null,H=null,q=0,Q=x.length;Q--;)q+=x[Q].unit.byteLength;for(var J=0,Z=x.length;J<Z;J++){var te=x[J],X=te.unit,le=te.pts;if(H!==null)O[J-1].duration=Math.round((le-H)/p);else{if(k&&h.isAAC&&(le=F),K=le,!(q>0))return;q+=P;try{B=new Uint8Array(q)}catch{return void this.observer.emit(u.Events.ERROR,u.Events.ERROR,{type:A.ErrorTypes.MUX_ERROR,details:A.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:q,reason:"fail allocating audio mdat "+q})}w||(new DataView(B.buffer).setUint32(0,q),B.set(s.default.types.mdat,4))}B.set(X,P);var ie=X.byteLength;P+=ie,O.push(new f(!0,S,ie,0)),H=le}var ae=O.length;if(ae){var ce=O[O.length-1];this.nextAudioPts=F=H+p*ce.duration;var de=w?new Uint8Array(0):s.default.moof(h.sequenceNumber++,K/p,v({},h,{samples:O}));h.samples=[];var ge=K/c,pe=F/c,Te={data1:de,data2:B,startPTS:ge,endPTS:pe,startDTS:ge,endDTS:pe,type:"audio",hasAudio:!0,hasVideo:!1,nb:ae};return this.isAudioContiguous=!0,console.assert(B.length,"MDAT length must not be zero"),Te}},m.remuxEmptyAudio=function(h,b,k,_){var D=h.inputTimeScale,c=D/(h.samplerate?h.samplerate:D),p=this.nextAudioPts,S=(p!==null?p:_.startDTS*D)+this._initDTS,C=_.endDTS*D+this._initDTS,I=1024*c,w=Math.ceil((C-S)/I),O=n.default.getSilentFrame(h.manifestCodec||h.codec,h.channelCount);if(y.logger.warn("[mp4-remuxer]: remux empty Audio"),O){for(var x=[],P=0;P<w;P++){var F=S+P*I;x.push({unit:O,pts:F,dts:F})}return h.samples=x,this.remuxAudio(h,b,k,!1)}y.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec")},m.remuxID3=function(h,b){var k=h.samples.length;if(k){for(var _=h.inputTimeScale,D=this._initPTS,c=this._initDTS,p=0;p<k;p++){var S=h.samples[p];S.pts=o(S.pts-D,b*_)/_,S.dts=o(S.dts-c,b*_)/_}var C=h.samples;return h.samples=[],{samples:C}}},m.remuxText=function(h,b){var k=h.samples.length;if(k){for(var _=h.inputTimeScale,D=this._initPTS,c=0;c<k;c++){var p=h.samples[c];p.pts=o(p.pts-D,b*_)/_}h.samples.sort(function(C,I){return C.pts-I.pts});var S=h.samples;return h.samples=[],{samples:S}}},g}();function o(g,m){var h;if(m===null)return g;for(h=m<g?-8589934592:8589934592;Math.abs(g-m)>4294967296;)g+=h;return g}var f=function(g,m,h,b){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=m,this.size=h,this.cts=b,this.flags=new l(g)},l=function(g){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=g?2:1,this.isNonSync=g?0:1}},"./src/remux/passthrough-remuxer.ts":function(e,t,r){r.r(t);var i=r("./src/polyfills/number.ts"),n=r("./src/utils/mp4-tools.ts"),s=r("./src/loader/fragment.ts"),u=r("./src/utils/logger.ts"),A=function(){function T(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndDTS=null}var v=T.prototype;return v.destroy=function(){},v.resetTimeStamp=function(d){this.initPTS=d,this.lastEndDTS=null},v.resetNextTimestamp=function(){this.lastEndDTS=null},v.resetInitSegment=function(d,L,R){this.audioCodec=L,this.videoCodec=R,this.generateInitSegment(d),this.emitInitSegment=!0},v.generateInitSegment=function(d){var L=this.audioCodec,R=this.videoCodec;if(!d||!d.byteLength)return this.initTracks=void 0,void(this.initData=void 0);var E=this.initData=Object(n.parseInitSegment)(d);L||(L=a(E.audio,s.ElementaryStreamTypes.AUDIO)),R||(R=a(E.video,s.ElementaryStreamTypes.VIDEO));var o={};E.audio&&E.video?o.audiovideo={container:"video/mp4",codec:L+","+R,initSegment:d,id:"main"}:E.audio?o.audio={container:"audio/mp4",codec:L,initSegment:d,id:"audio"}:E.video?o.video={container:"video/mp4",codec:R,initSegment:d,id:"main"}:u.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=o},v.remux=function(d,L,R,E,o){var f=this.initPTS,l=this.lastEndDTS,g={audio:void 0,video:void 0,text:E,id3:R,initSegment:void 0};Object(i.isFiniteNumber)(l)||(l=this.lastEndDTS=o||0);var m=L.samples;if(!m||!m.length)return g;var h={initPTS:void 0,timescale:1},b=this.initData;if(b&&b.length||(this.generateInitSegment(m),b=this.initData),!b||!b.length)return u.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),g;this.emitInitSegment&&(h.tracks=this.initTracks,this.emitInitSegment=!1),Object(i.isFiniteNumber)(f)||(this.initPTS=h.initPTS=f=y(b,m,l));var k=Object(n.getDuration)(m,b),_=l,D=k+_;Object(n.offsetStartDTS)(b,m,f),k>0?this.lastEndDTS=D:(u.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var c=!!b.audio,p=!!b.video,S="";c&&(S+="audio"),p&&(S+="video");var C={data1:m,startPTS:_,startDTS:_,endPTS:D,endDTS:D,type:S,hasAudio:c,hasVideo:p,nb:1,dropped:0};return g.audio=C.type==="audio"?C:void 0,g.video=C.type!=="audio"?C:void 0,g.text=E,g.id3=R,g.initSegment=h,g},T}(),y=function(T,v,d){return Object(n.getStartDTS)(T,v)-d};function a(T,v){var d=T==null?void 0:T.codec;return d&&d.length>4?d:d==="hvc1"?"hvc1.1.c.L120.90":d==="av01"?"av01.0.04M.08":d==="avc1"||v===s.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}t.default=A},"./src/task-loop.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return i});var i=function(){function n(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var s=n.prototype;return s.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},s.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},s.onHandlerDestroyed=function(){},s.hasInterval=function(){return!!this._tickInterval},s.hasNextTick=function(){return!!this._tickTimer},s.setInterval=function(u){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,u),!0)},s.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},s.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},s.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},s.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},s.doTick=function(){},n}()},"./src/types/level.ts":function(e,t,r){function i(a,T){for(var v=0;v<T.length;v++){var d=T[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}var n,s;function u(a,T){var v=a.canSkipUntil,d=a.canSkipDateRanges,L=a.endSN;return v&&(T!==void 0?T-L:0)<v?d?n.v2:n.Yes:n.No}r.r(t),r.d(t,"HlsSkip",function(){return n}),r.d(t,"getSkipValue",function(){return u}),r.d(t,"HlsUrlParameters",function(){return A}),r.d(t,"Level",function(){return y}),(s=n||(n={})).No="",s.Yes="YES",s.v2="v2";var A=function(){function a(T,v,d){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=T,this.part=v,this.skip=d}return a.prototype.addDirectives=function(T){var v=new self.URL(T);return this.msn!==void 0&&v.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&v.searchParams.set("_HLS_part",this.part.toString()),this.skip&&v.searchParams.set("_HLS_skip",this.skip),v.toString()},a}(),y=function(){function a(d){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[d.url],this.attrs=d.attrs,this.bitrate=d.bitrate,d.details&&(this.details=d.details),this.id=d.id||0,this.name=d.name,this.width=d.width||0,this.height=d.height||0,this.audioCodec=d.audioCodec,this.videoCodec=d.videoCodec,this.unknownCodecs=d.unknownCodecs,this.codecSet=[d.videoCodec,d.audioCodec].filter(function(L){return L}).join(",").replace(/\.[^.,]+/g,"")}var T,v;return T=a,(v=[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(d){var L=d%this.url.length;this._urlId!==L&&(this.details=void 0,this._urlId=L)}}])&&i(T.prototype,v),a}()},"./src/types/loader.ts":function(e,t,r){var i,n,s,u;r.r(t),r.d(t,"PlaylistContextType",function(){return i}),r.d(t,"PlaylistLevelType",function(){return s}),(n=i||(i={})).MANIFEST="manifest",n.LEVEL="level",n.AUDIO_TRACK="audioTrack",n.SUBTITLE_TRACK="subtitleTrack",(u=s||(s={})).MAIN="main",u.AUDIO="audio",u.SUBTITLE="subtitle"},"./src/types/transmuxer.ts":function(e,t,r){r.r(t),r.d(t,"ChunkMetadata",function(){return i});var i=function(n,s,u,A,y,a){A===void 0&&(A=0),y===void 0&&(y=-1),a===void 0&&(a=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=n,this.sn=s,this.id=u,this.size=A,this.part=y,this.partial=a}},"./src/utils/attr-list.ts":function(e,t,r){r.r(t),r.d(t,"AttrList",function(){return s});var i=/^(\d+)x(\d+)$/,n=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,s=function(){function u(y){for(var a in typeof y=="string"&&(y=u.parseAttrList(y)),y)y.hasOwnProperty(a)&&(this[a]=y[a])}var A=u.prototype;return A.decimalInteger=function(y){var a=parseInt(this[y],10);return a>Number.MAX_SAFE_INTEGER?1/0:a},A.hexadecimalInteger=function(y){if(this[y]){var a=(this[y]||"0x").slice(2);a=(1&a.length?"0":"")+a;for(var T=new Uint8Array(a.length/2),v=0;v<a.length/2;v++)T[v]=parseInt(a.slice(2*v,2*v+2),16);return T}return null},A.hexadecimalIntegerAsNumber=function(y){var a=parseInt(this[y],16);return a>Number.MAX_SAFE_INTEGER?1/0:a},A.decimalFloatingPoint=function(y){return parseFloat(this[y])},A.optionalFloat=function(y,a){var T=this[y];return T?parseFloat(T):a},A.enumeratedString=function(y){return this[y]},A.bool=function(y){return this[y]==="YES"},A.decimalResolution=function(y){var a=i.exec(this[y]);if(a!==null)return{width:parseInt(a[1],10),height:parseInt(a[2],10)}},u.parseAttrList=function(y){var a,T={};for(n.lastIndex=0;(a=n.exec(y))!==null;){var v=a[2];v.indexOf('"')===0&&v.lastIndexOf('"')===v.length-1&&(v=v.slice(1,-1)),T[a[1]]=v}return T},u}()},"./src/utils/binary-search.ts":function(e,t,r){r.r(t),t.default={search:function(i,n){for(var s=0,u=i.length-1,A=null,y=null;s<=u;){var a=n(y=i[A=(s+u)/2|0]);if(a>0)s=A+1;else{if(!(a<0))return y;u=A-1}}return null}}},"./src/utils/buffer-helper.ts":function(e,t,r){r.r(t),r.d(t,"BufferHelper",function(){return s});var i=r("./src/utils/logger.ts"),n={length:0,start:function(){return 0},end:function(){return 0}},s=function(){function u(){}return u.isBuffered=function(A,y){try{if(A){for(var a=u.getBuffered(A),T=0;T<a.length;T++)if(y>=a.start(T)&&y<=a.end(T))return!0}}catch{}return!1},u.bufferInfo=function(A,y,a){try{if(A){var T,v=u.getBuffered(A),d=[];for(T=0;T<v.length;T++)d.push({start:v.start(T),end:v.end(T)});return this.bufferedInfo(d,y,a)}}catch{}return{len:0,start:y,end:y,nextStart:void 0}},u.bufferedInfo=function(A,y,a){y=Math.max(0,y),A.sort(function(h,b){var k=h.start-b.start;return k||b.end-h.end});var T=[];if(a)for(var v=0;v<A.length;v++){var d=T.length;if(d){var L=T[d-1].end;A[v].start-L<a?A[v].end>L&&(T[d-1].end=A[v].end):T.push(A[v])}else T.push(A[v])}else T=A;for(var R,E=0,o=y,f=y,l=0;l<T.length;l++){var g=T[l].start,m=T[l].end;if(y+a>=g&&y<m)o=g,E=(f=m)-y;else if(y+a<g){R=g;break}}return{len:E,start:o||0,end:f||0,nextStart:R}},u.getBuffered=function(A){try{return A.buffered}catch(y){return i.logger.log("failed to get media.buffered",y),n}},u}()},"./src/utils/cea-608-parser.ts":function(e,t,r){r.r(t),r.d(t,"Row",function(){return g}),r.d(t,"CaptionScreen",function(){return m});var i,n,s=r("./src/utils/logger.ts"),u={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},A=function(D){var c=D;return u.hasOwnProperty(D)&&(c=u[D]),String.fromCharCode(c)},y=15,a=100,T={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},v={17:2,18:4,21:6,22:8,23:10,19:13,20:15},d={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},L={25:2,26:4,29:6,30:8,31:10,27:13,28:15},R=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];(n=i||(i={}))[n.ERROR=0]="ERROR",n[n.TEXT=1]="TEXT",n[n.WARNING=2]="WARNING",n[n.INFO=2]="INFO",n[n.DEBUG=3]="DEBUG",n[n.DATA=3]="DATA";var E=function(){function D(){this.time=null,this.verboseLevel=i.ERROR}return D.prototype.log=function(c,p){this.verboseLevel>=c&&s.logger.log(this.time+" ["+c+"] "+p)},D}(),o=function(D){for(var c=[],p=0;p<D.length;p++)c.push(D[p].toString(16));return c},f=function(){function D(p,S,C,I,w){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=p||"white",this.underline=S||!1,this.italics=C||!1,this.background=I||"black",this.flash=w||!1}var c=D.prototype;return c.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},c.setStyles=function(p){for(var S=["foreground","underline","italics","background","flash"],C=0;C<S.length;C++){var I=S[C];p.hasOwnProperty(I)&&(this[I]=p[I])}},c.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},c.equals=function(p){return this.foreground===p.foreground&&this.underline===p.underline&&this.italics===p.italics&&this.background===p.background&&this.flash===p.flash},c.copy=function(p){this.foreground=p.foreground,this.underline=p.underline,this.italics=p.italics,this.background=p.background,this.flash=p.flash},c.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},D}(),l=function(){function D(p,S,C,I,w,O){this.uchar=void 0,this.penState=void 0,this.uchar=p||" ",this.penState=new f(S,C,I,w,O)}var c=D.prototype;return c.reset=function(){this.uchar=" ",this.penState.reset()},c.setChar=function(p,S){this.uchar=p,this.penState.copy(S)},c.setPenState=function(p){this.penState.copy(p)},c.equals=function(p){return this.uchar===p.uchar&&this.penState.equals(p.penState)},c.copy=function(p){this.uchar=p.uchar,this.penState.copy(p.penState)},c.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},D}(),g=function(){function D(p){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var S=0;S<a;S++)this.chars.push(new l);this.logger=p,this.pos=0,this.currPenState=new f}var c=D.prototype;return c.equals=function(p){for(var S=!0,C=0;C<a;C++)if(!this.chars[C].equals(p.chars[C])){S=!1;break}return S},c.copy=function(p){for(var S=0;S<a;S++)this.chars[S].copy(p.chars[S])},c.isEmpty=function(){for(var p=!0,S=0;S<a;S++)if(!this.chars[S].isEmpty()){p=!1;break}return p},c.setCursor=function(p){this.pos!==p&&(this.pos=p),this.pos<0?(this.logger.log(i.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>a&&(this.logger.log(i.DEBUG,"Too large cursor position "+this.pos),this.pos=a)},c.moveCursor=function(p){var S=this.pos+p;if(p>1)for(var C=this.pos+1;C<S+1;C++)this.chars[C].setPenState(this.currPenState);this.setCursor(S)},c.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},c.insertChar=function(p){p>=144&&this.backSpace();var S=A(p);this.pos>=a?this.logger.log(i.ERROR,"Cannot insert "+p.toString(16)+" ("+S+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(S,this.currPenState),this.moveCursor(1))},c.clearFromPos=function(p){var S;for(S=p;S<a;S++)this.chars[S].reset()},c.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},c.clearToEndOfRow=function(){this.clearFromPos(this.pos)},c.getTextString=function(){for(var p=[],S=!0,C=0;C<a;C++){var I=this.chars[C].uchar;I!==" "&&(S=!1),p.push(I)}return S?"":p.join("")},c.setPenStyles=function(p){this.currPenState.setStyles(p),this.chars[this.pos].setPenState(this.currPenState)},D}(),m=function(){function D(p){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var S=0;S<y;S++)this.rows.push(new g(p));this.logger=p,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var c=D.prototype;return c.reset=function(){for(var p=0;p<y;p++)this.rows[p].clear();this.currRow=14},c.equals=function(p){for(var S=!0,C=0;C<y;C++)if(!this.rows[C].equals(p.rows[C])){S=!1;break}return S},c.copy=function(p){for(var S=0;S<y;S++)this.rows[S].copy(p.rows[S])},c.isEmpty=function(){for(var p=!0,S=0;S<y;S++)if(!this.rows[S].isEmpty()){p=!1;break}return p},c.backSpace=function(){this.rows[this.currRow].backSpace()},c.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},c.insertChar=function(p){this.rows[this.currRow].insertChar(p)},c.setPen=function(p){this.rows[this.currRow].setPenStyles(p)},c.moveCursor=function(p){this.rows[this.currRow].moveCursor(p)},c.setCursor=function(p){this.logger.log(i.INFO,"setCursor: "+p),this.rows[this.currRow].setCursor(p)},c.setPAC=function(p){this.logger.log(i.INFO,"pacData = "+JSON.stringify(p));var S=p.row-1;if(this.nrRollUpRows&&S<this.nrRollUpRows-1&&(S=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==S){for(var C=0;C<y;C++)this.rows[C].clear();var I=this.currRow+1-this.nrRollUpRows,w=this.lastOutputScreen;if(w){var O=w.rows[I].cueStartTime,x=this.logger.time;if(O&&x!==null&&O<x)for(var P=0;P<this.nrRollUpRows;P++)this.rows[S-this.nrRollUpRows+P+1].copy(w.rows[I+P])}}this.currRow=S;var F=this.rows[this.currRow];if(p.indent!==null){var N=p.indent,U=Math.max(N-1,0);F.setCursor(p.indent),p.color=F.chars[U].penState.foreground}var j={foreground:p.color,underline:p.underline,italics:p.italics,background:"black",flash:!1};this.setPen(j)},c.setBkgData=function(p){this.logger.log(i.INFO,"bkgData = "+JSON.stringify(p)),this.backSpace(),this.setPen(p),this.insertChar(32)},c.setRollUpRows=function(p){this.nrRollUpRows=p},c.rollUp=function(){if(this.nrRollUpRows!==null){this.logger.log(i.TEXT,this.getDisplayText());var p=this.currRow+1-this.nrRollUpRows,S=this.rows.splice(p,1)[0];S.clear(),this.rows.splice(this.currRow,0,S),this.logger.log(i.INFO,"Rolling up")}else this.logger.log(i.DEBUG,"roll_up but nrRollUpRows not set yet")},c.getDisplayText=function(p){p=p||!1;for(var S=[],C="",I=-1,w=0;w<y;w++){var O=this.rows[w].getTextString();O&&(I=w+1,p?S.push("Row "+I+": '"+O+"'"):S.push(O.trim()))}return S.length>0&&(C=p?"["+S.join(" | ")+"]":S.join(`
`)),C},c.getTextAndFormat=function(){return this.rows},D}(),h=function(){function D(p,S,C){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=p,this.outputFilter=S,this.mode=null,this.verbose=0,this.displayedMemory=new m(C),this.nonDisplayedMemory=new m(C),this.lastOutputScreen=new m(C),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=C}var c=D.prototype;return c.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},c.getHandler=function(){return this.outputFilter},c.setHandler=function(p){this.outputFilter=p},c.setPAC=function(p){this.writeScreen.setPAC(p)},c.setBkgData=function(p){this.writeScreen.setBkgData(p)},c.setMode=function(p){p!==this.mode&&(this.mode=p,this.logger.log(i.INFO,"MODE="+p),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=p)},c.insertChars=function(p){for(var S=0;S<p.length;S++)this.writeScreen.insertChar(p[S]);var C=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(i.INFO,C+": "+this.writeScreen.getDisplayText(!0)),this.mode!=="MODE_PAINT-ON"&&this.mode!=="MODE_ROLL-UP"||(this.logger.log(i.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},c.ccRCL=function(){this.logger.log(i.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},c.ccBS=function(){this.logger.log(i.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},c.ccAOF=function(){},c.ccAON=function(){},c.ccDER=function(){this.logger.log(i.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},c.ccRU=function(p){this.logger.log(i.INFO,"RU("+p+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(p)},c.ccFON=function(){this.logger.log(i.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},c.ccRDC=function(){this.logger.log(i.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},c.ccTR=function(){this.logger.log(i.INFO,"TR"),this.setMode("MODE_TEXT")},c.ccRTD=function(){this.logger.log(i.INFO,"RTD"),this.setMode("MODE_TEXT")},c.ccEDM=function(){this.logger.log(i.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},c.ccCR=function(){this.logger.log(i.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},c.ccENM=function(){this.logger.log(i.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},c.ccEOC=function(){if(this.logger.log(i.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var p=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=p,this.writeScreen=this.nonDisplayedMemory,this.logger.log(i.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},c.ccTO=function(p){this.logger.log(i.INFO,"TO("+p+") - Tab Offset"),this.writeScreen.moveCursor(p)},c.ccMIDROW=function(p){var S={flash:!1};if(S.underline=p%2==1,S.italics=p>=46,S.italics)S.foreground="white";else{var C=Math.floor(p/2)-16;S.foreground=["white","green","blue","cyan","red","yellow","magenta"][C]}this.logger.log(i.INFO,"MIDROW: "+JSON.stringify(S)),this.writeScreen.setPen(S)},c.outputDataUpdate=function(p){p===void 0&&(p=!1);var S=this.logger.time;S!==null&&this.outputFilter&&(this.cueStartTime!==null||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,S,this.lastOutputScreen),p&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:S):this.cueStartTime=S,this.lastOutputScreen.copy(this.displayedMemory))},c.cueSplitAtTime=function(p){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,p,this.displayedMemory),this.cueStartTime=p))},D}(),b=function(){function D(p,S,C){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var I=new E;this.channels=[null,new h(p,S,I),new h(p+1,C,I)],this.cmdHistory={a:null,b:null},this.logger=I}var c=D.prototype;return c.getHandler=function(p){return this.channels[p].getHandler()},c.setHandler=function(p,S){this.channels[p].setHandler(S)},c.addData=function(p,S){var C,I,w,O=!1;this.logger.time=p;for(var x=0;x<S.length;x+=2)if(I=127&S[x],w=127&S[x+1],I!==0||w!==0){if(this.logger.log(i.DATA,"["+o([S[x],S[x+1]])+"] -> ("+o([I,w])+")"),(C=this.parseCmd(I,w))||(C=this.parseMidrow(I,w)),C||(C=this.parsePAC(I,w)),C||(C=this.parseBackgroundAttributes(I,w)),!C&&(O=this.parseChars(I,w))){var P=this.currentChannel;P&&P>0?this.channels[P].insertChars(O):this.logger.log(i.WARNING,"No channel found yet. TEXT-MODE?")}C||O||this.logger.log(i.WARNING,"Couldn't parse cleaned data "+o([I,w])+" orig: "+o([S[x],S[x+1]]))}},c.parseCmd=function(p,S){var C=this.cmdHistory;if(!((p===20||p===28||p===21||p===29)&&S>=32&&S<=47||(p===23||p===31)&&S>=33&&S<=35))return!1;if(_(p,S,C))return k(null,null,C),this.logger.log(i.DEBUG,"Repeated command ("+o([p,S])+") is dropped"),!0;var I=p===20||p===21||p===23?1:2,w=this.channels[I];return p===20||p===21||p===28||p===29?S===32?w.ccRCL():S===33?w.ccBS():S===34?w.ccAOF():S===35?w.ccAON():S===36?w.ccDER():S===37?w.ccRU(2):S===38?w.ccRU(3):S===39?w.ccRU(4):S===40?w.ccFON():S===41?w.ccRDC():S===42?w.ccTR():S===43?w.ccRTD():S===44?w.ccEDM():S===45?w.ccCR():S===46?w.ccENM():S===47&&w.ccEOC():w.ccTO(S-32),k(p,S,C),this.currentChannel=I,!0},c.parseMidrow=function(p,S){var C=0;if((p===17||p===25)&&S>=32&&S<=47){if((C=p===17?1:2)!==this.currentChannel)return this.logger.log(i.ERROR,"Mismatch channel in midrow parsing"),!1;var I=this.channels[C];return!!I&&(I.ccMIDROW(S),this.logger.log(i.DEBUG,"MIDROW ("+o([p,S])+")"),!0)}return!1},c.parsePAC=function(p,S){var C,I=this.cmdHistory;if(!((p>=17&&p<=23||p>=25&&p<=31)&&S>=64&&S<=127||(p===16||p===24)&&S>=64&&S<=95))return!1;if(_(p,S,I))return k(null,null,I),!0;var w=p<=23?1:2;C=S>=64&&S<=95?w===1?T[p]:d[p]:w===1?v[p]:L[p];var O=this.channels[w];return!!O&&(O.setPAC(this.interpretPAC(C,S)),k(p,S,I),this.currentChannel=w,!0)},c.interpretPAC=function(p,S){var C,I={color:null,italics:!1,indent:null,underline:!1,row:p};return C=S>95?S-96:S-64,I.underline=(1&C)==1,C<=13?I.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(C/2)]:C<=15?(I.italics=!0,I.color="white"):I.indent=4*Math.floor((C-16)/2),I},c.parseChars=function(p,S){var C,I,w=null,O=null;if(p>=25?(C=2,O=p-8):(C=1,O=p),O>=17&&O<=19?(I=O===17?S+80:O===18?S+112:S+144,this.logger.log(i.INFO,"Special char '"+A(I)+"' in channel "+C),w=[I]):p>=32&&p<=127&&(w=S===0?[p]:[p,S]),w){var x=o(w);this.logger.log(i.DEBUG,"Char codes =  "+x.join(",")),k(p,S,this.cmdHistory)}return w},c.parseBackgroundAttributes=function(p,S){var C;if(!((p===16||p===24)&&S>=32&&S<=47||(p===23||p===31)&&S>=45&&S<=47))return!1;var I={};p===16||p===24?(C=Math.floor((S-32)/2),I.background=R[C],S%2==1&&(I.background=I.background+"_semi")):S===45?I.background="transparent":(I.foreground="black",S===47&&(I.underline=!0));var w=p<=23?1:2;return this.channels[w].setBkgData(I),k(p,S,this.cmdHistory),!0},c.reset=function(){for(var p=0;p<Object.keys(this.channels).length;p++){var S=this.channels[p];S&&S.reset()}this.cmdHistory={a:null,b:null}},c.cueSplitAtTime=function(p){for(var S=0;S<this.channels.length;S++){var C=this.channels[S];C&&C.cueSplitAtTime(p)}},D}();function k(D,c,p){p.a=D,p.b=c}function _(D,c,p){return p.a===D&&p.b===c}t.default=b},"./src/utils/codecs.ts":function(e,t,r){r.r(t),r.d(t,"isCodecType",function(){return n}),r.d(t,"isCodecSupportedInMp4",function(){return s});var i={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function n(u,A){var y=i[A];return!!y&&y[u.slice(0,4)]===!0}function s(u,A){return MediaSource.isTypeSupported((A||"video")+'/mp4;codecs="'+u+'"')}},"./src/utils/cues.ts":function(e,t,r){r.r(t);var i=r("./src/utils/vttparser.ts"),n=r("./src/utils/webvtt-parser.ts"),s=r("./src/utils/texttrack-utils.ts"),u=/\s/,A={newCue:function(y,a,T,v){for(var d,L,R,E,o,f=[],l=self.VTTCue||self.TextTrackCue,g=0;g<v.rows.length;g++)if(R=!0,E=0,o="",!(d=v.rows[g]).isEmpty()){for(var m=0;m<d.chars.length;m++)u.test(d.chars[m].uchar)&&R?E++:(o+=d.chars[m].uchar,R=!1);d.cueStartTime=a,a===T&&(T+=1e-4),E>=16?E--:E++;var h=Object(i.fixLineBreaks)(o.trim()),b=Object(n.generateCueId)(a,T,h);y&&y.cues&&y.cues.getCueById(b)||((L=new l(a,T,h)).id=b,L.line=g+1,L.align="left",L.position=10+Math.min(80,10*Math.floor(8*E/32)),f.push(L))}return y&&f.length&&(f.sort(function(k,_){return k.line==="auto"||_.line==="auto"?0:k.line>8&&_.line>8?_.line-k.line:k.line-_.line}),f.forEach(function(k){return Object(s.addCueToTrack)(y,k)})),f}};t.default=A},"./src/utils/discontinuities.ts":function(e,t,r){r.r(t),r.d(t,"findFirstFragWithCC",function(){return u}),r.d(t,"shouldAlignOnDiscontinuities",function(){return A}),r.d(t,"findDiscontinuousReferenceFrag",function(){return y}),r.d(t,"adjustSlidingStart",function(){return T}),r.d(t,"alignStream",function(){return v}),r.d(t,"alignPDT",function(){return d});var i=r("./src/polyfills/number.ts"),n=r("./src/utils/logger.ts"),s=r("./src/controller/level-helper.ts");function u(L,R){for(var E=null,o=0,f=L.length;o<f;o++){var l=L[o];if(l&&l.cc===R){E=l;break}}return E}function A(L,R,E){return!(!R.details||!(E.endCC>E.startCC||L&&L.cc<E.startCC))}function y(L,R){var E=L.fragments,o=R.fragments;if(o.length&&E.length){var f=u(E,o[0].cc);if(f&&(!f||f.startPTS))return f;n.logger.log("No frag in previous level to align on")}else n.logger.log("No fragments to align")}function a(L,R){if(L){var E=L.start+R;L.start=L.startPTS=E,L.endPTS=E+L.duration}}function T(L,R){for(var E=R.fragments,o=0,f=E.length;o<f;o++)a(E[o],L);R.fragmentHint&&a(R.fragmentHint,L),R.alignedSliding=!0}function v(L,R,E){R&&(function(o,f,l){if(A(o,l,f)){var g=y(l.details,f);g&&Object(i.isFiniteNumber)(g.start)&&(n.logger.log("Adjusting PTS using last level due to CC increase within current level "+f.url),T(g.start,f))}}(L,E,R),!E.alignedSliding&&R.details&&d(E,R.details),E.alignedSliding||!R.details||E.skippedSegments||Object(s.adjustSliding)(R.details,E))}function d(L,R){if(R.fragments.length&&L.hasProgramDateTime&&R.hasProgramDateTime){var E=R.fragments[0].programDateTime,o=L.fragments[0].programDateTime,f=(o-E)/1e3+R.fragments[0].start;f&&Object(i.isFiniteNumber)(f)&&(n.logger.log("Adjusting PTS using programDateTime delta "+(o-E)+"ms, sliding:"+f.toFixed(3)+" "+L.url+" "),T(f,L))}}},"./src/utils/ewma-bandwidth-estimator.ts":function(e,t,r){r.r(t);var i=r("./src/utils/ewma.ts"),n=function(){function s(A,y,a){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=a,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new i.default(A),this.fast_=new i.default(y)}var u=s.prototype;return u.update=function(A,y){var a=this.slow_,T=this.fast_;this.slow_.halfLife!==A&&(this.slow_=new i.default(A,a.getEstimate(),a.getTotalWeight())),this.fast_.halfLife!==y&&(this.fast_=new i.default(y,T.getEstimate(),T.getTotalWeight()))},u.sample=function(A,y){var a=(A=Math.max(A,this.minDelayMs_))/1e3,T=8*y/a;this.fast_.sample(a,T),this.slow_.sample(a,T)},u.canEstimate=function(){var A=this.fast_;return A&&A.getTotalWeight()>=this.minWeight_},u.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},u.destroy=function(){},s}();t.default=n},"./src/utils/ewma.ts":function(e,t,r){r.r(t);var i=function(){function n(u,A,y){A===void 0&&(A=0),y===void 0&&(y=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=u,this.alpha_=u?Math.exp(Math.log(.5)/u):0,this.estimate_=A,this.totalWeight_=y}var s=n.prototype;return s.sample=function(u,A){var y=Math.pow(this.alpha_,u);this.estimate_=A*(1-y)+y*this.estimate_,this.totalWeight_+=u},s.getTotalWeight=function(){return this.totalWeight_},s.getEstimate=function(){if(this.alpha_){var u=1-Math.pow(this.alpha_,this.totalWeight_);if(u)return this.estimate_/u}return this.estimate_},n}();t.default=i},"./src/utils/fetch-loader.ts":function(e,t,r){r.r(t),r.d(t,"fetchSupported",function(){return v});var i=r("./src/polyfills/number.ts"),n=r("./src/loader/load-stats.ts"),s=r("./src/demux/chunk-cache.ts");function u(E){var o=typeof Map=="function"?new Map:void 0;return(u=function(f){if(f===null||(l=f,Function.toString.call(l).indexOf("[native code]")===-1))return f;var l;if(typeof f!="function")throw new TypeError("Super expression must either be null or a function");if(o!==void 0){if(o.has(f))return o.get(f);o.set(f,g)}function g(){return A(f,arguments,T(this).constructor)}return g.prototype=Object.create(f.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),a(g,f)})(E)}function A(E,o,f){return(A=y()?Reflect.construct:function(l,g,m){var h=[null];h.push.apply(h,g);var b=new(Function.bind.apply(l,h));return m&&a(b,m.prototype),b}).apply(null,arguments)}function y(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function a(E,o){return(a=Object.setPrototypeOf||function(f,l){return f.__proto__=l,f})(E,o)}function T(E){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(E)}function v(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}var d=function(){function E(f){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=f.fetchSetup||L,this.controller=new self.AbortController,this.stats=new n.LoadStats}var o=E.prototype;return o.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},o.abortInternal=function(){var f=this.response;f&&f.ok||(this.stats.aborted=!0,this.controller.abort())},o.abort=function(){var f;this.abortInternal(),(f=this.callbacks)!==null&&f!==void 0&&f.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},o.load=function(f,l,g){var m=this,h=this.stats;if(h.loading.start)throw new Error("Loader can only be used once.");h.loading.start=self.performance.now();var b=function(c,p){var S={method:"GET",mode:"cors",credentials:"same-origin",signal:p};return c.rangeEnd&&(S.headers=new self.Headers({Range:"bytes="+c.rangeStart+"-"+String(c.rangeEnd-1)})),S}(f,this.controller.signal),k=g.onProgress,_=f.responseType==="arraybuffer",D=_?"byteLength":"length";this.context=f,this.config=l,this.callbacks=g,this.request=this.fetchSetup(f,b),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){m.abortInternal(),g.onTimeout(h,f,m.response)},l.timeout),self.fetch(this.request).then(function(c){if(m.response=m.loader=c,!c.ok){var p=c.status,S=c.statusText;throw new R(S||"fetch, bad network response",p,c)}return h.loading.first=Math.max(self.performance.now(),h.loading.start),h.total=parseInt(c.headers.get("Content-Length")||"0"),k&&Object(i.isFiniteNumber)(l.highWaterMark)?m.loadProgressively(c,h,f,l.highWaterMark,k):_?c.arrayBuffer():c.text()}).then(function(c){var p=m.response;self.clearTimeout(m.requestTimeout),h.loading.end=Math.max(self.performance.now(),h.loading.first),h.loaded=h.total=c[D];var S={url:p.url,data:c};k&&!Object(i.isFiniteNumber)(l.highWaterMark)&&k(h,f,c,p),g.onSuccess(S,h,f,p)}).catch(function(c){if(self.clearTimeout(m.requestTimeout),!h.aborted){var p=c.code||0;g.onError({code:p,text:c.message},f,c.details)}})},o.getCacheAge=function(){var f=null;if(this.response){var l=this.response.headers.get("age");f=l?parseFloat(l):null}return f},o.loadProgressively=function(f,l,g,m,h){m===void 0&&(m=0);var b=new s.default,k=f.body.getReader();return function _(){return k.read().then(function(D){if(D.done)return b.dataLength&&h(l,g,b.flush(),f),Promise.resolve(new ArrayBuffer(0));var c=D.value,p=c.length;return l.loaded+=p,p<m||b.dataLength?(b.push(c),b.dataLength>=m&&h(l,g,b.flush(),f)):h(l,g,c,f),_()}).catch(function(){return Promise.reject()})}()},E}();function L(E,o){return new self.Request(E.url,o)}var R=function(E){var o,f;function l(g,m,h){var b;return(b=E.call(this,g)||this).code=void 0,b.details=void 0,b.code=m,b.details=h,b}return f=E,(o=l).prototype=Object.create(f.prototype),o.prototype.constructor=o,a(o,f),l}(u(Error));t.default=d},"./src/utils/imsc1-ttml-parser.ts":function(e,t,r){r.r(t),r.d(t,"IMSC1_CODEC",function(){return T}),r.d(t,"parseIMSC1",function(){return R});var i=r("./src/utils/mp4-tools.ts"),n=r("./src/utils/vttparser.ts"),s=r("./src/utils/vttcue.ts"),u=r("./src/demux/id3.ts"),A=r("./src/utils/timescale-conversion.ts"),y=r("./src/utils/webvtt-parser.ts");function a(){return(a=Object.assign||function(h){for(var b=1;b<arguments.length;b++){var k=arguments[b];for(var _ in k)Object.prototype.hasOwnProperty.call(k,_)&&(h[_]=k[_])}return h}).apply(this,arguments)}var T="stpp.ttml.im1t",v=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,d=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,L={left:"start",center:"center",right:"end",start:"start",end:"end"};function R(h,b,k,_,D){var c=Object(i.findBox)(new Uint8Array(h),["mdat"]);if(c.length!==0){var p=c[0],S=Object(u.utf8ArrayToStr)(new Uint8Array(h,p.start,p.end-p.start)),C=Object(A.toTimescaleFromScale)(b,1,k);try{_(function(I,w){var O=new DOMParser().parseFromString(I,"text/xml").getElementsByTagName("tt")[0];if(!O)throw new Error("Invalid ttml");var x={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},P=Object.keys(x).reduce(function(V,z){return V[z]=O.getAttribute("ttp:"+z)||x[z],V},{}),F=O.getAttribute("xml:space")!=="preserve",N=o(E(O,"styling","style")),U=o(E(O,"layout","region")),j=E(O,"body","[begin]");return[].map.call(j,function(V){var z=f(V,F);if(!z||!V.hasAttribute("begin"))return null;var G=m(V.getAttribute("begin"),P),W=m(V.getAttribute("dur"),P),$=m(V.getAttribute("end"),P);if(G===null)throw g(V);if($===null){if(W===null)throw g(V);$=G+W}var Y=new s.default(G-w,$-w,z);Y.id=Object(y.generateCueId)(Y.startTime,Y.endTime,Y.text);var re=U[V.getAttribute("region")],ue=N[V.getAttribute("style")];Y.position=10,Y.size=80;var oe=function(K,H){var q="http://www.w3.org/ns/ttml#styling";return["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce(function(Q,J){var Z=l(H,q,J)||l(K,q,J);return Z&&(Q[J]=Z),Q},{})}(re,ue),M=oe.textAlign;if(M){var B=L[M];B&&(Y.lineAlign=B),Y.align=M}return a(Y,oe),Y}).filter(function(V){return V!==null})}(S,C))}catch(I){D(I)}}else D(new Error("Could not parse IMSC1 mdat"))}function E(h,b,k){var _=h.getElementsByTagName(b)[0];return _?[].slice.call(_.querySelectorAll(k)):[]}function o(h){return h.reduce(function(b,k){var _=k.getAttribute("xml:id");return _&&(b[_]=k),b},{})}function f(h,b){return[].slice.call(h.childNodes).reduce(function(k,_,D){var c;return _.nodeName==="br"&&D?k+`
`:(c=_.childNodes)!==null&&c!==void 0&&c.length?f(_,b):b?k+_.textContent.trim().replace(/\s+/g," "):k+_.textContent},"")}function l(h,b,k){return h.hasAttributeNS(b,k)?h.getAttributeNS(b,k):null}function g(h){return new Error("Could not parse ttml timestamp "+h)}function m(h,b){if(!h)return null;var k=Object(n.parseTimeStamp)(h);return k===null&&(v.test(h)?k=function(_,D){var c=v.exec(_),p=(0|c[4])+(0|c[5])/D.subFrameRate;return 3600*(0|c[1])+60*(0|c[2])+(0|c[3])+p/D.frameRate}(h,b):d.test(h)&&(k=function(_,D){var c=d.exec(_),p=Number(c[1]);switch(c[2]){case"h":return 3600*p;case"m":return 60*p;case"ms":return 1e3*p;case"f":return p/D.frameRate;case"t":return p/D.tickRate}return p}(h,b))),k}},"./src/utils/logger.ts":function(e,t,r){r.r(t),r.d(t,"enableLogs",function(){return A}),r.d(t,"logger",function(){return y});var i=function(){},n={trace:i,debug:i,log:i,warn:i,info:i,error:i},s=n;function u(a){var T=self.console[a];return T?T.bind(self.console,"["+a+"] >"):i}function A(a){if(self.console&&a===!0||typeof a=="object"){(function(T){for(var v=arguments.length,d=new Array(v>1?v-1:0),L=1;L<v;L++)d[L-1]=arguments[L];d.forEach(function(R){s[R]=T[R]?T[R].bind(T):u(R)})})(a,"debug","log","info","warn","error");try{s.log()}catch{s=n}}else s=n}var y=n},"./src/utils/mediakeys-helper.ts":function(e,t,r){var i,n;r.r(t),r.d(t,"KeySystems",function(){return i}),r.d(t,"requestMediaKeySystemAccess",function(){return s}),(n=i||(i={})).WIDEVINE="com.widevine.alpha",n.PLAYREADY="com.microsoft.playready";var s=typeof self<"u"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null},"./src/utils/mediasource-helper.ts":function(e,t,r){function i(){return self.MediaSource||self.WebKitMediaSource}r.r(t),r.d(t,"getMediaSource",function(){return i})},"./src/utils/mp4-tools.ts":function(e,t,r){r.r(t),r.d(t,"bin2str",function(){return A}),r.d(t,"readUint16",function(){return y}),r.d(t,"readUint32",function(){return a}),r.d(t,"writeUint32",function(){return T}),r.d(t,"findBox",function(){return v}),r.d(t,"parseSegmentIndex",function(){return d}),r.d(t,"parseInitSegment",function(){return L}),r.d(t,"getStartDTS",function(){return R}),r.d(t,"getDuration",function(){return E}),r.d(t,"computeRawDurationFromSamples",function(){return o}),r.d(t,"offsetStartDTS",function(){return f}),r.d(t,"segmentValidRange",function(){return l}),r.d(t,"appendUint8Array",function(){return g});var i=r("./src/utils/typed-array.ts"),n=r("./src/loader/fragment.ts"),s=Math.pow(2,32)-1,u=[].push;function A(m){return String.fromCharCode.apply(null,m)}function y(m,h){"data"in m&&(h+=m.start,m=m.data);var b=m[h]<<8|m[h+1];return b<0?65536+b:b}function a(m,h){"data"in m&&(h+=m.start,m=m.data);var b=m[h]<<24|m[h+1]<<16|m[h+2]<<8|m[h+3];return b<0?4294967296+b:b}function T(m,h,b){"data"in m&&(h+=m.start,m=m.data),m[h]=b>>24,m[h+1]=b>>16&255,m[h+2]=b>>8&255,m[h+3]=255&b}function v(m,h){var b,k,_,D=[];if(!h.length)return D;"data"in m?(b=m.data,k=m.start,_=m.end):(k=0,_=(b=m).byteLength);for(var c=k;c<_;){var p=a(b,c),S=p>1?c+p:_;if(A(b.subarray(c+4,c+8))===h[0])if(h.length===1)D.push({data:b,start:c+8,end:S});else{var C=v({data:b,start:c+8,end:S},h.slice(1));C.length&&u.apply(D,C)}c=S}return D}function d(m){var h=v(m,["moov"])[0],b=h?h.end:null,k=v(m,["sidx"]);if(!k||!k[0])return null;var _=[],D=k[0],c=D.data[0],p=c===0?8:16,S=a(D,p);p+=4,p+=c===0?8:16,p+=2;var C=D.end+0,I=y(D,p);p+=2;for(var w=0;w<I;w++){var O=p,x=a(D,O);O+=4;var P=2147483647&x;if((2147483648&x)>>>31==1)return console.warn("SIDX has hierarchical references (not supported)"),null;var F=a(D,O);O+=4,_.push({referenceSize:P,subsegmentDuration:F,info:{duration:F/S,start:C,end:C+P-1}}),C+=P,p=O+=4}return{earliestPresentationTime:0,timescale:S,version:c,referencesCount:I,references:_,moovEndOffset:b}}function L(m){for(var h=[],b=v(m,["moov","trak"]),k=0;k<b.length;k++){var _=b[k],D=v(_,["tkhd"])[0];if(D){var c=D.data[D.start],p=c===0?12:20,S=a(D,p),C=v(_,["mdia","mdhd"])[0];if(C){var I=a(C,p=(c=C.data[C.start])===0?12:20),w=v(_,["mdia","hdlr"])[0];if(w){var O=A(w.data.subarray(w.start+8,w.start+12)),x={soun:n.ElementaryStreamTypes.AUDIO,vide:n.ElementaryStreamTypes.VIDEO}[O];if(x){var P=v(_,["mdia","minf","stbl","stsd"])[0],F=void 0;P&&(F=A(P.data.subarray(P.start+12,P.start+16))),h[S]={timescale:I,type:x},h[x]={timescale:I,id:S,codec:F}}}}}}return v(m,["moov","mvex","trex"]).forEach(function(N){var U=a(N,4),j=h[U];j&&(j.default={duration:a(N,12),flags:a(N,20)})}),h}function R(m,h){return v(h,["moof","traf"]).reduce(function(b,k){var _=v(k,["tfdt"])[0],D=_.data[_.start],c=v(k,["tfhd"]).reduce(function(p,S){var C=a(S,4),I=m[C];if(I){var w=a(_,4);D===1&&(w*=Math.pow(2,32),w+=a(_,8));var O=w/(I.timescale||9e4);if(isFinite(O)&&(p===null||O<p))return O}return p},null);return c!==null&&isFinite(c)&&(b===null||c<b)?c:b},null)||0}function E(m,h){for(var b=0,k=0,_=0,D=v(m,["moof","traf"]),c=0;c<D.length;c++){var p=D[c],S=v(p,["tfhd"])[0],C=h[a(S,4)];if(C){var I=C.default,w=a(S,0)|(I==null?void 0:I.flags),O=I==null?void 0:I.duration;8&w&&(O=a(S,2&w?12:8));for(var x=C.timescale||9e4,P=v(p,["trun"]),F=0;F<P.length;F++)b=O?O*a(P[F],4):o(P[F]),C.type===n.ElementaryStreamTypes.VIDEO?k+=b/x:C.type===n.ElementaryStreamTypes.AUDIO&&(_+=b/x)}}if(k===0&&_===0){var N=d(m);if(N!=null&&N.references)return N.references.reduce(function(U,j){return U+j.info.duration||0},0)}return k||_}function o(m){var h=a(m,0),b=8;1&h&&(b+=4),4&h&&(b+=4);for(var k=0,_=a(m,4),D=0;D<_;D++)256&h&&(k+=a(m,b),b+=4),512&h&&(b+=4),1024&h&&(b+=4),2048&h&&(b+=4);return k}function f(m,h,b){v(h,["moof","traf"]).forEach(function(k){v(k,["tfhd"]).forEach(function(_){var D=a(_,4),c=m[D];if(c){var p=c.timescale||9e4;v(k,["tfdt"]).forEach(function(S){var C=S.data[S.start],I=a(S,4);if(C===0)T(S,4,I-b*p);else{I*=Math.pow(2,32),I+=a(S,8),I-=b*p,I=Math.max(I,0);var w=Math.floor(I/(s+1)),O=Math.floor(I%(s+1));T(S,4,w),T(S,8,O)}})}})})}function l(m){var h={valid:null,remainder:null},b=v(m,["moof"]);if(!b)return h;if(b.length<2)return h.remainder=m,h;var k=b[b.length-1];return h.valid=Object(i.sliceUint8)(m,0,k.start-8),h.remainder=Object(i.sliceUint8)(m,k.start-8),h}function g(m,h){var b=new Uint8Array(m.length+h.length);return b.set(m),b.set(h,m.length),b}},"./src/utils/output-filter.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return i});var i=function(){function n(u,A){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=u,this.trackName=A}var s=n.prototype;return s.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},s.newCue=function(u,A,y){(this.startTime===null||this.startTime>u)&&(this.startTime=u),this.endTime=A,this.screen=y,this.timelineController.createCaptionsTrack(this.trackName)},s.reset=function(){this.cueRanges=[]},n}()},"./src/utils/texttrack-utils.ts":function(e,t,r){r.r(t),r.d(t,"sendAddTrackEvent",function(){return n}),r.d(t,"addCueToTrack",function(){return s}),r.d(t,"clearCurrentCues",function(){return u}),r.d(t,"removeCuesInRange",function(){return A}),r.d(t,"getCuesInRange",function(){return y});var i=r("./src/utils/logger.ts");function n(a,T){var v;try{v=new Event("addtrack")}catch{(v=document.createEvent("Event")).initEvent("addtrack",!1,!1)}v.track=a,T.dispatchEvent(v)}function s(a,T){var v=a.mode;if(v==="disabled"&&(a.mode="hidden"),a.cues&&!a.cues.getCueById(T.id))try{if(a.addCue(T),!a.cues.getCueById(T.id))throw new Error("addCue is failed for: "+T)}catch(L){i.logger.debug("[texttrack-utils]: "+L);var d=new self.TextTrackCue(T.startTime,T.endTime,T.text);d.id=T.id,a.addCue(d)}v==="disabled"&&(a.mode=v)}function u(a){var T=a.mode;if(T==="disabled"&&(a.mode="hidden"),a.cues)for(var v=a.cues.length;v--;)a.removeCue(a.cues[v]);T==="disabled"&&(a.mode=T)}function A(a,T,v){var d=a.mode;if(d==="disabled"&&(a.mode="hidden"),a.cues&&a.cues.length>0)for(var L=y(a.cues,T,v),R=0;R<L.length;R++)a.removeCue(L[R]);d==="disabled"&&(a.mode=d)}function y(a,T,v){var d=[],L=function(f,l){if(l<f[0].startTime)return 0;var g=f.length-1;if(l>f[g].endTime)return-1;for(var m=0,h=g;m<=h;){var b=Math.floor((h+m)/2);if(l<f[b].startTime)h=b-1;else{if(!(l>f[b].startTime&&m<g))return b;m=b+1}}return f[m].startTime-l<l-f[h].startTime?m:h}(a,T);if(L>-1)for(var R=L,E=a.length;R<E;R++){var o=a[R];if(o.startTime>=T&&o.endTime<=v)d.push(o);else if(o.startTime>v)return d}return d}},"./src/utils/time-ranges.ts":function(e,t,r){r.r(t),t.default={toString:function(i){for(var n="",s=i.length,u=0;u<s;u++)n+="["+i.start(u).toFixed(3)+","+i.end(u).toFixed(3)+"]";return n}}},"./src/utils/timescale-conversion.ts":function(e,t,r){function i(A,y,a,T){a===void 0&&(a=1),T===void 0&&(T=!1);var v=A*y*a;return T?Math.round(v):v}function n(A,y,a,T){return a===void 0&&(a=1),T===void 0&&(T=!1),i(A,y,1/a,T)}function s(A,y){return y===void 0&&(y=!1),i(A,1e3,1/9e4,y)}function u(A,y){return y===void 0&&(y=1),i(A,9e4,1/y)}r.r(t),r.d(t,"toTimescaleFromBase",function(){return i}),r.d(t,"toTimescaleFromScale",function(){return n}),r.d(t,"toMsFromMpegTsClock",function(){return s}),r.d(t,"toMpegTsClockFromTimescale",function(){return u})},"./src/utils/typed-array.ts":function(e,t,r){function i(n,s,u){return Uint8Array.prototype.slice?n.slice(s,u):new Uint8Array(Array.prototype.slice.call(n,s,u))}r.r(t),r.d(t,"sliceUint8",function(){return i})},"./src/utils/vttcue.ts":function(e,t,r){r.r(t),t.default=function(){if(typeof self<"u"&&self.VTTCue)return self.VTTCue;var i=["","lr","rl"],n=["start","middle","end","left","right"];function s(a,T){if(typeof T!="string"||!Array.isArray(a))return!1;var v=T.toLowerCase();return!!~a.indexOf(v)&&v}function u(a){return s(n,a)}function A(a){for(var T=arguments.length,v=new Array(T>1?T-1:0),d=1;d<T;d++)v[d-1]=arguments[d];for(var L=1;L<arguments.length;L++){var R=arguments[L];for(var E in R)a[E]=R[E]}return a}function y(a,T,v){var d=this,L={enumerable:!0};d.hasBeenReset=!1;var R="",E=!1,o=a,f=T,l=v,g=null,m="",h=!0,b="auto",k="start",_=50,D="middle",c=50,p="middle";Object.defineProperty(d,"id",A({},L,{get:function(){return R},set:function(S){R=""+S}})),Object.defineProperty(d,"pauseOnExit",A({},L,{get:function(){return E},set:function(S){E=!!S}})),Object.defineProperty(d,"startTime",A({},L,{get:function(){return o},set:function(S){if(typeof S!="number")throw new TypeError("Start time must be set to a number.");o=S,this.hasBeenReset=!0}})),Object.defineProperty(d,"endTime",A({},L,{get:function(){return f},set:function(S){if(typeof S!="number")throw new TypeError("End time must be set to a number.");f=S,this.hasBeenReset=!0}})),Object.defineProperty(d,"text",A({},L,{get:function(){return l},set:function(S){l=""+S,this.hasBeenReset=!0}})),Object.defineProperty(d,"region",A({},L,{get:function(){return g},set:function(S){g=S,this.hasBeenReset=!0}})),Object.defineProperty(d,"vertical",A({},L,{get:function(){return m},set:function(S){var C=function(I){return s(i,I)}(S);if(C===!1)throw new SyntaxError("An invalid or illegal string was specified.");m=C,this.hasBeenReset=!0}})),Object.defineProperty(d,"snapToLines",A({},L,{get:function(){return h},set:function(S){h=!!S,this.hasBeenReset=!0}})),Object.defineProperty(d,"line",A({},L,{get:function(){return b},set:function(S){if(typeof S!="number"&&S!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");b=S,this.hasBeenReset=!0}})),Object.defineProperty(d,"lineAlign",A({},L,{get:function(){return k},set:function(S){var C=u(S);if(!C)throw new SyntaxError("An invalid or illegal string was specified.");k=C,this.hasBeenReset=!0}})),Object.defineProperty(d,"position",A({},L,{get:function(){return _},set:function(S){if(S<0||S>100)throw new Error("Position must be between 0 and 100.");_=S,this.hasBeenReset=!0}})),Object.defineProperty(d,"positionAlign",A({},L,{get:function(){return D},set:function(S){var C=u(S);if(!C)throw new SyntaxError("An invalid or illegal string was specified.");D=C,this.hasBeenReset=!0}})),Object.defineProperty(d,"size",A({},L,{get:function(){return c},set:function(S){if(S<0||S>100)throw new Error("Size must be between 0 and 100.");c=S,this.hasBeenReset=!0}})),Object.defineProperty(d,"align",A({},L,{get:function(){return p},set:function(S){var C=u(S);if(!C)throw new SyntaxError("An invalid or illegal string was specified.");p=C,this.hasBeenReset=!0}})),d.displayState=void 0}return y.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},y}()},"./src/utils/vttparser.ts":function(e,t,r){r.r(t),r.d(t,"parseTimeStamp",function(){return s}),r.d(t,"fixLineBreaks",function(){return v}),r.d(t,"VTTParser",function(){return d});var i=r("./src/utils/vttcue.ts"),n=function(){function L(){}return L.prototype.decode=function(R,E){if(!R)return"";if(typeof R!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(R))},L}();function s(L){function R(o,f,l,g){return 3600*(0|o)+60*(0|f)+(0|l)+parseFloat(g||0)}var E=L.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return E?parseFloat(E[2])>59?R(E[2],E[3],0,E[4]):R(E[1],E[2],E[3],E[4]):null}var u=function(){function L(){this.values=Object.create(null)}var R=L.prototype;return R.set=function(E,o){this.get(E)||o===""||(this.values[E]=o)},R.get=function(E,o,f){return f?this.has(E)?this.values[E]:o[f]:this.has(E)?this.values[E]:o},R.has=function(E){return E in this.values},R.alt=function(E,o,f){for(var l=0;l<f.length;++l)if(o===f[l]){this.set(E,o);break}},R.integer=function(E,o){/^-?\d+$/.test(o)&&this.set(E,parseInt(o,10))},R.percent=function(E,o){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(o)){var f=parseFloat(o);if(f>=0&&f<=100)return this.set(E,f),!0}return!1},L}();function A(L,R,E,o){var f=o?L.split(o):[L];for(var l in f)if(typeof f[l]=="string"){var g=f[l].split(E);g.length===2&&R(g[0],g[1])}}var y=new i.default(0,0,""),a=y.align==="middle"?"middle":"center";function T(L,R,E){var o=L;function f(){var g=s(L);if(g===null)throw new Error("Malformed timestamp: "+o);return L=L.replace(/^[^\sa-zA-Z-]+/,""),g}function l(){L=L.replace(/^\s+/,"")}if(l(),R.startTime=f(),l(),L.substr(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+o);L=L.substr(3),l(),R.endTime=f(),l(),function(g,m){var h=new u;A(g,function(_,D){var c;switch(_){case"region":for(var p=E.length-1;p>=0;p--)if(E[p].id===D){h.set(_,E[p].region);break}break;case"vertical":h.alt(_,D,["rl","lr"]);break;case"line":c=D.split(","),h.integer(_,c[0]),h.percent(_,c[0])&&h.set("snapToLines",!1),h.alt(_,c[0],["auto"]),c.length===2&&h.alt("lineAlign",c[1],["start",a,"end"]);break;case"position":c=D.split(","),h.percent(_,c[0]),c.length===2&&h.alt("positionAlign",c[1],["start",a,"end","line-left","line-right","auto"]);break;case"size":h.percent(_,D);break;case"align":h.alt(_,D,["start",a,"end","left","right"])}},/:/,/\s/),m.region=h.get("region",null),m.vertical=h.get("vertical","");var b=h.get("line","auto");b==="auto"&&y.line===-1&&(b=-1),m.line=b,m.lineAlign=h.get("lineAlign","start"),m.snapToLines=h.get("snapToLines",!0),m.size=h.get("size",100),m.align=h.get("align",a);var k=h.get("position","auto");k==="auto"&&y.position===50&&(k=m.align==="start"||m.align==="left"?0:m.align==="end"||m.align==="right"?100:50),m.position=k}(L,R)}function v(L){return L.replace(/<br(?: \/)?>/gi,`
`)}var d=function(){function L(){this.state="INITIAL",this.buffer="",this.decoder=new n,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var R=L.prototype;return R.parse=function(E){var o=this;function f(){var b=o.buffer,k=0;for(b=v(b);k<b.length&&b[k]!=="\r"&&b[k]!==`
`;)++k;var _=b.substr(0,k);return b[k]==="\r"&&++k,b[k]===`
`&&++k,o.buffer=b.substr(k),_}E&&(o.buffer+=o.decoder.decode(E,{stream:!0}));try{var l="";if(o.state==="INITIAL"){if(!/\r\n|\n/.test(o.buffer))return this;var g=(l=f()).match(/^()?WEBVTT([ \t].*)?$/);if(!g||!g[0])throw new Error("Malformed WebVTT signature.");o.state="HEADER"}for(var m=!1;o.buffer;){if(!/\r\n|\n/.test(o.buffer))return this;switch(m?m=!1:l=f(),o.state){case"HEADER":/:/.test(l)?A(l,function(b,k){},/:/):l||(o.state="ID");continue;case"NOTE":l||(o.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(l)){o.state="NOTE";break}if(!l)continue;if(o.cue=new i.default(0,0,""),o.state="CUE",l.indexOf("-->")===-1){o.cue.id=l;continue}case"CUE":if(!o.cue){o.state="BADCUE";continue}try{T(l,o.cue,o.regionList)}catch{o.cue=null,o.state="BADCUE";continue}o.state="CUETEXT";continue;case"CUETEXT":var h=l.indexOf("-->")!==-1;if(!l||h&&(m=!0)){o.oncue&&o.cue&&o.oncue(o.cue),o.cue=null,o.state="ID";continue}if(o.cue===null)continue;o.cue.text&&(o.cue.text+=`
`),o.cue.text+=l;continue;case"BADCUE":l||(o.state="ID")}}}catch{o.state==="CUETEXT"&&o.cue&&o.oncue&&o.oncue(o.cue),o.cue=null,o.state=o.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},R.flush=function(){var E=this;try{if((E.cue||E.state==="HEADER")&&(E.buffer+=`

`,E.parse()),E.state==="INITIAL"||E.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(o){E.onparsingerror&&E.onparsingerror(o)}return E.onflush&&E.onflush(),this},L}()},"./src/utils/webvtt-parser.ts":function(e,t,r){r.r(t),r.d(t,"generateCueId",function(){return v}),r.d(t,"parseWebVTT",function(){return d});var i=r("./src/polyfills/number.ts"),n=r("./src/utils/vttparser.ts"),s=r("./src/demux/id3.ts"),u=r("./src/utils/timescale-conversion.ts"),A=r("./src/remux/mp4-remuxer.ts"),y=/\r\n|\n\r|\n|\r/g,a=function(L,R,E){return E===void 0&&(E=0),L.substr(E,R.length)===R},T=function(L){for(var R=5381,E=L.length;E;)R=33*R^L.charCodeAt(--E);return(R>>>0).toString()};function v(L,R,E){return T(L.toString())+T(R.toString())+T(E)}function d(L,R,E,o,f,l,g,m){var h,b=new n.VTTParser,k=Object(s.utf8ArrayToStr)(new Uint8Array(L)).trim().replace(y,`
`).split(`
`),_=[],D=Object(u.toMpegTsClockFromTimescale)(R,E),c="00:00.000",p=0,S=0,C=!0,I=!1;b.oncue=function(w){var O=o[f],x=o.ccOffset,P=(p-D)/9e4;if(O!=null&&O.new&&(S!==void 0?x=o.ccOffset=O.start:function(j,V,z){var G=j[V],W=j[G.prevCC];if(!W||!W.new&&G.new)return j.ccOffset=j.presentationOffset=G.start,void(G.new=!1);for(;($=W)!==null&&$!==void 0&&$.new;){var $;j.ccOffset+=G.start-W.start,G.new=!1,W=j[(G=W).prevCC]}j.presentationOffset=z}(o,f,P)),P&&(x=P-o.presentationOffset),I){var F=w.endTime-w.startTime,N=Object(A.normalizePts)(9e4*(w.startTime+x-S),9e4*l)/9e4;w.startTime=N,w.endTime=N+F}var U=w.text.trim();w.text=decodeURIComponent(encodeURIComponent(U)),w.id||(w.id=v(w.startTime,w.endTime,U)),w.endTime>0&&_.push(w)},b.onparsingerror=function(w){h=w},b.onflush=function(){h?m(h):g(_)},k.forEach(function(w){if(C){if(a(w,"X-TIMESTAMP-MAP=")){C=!1,I=!0,w.substr(16).split(",").forEach(function(O){a(O,"LOCAL:")?c=O.substr(6):a(O,"MPEGTS:")&&(p=parseInt(O.substr(7)))});try{S=function(O){var x=parseInt(O.substr(-3)),P=parseInt(O.substr(-6,2)),F=parseInt(O.substr(-9,2)),N=O.length>9?parseInt(O.substr(0,O.indexOf(":"))):0;if(!(Object(i.isFiniteNumber)(x)&&Object(i.isFiniteNumber)(P)&&Object(i.isFiniteNumber)(F)&&Object(i.isFiniteNumber)(N)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+O);return x+=1e3*P,(x+=6e4*F)+36e5*N}(c)/1e3}catch(O){I=!1,h=O}return}w===""&&(C=!1)}b.parse(w+`
`)}),b.flush()}},"./src/utils/xhr-loader.ts":function(e,t,r){r.r(t);var i=r("./src/utils/logger.ts"),n=r("./src/loader/load-stats.ts"),s=/^age:\s*[\d.]+\s*$/m,u=function(){function A(a){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=a?a.xhrSetup:null,this.stats=new n.LoadStats,this.retryDelay=0}var y=A.prototype;return y.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},y.abortInternal=function(){var a=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),a&&(a.onreadystatechange=null,a.onprogress=null,a.readyState!==4&&(this.stats.aborted=!0,a.abort()))},y.abort=function(){var a;this.abortInternal(),(a=this.callbacks)!==null&&a!==void 0&&a.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},y.load=function(a,T,v){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=a,this.config=T,this.callbacks=v,this.retryDelay=T.retryDelay,this.loadInternal()},y.loadInternal=function(){var a=this.config,T=this.context;if(a){var v=this.loader=new self.XMLHttpRequest,d=this.stats;d.loading.first=0,d.loaded=0;var L=this.xhrSetup;try{if(L)try{L(v,T.url)}catch{v.open("GET",T.url,!0),L(v,T.url)}v.readyState||v.open("GET",T.url,!0)}catch(R){return void this.callbacks.onError({code:v.status,text:R.message},T,v)}T.rangeEnd&&v.setRequestHeader("Range","bytes="+T.rangeStart+"-"+(T.rangeEnd-1)),v.onreadystatechange=this.readystatechange.bind(this),v.onprogress=this.loadprogress.bind(this),v.responseType=T.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.timeout),v.send()}},y.readystatechange=function(){var a=this.context,T=this.loader,v=this.stats;if(a&&T){var d=T.readyState,L=this.config;if(!v.aborted&&d>=2)if(self.clearTimeout(this.requestTimeout),v.loading.first===0&&(v.loading.first=Math.max(self.performance.now(),v.loading.start)),d===4){T.onreadystatechange=null,T.onprogress=null;var R=T.status;if(R>=200&&R<300){var E,o;if(v.loading.end=Math.max(self.performance.now(),v.loading.first),o=a.responseType==="arraybuffer"?(E=T.response).byteLength:(E=T.responseText).length,v.loaded=v.total=o,!this.callbacks)return;var f=this.callbacks.onProgress;if(f&&f(v,a,E,T),!this.callbacks)return;var l={url:T.responseURL,data:E};this.callbacks.onSuccess(l,v,a,T)}else v.retry>=L.maxRetry||R>=400&&R<499?(i.logger.error(R+" while loading "+a.url),this.callbacks.onError({code:R,text:T.statusText},a,T)):(i.logger.warn(R+" while loading "+a.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,L.maxRetryDelay),v.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),L.timeout)}},y.loadtimeout=function(){i.logger.warn("timeout while loading "+this.context.url);var a=this.callbacks;a&&(this.abortInternal(),a.onTimeout(this.stats,this.context,this.loader))},y.loadprogress=function(a){var T=this.stats;T.loaded=a.loaded,a.lengthComputable&&(T.total=a.total)},y.getCacheAge=function(){var a=null;if(this.loader&&s.test(this.loader.getAllResponseHeaders())){var T=this.loader.getResponseHeader("age");a=T?parseFloat(T):null}return a},A}();t.default=u}}).default);var Yn=wd(So.exports);const xd={name:"d-icon"},et=Object.assign(xd,{props:{icon:String,size:[Number,String]},setup:function(e){const t=e,r=Ae(()=>({fontSize:/^\d+$/.test(t.size)?t.size+"px":t.size}));return(i,n)=>(me(),be("i",{class:pt(["d-icon iconfont",e.icon]),style:gt(ee(r))},null,6))}});et.__scopeId="data-v-0c690e66";rr("data-v-4cb76d59");const Od={class:"d-player-top"},Pd={class:"top-title"},Fd={class:"top-title"};nr();const Md={props:{title:{default:""}},setup(e){Date.prototype.format=function(i){let n={"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds()};for(var s in n)new RegExp("("+s+")").test(i)&&(i=i.replace(RegExp.$1,RegExp.$1.length==1?n[s]:("00"+n[s]).substr((""+n[s]).length)));return i};let t=xe("00:00:00");t.value=new Date().format("hh:mm:ss");let r=null;return r=setInterval(()=>{t.value=new Date().format("hh:mm:ss")},1e3),ir(()=>{clearInterval(r)}),(i,n)=>(me(),be("div",Od,[se("p",Pd,Ce(e.title||""),1),se("p",Fd,Ce(ee(t)),1)]))},__scopeId:"data-v-4cb76d59"};rr("data-v-ac2469ec");const Nd={class:"d-status"},Bd={class:"d-flex-center"},Ud={class:"d-flex-center"},Gd=st("5X\u901F\u64AD\u653E\u4E2D ");nr();var Ao=De({props:["state"],setup:e=>(t,r)=>Ke((me(),be("div",Nd,[Ke(se("li",Bd,[ne(et,{size:"18",class:"d-status-icon",icon:"icon-volume-"+(e.state.volume==0?"mute":e.state.volume>.5?"up":"down")},null,8,["icon"]),st(" "+Ce(~~(100*e.state.volume))+"% ",1)],512),[[He,e.state.handleType=="volume"]]),Ke(se("li",Ud,[ne(et,{size:"12",icon:"icon-play"}),ne(et,{size:"12",icon:"icon-play",style:{"margin-right":"5px"}}),Gd],512),[[He,e.state.handleType=="playbackRate"||e.state.isMultiplesPlay]])],512)),[[He,e.state.handleType||e.state.isMultiplesPlay]])});Ao.__scopeId="data-v-ac2469ec",rr("data-v-385f7870");const jd=["checked","true-value","false-value"],Kd=se("span",{class:"d-switch_action"},null,-1);nr();var cn=De({props:{modelValue:{type:[Number,String,Boolean]},width:{type:String,default:"40px"},trueValue:{type:[Number,String,Boolean],default:!0},falseValue:{type:[Number,String,Boolean],default:!0},activeColor:{type:[String],default:"#409EFF"}},emits:["update:modelValue","change"],setup(e,{emit:t}){const r=e;Hi(u=>({"014e5dc0":e.width,e4e32852:e.activeColor}));const i=xe(null),n=Ae(()=>r.modelValue===r.trueValue),s=()=>{er(()=>{const u=i.value.checked;t("update:modelValue",u),t("change",u)})};return(u,A)=>(me(),be("div",{class:pt(["d-switch",{"is-checked":ee(n)}])},[se("input",{class:"d-switch__input",ref:i,type:"checkbox",checked:ee(n),onChange:s,"true-value":e.trueValue,"false-value":e.falseValue},null,40,jd),Kd],2))}});cn.__scopeId="data-v-385f7870",rr("data-v-b2384226");const Hd={key:0},Vd=se("i",{class:"rotating iconfont icon-loading f50"},null,-1),Wd=[se("i",{class:"rotating iconfont icon-loading f50"},null,-1),se("p",null,"\u6B63\u5728\u7F13\u51B2...",-1)],$d=[se("i",{class:"iconfont icon-replay f24 mr5"},null,-1),st("\u91CD\u65B0\u64AD\u653E ")],qd=[se("i",{class:"iconfont icon-replay f24 mr5"},null,-1),st("\u8BF7\u6C42\u9519\u8BEF ")];nr();var _o=De({props:{loadType:String,text:{type:String,default:""}},setup(e){const t=e,{proxy:r}=kt(),i=["loadstart","waiting","ended","error","stalled"],n=()=>{r.$parent.play()},s=Ae(()=>{let u="background: rgba(0, 0, 0, .1);z-index:1";return t.loadType=="loadstart"&&(u="background: rgba(0, 0, 0, 1);;z-index:3"),u});return(u,A)=>Ke((me(),be("div",{class:"d-loading",style:gt(ee(s))},[se("div",null,[e.loadType=="loadstart"?(me(),be("span",Hd,[Vd,se("p",null,Ce(e.text),1)])):Ge("",!0),Ke(se("span",null,Wd,512),[[He,e.loadType=="waiting"]]),Ke(se("span",null,[se("p",{onClick:n,class:"d-flex-x d-pointer"},$d)],512),[[He,e.loadType=="ended"]]),Ke(se("span",null,[se("p",{onClick:n,class:"d-flex-x d-pointer"},qd)],512),[[He,e.loadType=="error"||e.loadType=="stalled"]])])],4)),[[He,i.includes(e.loadType)]])}});_o.__scopeId="data-v-b2384226";const Qt=function(e,t,r,i=!1){e&&t&&r&&e.addEventListener(t,r,i)},je=function(e,t,r,i=!1){e&&t&&r&&e.removeEventListener(t,r,i)};rr("data-v-5a794390");const Yd=["onMousedown"];nr();var gr=De(mi(vi({},{name:"DSlider"}),{props:{modelValue:{required:!0,type:Number,default:0},disabled:{type:Boolean,default:!1},vertical:{type:Boolean,default:!1},hover:{type:Boolean,default:!0},hoverText:{type:String,default:""},preload:{type:Number,default:0},size:{type:String,default:"10px"}},emits:["update:modelValue","change","onMousemove"],setup:function(e,{emit:t}){const r=e;Hi(o=>({"5242b67b":e.size}));const i=xe(null),n=xe(null),s=qe({dragging:!1,hoverPosition:0,hoverTipsLeft:"50%"}),u=Ae(()=>{let o=r.modelValue<0?0:r.modelValue>1?1:r.modelValue;return r.vertical?`height:${100*o}%`:`width:${100*o}%`}),A=Ae(()=>{let o=r.preload<0?0:r.preload>1?1:r.preload;return r.vertical?`height:${100*o}%`:`width:${100*o}%`}),y=Ae(()=>{let o=s.hoverPosition<0?0:s.hoverPosition>1?1:s.hoverPosition;return r.vertical?`bottom:${100*o}%`:`left:${100*o}%`}),a=o=>{o.preventDefault()},T=o=>{r.disabled||(o.preventDefault(),s.dragging=!0,d(o),Qt(window,"mousemove",R),Qt(window,"touchmove",R),Qt(window,"mouseup",E),Qt(window,"touchend",E))},v=o=>{if(!r.hover)return;let f=L(o);if(t("onMousemove",o,f),s.hoverPosition=f,r.vertical)return;let l=i.value,g=n.value.clientWidth/2,m=o.clientX-l.getBoundingClientRect().left;m<g?s.hoverTipsLeft=g-m+"px":l.clientWidth-m<g?s.hoverTipsLeft=l.clientWidth-m-g+"px":s.hoverTipsLeft="50%"},d=o=>{let f=L(o);t("update:modelValue",f),t("change",o,f)},L=o=>{let f=i.value,l=0;if(r.vertical){let g=f.clientHeight;l=(f.getBoundingClientRect().bottom-o.clientY)/g}else l=(o.clientX-f.getBoundingClientRect().left)/f.clientWidth;return l<0?0:l>1?1:l},R=o=>{d(o)},E=o=>{s.dragging&&(je(window,"mousemove",R),je(window,"touchmove",R),je(window,"mouseup",E),je(window,"touchend",E),je(window,"contextmenu",E),setTimeout(()=>{s.dragging=!1},0))};return(o,f)=>(me(),be("div",{ref:i,class:pt(["d-slider",{"is-vertical":r.vertical}]),onMousedown:sc(T,["stop"]),onContextmenu:a},[se("div",{class:"d-slider__runway",onMousemove:v},[Ke(se("div",{class:"d-slider__cursor",style:gt(ee(y))},[Ke(se("div",{class:"d-slider__tips",ref:n,style:gt({left:ee(s).hoverTipsLeft})},Ce(r.hoverText),5),[[He,r.hoverText]])],4),[[He,r.hover]]),se("div",{class:"d-slider__preload",style:gt(ee(A))},null,4),se("div",{class:"d-slider__bar",style:gt(ee(u))},null,4)],32)],42,Yd))}}));gr.__scopeId="data-v-5a794390";rr("data-v-570fa0d1");const zd={key:0,class:"d-player-dialog"},Xd={class:"d-player-dialog-body"},Qd={class:"d-player-dialog-title"},Zd={class:"d-player-hotkey-panel"},Jd={class:"d-player-filter-panel"},ef={class:"d-player-filter-panel-item"},tf=se("span",null,"\u9971\u548C\u5EA6",-1),rf={class:"d-player-filter-panel-item"},nf=se("span",null,"\u4EAE\u5EA6",-1),sf={class:"d-player-filter-panel-item"},af=se("span",null,"\u5BF9\u6BD4\u5EA6",-1),of={key:0,class:"d-player-contextmenu"},lf=["dplayerKeyCode"],uf=se("input",{class:"d-player-copyText"},null,-1);nr();var Lo=De({setup(e){const t=qe({show:!1,dialogType:"",dialogTitle:"",version:"1.3.1-beta.6",mouseX:0,mouseY:0}),r=[{label:"\u89C6\u9891\u8272\u5F69\u8C03\u6574",key:"filter"},{label:"\u5FEB\u6377\u952E\u8BF4\u660E",key:"hotkey"},{label:"\u590D\u5236\u89C6\u9891\u7F51\u5740",key:"copy"},{label:"\u7248\u672C\uFF1A1.3.1-beta.6",key:"version"}],i=[{key:"Space",label:"\u64AD\u653E/\u6682\u505C"},{key:"\u2192",label:"\u5355\u6B21\u5FEB\u8FDB10s\uFF0C\u957F\u63095\u500D\u901F\u64AD\u653E"},{key:"\u2190",label:"\u5FEB\u90005s"},{key:"\u2191",label:"\u97F3\u91CF\u589E\u52A010%"},{key:"\u2193",label:"\u97F3\u91CF\u589E\u52A0\u964D\u4F4E10%"},{key:"Esc",label:"\u9000\u51FA\u5168\u5C4F/\u9000\u51FA\u7F51\u9875\u5168\u5C4F"},{key:"F",label:"\u5168\u5C4F/\u9000\u51FA\u5168\u5C4F"}],n=qe({saturate:.392,brightness:.392,contrast:.392}),s=Ae(()=>({left:t.mouseX+"px",top:t.mouseY+"px"}));vt(n,T=>{let v=document.querySelector("#dPlayerVideo"),d=(2.55*T.saturate).toFixed(2),L=(2.55*T.brightness).toFixed(2),R=(2.55*T.contrast).toFixed(2);v.style.filter=`saturate(${d}) brightness(${L}) contrast(${R})`});const u=()=>{n.saturate=.392,n.brightness=.392,n.contrast=.392},A=T=>{T.key=="Escape"&&a(0)},y=T=>{T.preventDefault(),Qt(window,"keydown",A),Qt(window,"click",a);let v=document.querySelector("#refPlayerWrap"),d=v.clientWidth;v.clientHeight,t.mouseX=T.clientX-v.getBoundingClientRect().left,d-t.mouseX<130&&(t.mouseX=t.mouseX+(d-t.mouseX-130)),t.mouseY=T.clientY-v.getBoundingClientRect().top,t.show=!0},a=T=>{let v=T.path[0].tagName=="LI",d=T.path[0].attributes.dplayerKeyCode&&T.path[0].attributes.dplayerKeyCode.value,L=r.map(R=>R.key);if(v&&L.includes(d))if(t.dialogTitle=T.path[0].innerText,t.dialogType=d,d=="copy"){let R=document.querySelector(".d-player-copyText");R.value=window.location.href,R.select(),document.execCommand("copy"),t.dialogType=""}else d=="version"&&(t.dialogType="");t.show=!1,je(window,"keydown",A),je(window,"click",a)};return Ut(()=>{let T=document.querySelector("#refPlayerWrap");je(window,"keydown",A),je(window,"click",a),je(T,"contextmenu",y),Qt(T,"contextmenu",y)}),ir(()=>{let T=document.querySelector("#refPlayerWrap");je(window,"keydown",A),je(window,"click",a),je(T,"contextmenu",y)}),(T,v)=>(me(),be("div",null,[ne(qr,{name:"d-fade-in"},{default:Hr(()=>[ee(t).dialogType?(me(),be("div",zd,[se("div",Xd,[se("h5",Qd,[st(Ce(ee(t).dialogTitle)+" ",1),se("i",{onClick:v[0]||(v[0]=d=>ee(t).dialogType=!1),class:"icon icon-close"},"X")]),Ke(se("ul",Zd,[(me(),be(Me,null,vn(i,d=>se("li",{class:"d-player-hotkey-panel-item",key:d.key},[se("span",null,Ce(d.key),1),se("span",null,Ce(d.label),1)])),64))],512),[[He,ee(t).dialogType=="hotkey"]]),Ke(se("ul",Jd,[se("li",ef,[tf,ne(gr,{class:"filter-panel-slider",size:"5px",modelValue:ee(n).saturate,"onUpdate:modelValue":v[1]||(v[1]=d=>ee(n).saturate=d)},null,8,["modelValue"]),se("span",null,Ce(Math.round(255*ee(n).saturate)),1)]),se("li",rf,[nf,ne(gr,{class:"filter-panel-slider",size:"5px",modelValue:ee(n).brightness,"onUpdate:modelValue":v[2]||(v[2]=d=>ee(n).brightness=d)},null,8,["modelValue"]),se("span",null,Ce(Math.round(255*ee(n).brightness)),1)]),se("li",sf,[af,ne(gr,{class:"filter-panel-slider",size:"5px",modelValue:ee(n).contrast,"onUpdate:modelValue":v[3]||(v[3]=d=>ee(n).contrast=d)},null,8,["modelValue"]),se("span",null,Ce(Math.round(255*ee(n).contrast)),1)]),se("span",{onClick:u,title:"\u91CD\u7F6E","aria-label":"\u91CD\u7F6E",class:"d-player-filter-reset"},"\u91CD\u7F6E")],512),[[He,ee(t).dialogType=="filter"]])])])):Ge("",!0)]),_:1}),ee(t).show?(me(),be("div",of,[se("ul",{class:"d-player-contextmenu-body",style:gt(ee(s))},[(me(),be(Me,null,vn(r,d=>se("li",{dplayerKeyCode:d.key,key:d.key},Ce(d.label),9,lf)),64))],4),uf])):Ge("",!0)]))}});Lo.__scopeId="data-v-570fa0d1";const zn=e=>{let t=~~(e/3600),r=~~(e%3600/60),i=~~(e%60);return t=t<10?"0"+t:t,r=r<10?"0"+r:r,i=i<10?"0"+i:i,`${t}:${r}:${i}`},Dr="ontouchstart"in window,Js=["loadstart","play","pause","playing","seeking","seeked","waiting","durationchange","progress","canplay","timeupdate","ended","error","stalled"],cf={width:{type:String,default:"800px"},height:{type:String,default:"450px"},color:{type:String,default:"#409eff"},src:{required:!0,type:String,default:""},title:{type:String,default:""},type:{type:String,default:"video/mp4"},poster:{type:String,default:""},webFullScreen:{type:Boolean,default:!1},speed:{type:Boolean,default:!0},currentTime:{type:Number,default:0},playsinline:{type:Boolean,default:!1},muted:{type:Boolean,default:!1},speedRate:{type:Array,default:()=>["2.0","1.5","1.25","1.0","0.75","0.5"]},autoPlay:{type:Boolean,default:!1},loop:{type:Boolean,default:!1},mirror:{type:Boolean,default:!1},ligthOff:{type:Boolean,default:!1},volume:{type:[String,Number],default:.3},control:{type:Boolean,default:!0},controlBtns:{type:Array,default:["audioTrack","quality","speedRate","volume","setting","pip","pageFullScreen","fullScreen"]},preload:{type:String,default:"auto"}};rr("data-v-01791e9e");const df={class:"d-player-video",id:"dPlayerVideo"},ff=["controls","webkit-playsinline","playsinline","volume","muted","loop","preload","src","poster"],hf={class:"d-player-lightoff"},gf={key:1,class:"d-player-state"},pf={class:"d-play-btn"},vf=["onKeyup","onKeydown"],mf={class:"d-control-progress"},yf={class:"d-tool-bar"},Ef={key:0,class:"d-tool-item d-tool-time audioTrack-btn"},Tf=se("span",{style:{margin:"0 3px"}},"/",-1),bf={class:"total-time"},Sf={class:"d-tool-bar"},Af={key:0,class:"d-tool-item quality-btn"},_f={class:"d-tool-item-main"},Lf={class:"speed-main",style:{"text-align":"center"}},Rf=["onClick"],Df={key:1,class:"d-tool-item speedRate-btn"},kf={class:"d-tool-item-main"},Cf={class:"speed-main"},If=["onClick"],wf={key:2,class:"d-tool-item volume-btn"},xf={class:"d-tool-item-main volume-box",style:{width:"52px"}},Of={class:"volume-text-size"},Pf={key:3,class:"d-tool-item setting-btn"},Ff={class:"d-tool-item-main"},Mf={class:"speed-main"},Nf=st(" \u955C\u50CF\u753B\u9762 "),Bf=st(" \u5FAA\u73AF\u64AD\u653E "),Uf=st(" \u5173\u706F\u6A21\u5F0F "),Gf=se("div",{class:"d-tool-item-main"},"\u753B\u4E2D\u753B",-1),jf=se("div",{class:"d-tool-item-main"},"\u7F51\u9875\u5168\u5C4F",-1),Kf=se("div",{class:"d-tool-item-main"},"\u5168\u5C4F",-1);nr();var zr=De(mi(vi({},{name:"vue3VideoPlay",inheritAttrs:!1}),{props:cf,emits:[...Js,"mirrorChange","loopChange","lightOffChange"],setup:function(e,{expose:t,emit:r}){const i=e;Hi(x=>({"51d4439c":ee(L),"77e758a6":x.width,b8a1afc0:x.height}));const n=new Yn({fragLoadingTimeOut:2e3}),s=xe(null),u=xe(null),A=xe(null),y=xe(null),a=qe(mi(vi({dVideo:null},i),{muted:i.muted,playBtnState:i.autoPlay?"pause":"play",loadStateType:"loadstart",fullScreen:!1,handleType:"",currentTime:"00:00:00",preloadBar:0,totalTime:"00:00:00",isVideoHovering:!0,speedActive:"1.0",playProgress:0,isMultiplesPlay:!1,longPressTimeout:null,progressCursorTime:"00:00:00",qualityLevels:[],currentLevel:0})),T=(...x)=>P=>x.reverse().reduce((F,N)=>N(F),P),v=Js.reduce((x,P)=>{var F;return x[`on${F=P,F.charAt(0).toUpperCase()+F.slice(1)}`]=N=>{a.loadStateType=P,r(P,N)},x},{});v.onCanplay=T(v.onCanplay,()=>{a.playBtnState!="play"&&a.dVideo.play(),a.autoPlay&&(a.dVideo.play(),a.playBtnState="pause")}),v.onEnded=T(v.onEnded,()=>{a.playBtnState="replay"}),v.onDurationchange=x=>{r("durationchange",x),i.currentTime!=0&&(a.dVideo.currentTime=i.currentTime),v.onTimeupdate(x)},v.onProgress=x=>{console.log("\u7F13\u51B2\u4E2D..."),r("progress",x);let P=x.target.duration,F=x.target.buffered,N=x.target.buffered.length&&x.target.buffered.end(F-1);a.preloadBar=N/P},v.onTimeupdate=x=>{r("timeupdate",x);let P=x.duration||x.target.duration||0,F=x.currentTime||x.target.currentTime;a.playProgress=F/P,a.currentTime=zn(F),a.totalTime=zn(P)},v.onError=T(v.onError,()=>{a.playBtnState="replay"});let d=xu();for(let x in d)v[x]=d[x];const L=(R=a.color,`${parseInt("0x"+R.slice(1,3))},${parseInt("0x"+R.slice(3,5))},${parseInt("0x"+R.slice(5,7))}`);var R;const E=Zs(500,()=>{a.handleType=""}),o=x=>{x.preventDefault(),x.code=="ArrowUp"?a.volume=a.volume+.1>1?1:a.volume+.1:a.volume=a.volume-.1<0?0:a.volume-.1,a.muted=!1,a.handleType="volume",E()},f=x=>{i.speed&&(a.dVideo.currentTime=a.dVideo.currentTime<10?.1:a.dVideo.currentTime-10,v.onTimeupdate(a.dVideo),m())},l=x=>{x.preventDefault();let P=x.type;if(x.key=="ArrowRight"){if(m(),P=="keyup"){if(clearTimeout(a.longPressTimeout),!i.speed&&!a.longPressTimeout)return;a.isMultiplesPlay?(a.dVideo.playbackRate=a.speedActive,a.isMultiplesPlay=!1):(a.dVideo.currentTime=a.dVideo.currentTime+10,v.onTimeupdate(a.dVideo))}else if(P=="keydown"){if(!i.speed)return;a.isMultiplesPlay&&clearTimeout(a.longPressTimeout),a.longPressTimeout=setTimeout(()=>{a.isMultiplesPlay=!0,a.dVideo.playbackRate=5,a.handleType="playbackRate",E()},500)}}},g=()=>{Dr||y.value.focus()},m=()=>{a.loadStateType="play",a.dVideo.play().catch(()=>{setTimeout(()=>{a.playBtnState="replay",a.loadStateType="error"},500)}),a.playBtnState="pause"},h=()=>{a.dVideo.pause(),a.playBtnState="play"},b=x=>{x&&x.preventDefault(),a.playBtnState=="play"||a.playBtnState=="replay"?m():a.playBtnState=="pause"&&h()},k=()=>{a.muted=!a.muted,a.volume==0&&(a.volume=.05)},_=(x,P)=>{let F=a.dVideo.duration||a.dVideo.target.duration;a.dVideo.currentTime=F*P,a.playBtnState=="play"&&(a.dVideo.play(),a.playBtnState="pause")},D=(x,P)=>{a.progressCursorTime=zn(a.dVideo.duration*P)},c=Zs(2500,()=>{a.isVideoHovering=!1}),p=x=>{a.isVideoHovering=!0,c()},S=x=>{r("mirrorChange",x,a.dVideo)},C=x=>{r("loopChange",x,a.dVideo)},I=x=>{r("lightOffChange",x,a.dVideo)},w=()=>{var x;x=a.dVideo,document.pictureInPictureElement?document.exitPictureInPicture().catch(P=>{console.log(P,"Video failed to leave Picture-in-Picture mode.")}):x.requestPictureInPicture().catch(P=>{console.log(P,"Video failed to enter Picture-in-Picture mode.")})},O=()=>{a.fullScreen=(x=>{let P=document,F=P.webkitIsFullScreen||P.fullscreen;return F?(document.exitFullscreen||P.webkitExitFullScreen).call(P):(x.requestFullscreen||x.webkitRequestFullScreen).call(x),!F})(s.value)};return vt(()=>i.src,()=>{er(()=>{a.dVideo.canPlayType(i.type)||a.dVideo.canPlayType("application/vnd.apple.mpegurl")?a.muted=i.autoPlay:Yn.isSupported()&&(n.detachMedia(),n.attachMedia(a.dVideo),n.on(Yn.Events.MEDIA_ATTACHED,()=>{n.loadSource(i.src),n.on("hlsManifestParsed",(x,P)=>{console.log(P),a.currentLevel=P.level,a.qualityLevels=P.levels||[]})}),n.on("hlsLevelSwitching",(x,P)=>{console.log(P),console.log("LEVEL_SWITCHING")}),n.on("hlsLevelSwitched",(x,P)=>{a.currentLevel=P.level,console.log("LEVEL_SWITCHED")}))})},{immediate:!0}),Ut(()=>{a.dVideo=u,g()}),t({play:m,pause:h,togglePlay:b}),(x,P)=>(me(),be("div",{ref:s,id:"refPlayerWrap",class:pt(["d-player-wrap",{"web-full-screen":ee(a).webFullScreen,"is-lightoff":ee(a).lightOff,"d-player-wrap-hover":ee(a).playBtnState=="play"||ee(a).isVideoHovering}]),onMousemove:p},[se("div",df,[se("video",Qr({ref:u,class:["d-player-video-main",{"video-mirror":ee(a).mirror}],id:"dPlayerVideoMain",controls:!(!ee(Dr)||!ee(a).speed),"webkit-playsinline":i.playsinline,playsinline:i.playsinline},ee(v),{volume:ee(a).volume,muted:ee(a).muted,loop:ee(a).loop,preload:x.preload,width:"100%",height:"100%",src:i.src,poster:i.poster}),"\u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301Video\u6807\u7B7E\u3002",16,ff)]),ne(qr,{name:"d-fade-in"},{default:Hr(()=>[Ke(se("div",hf,null,512),[[He,ee(a).lightOff]])]),_:1}),ee(a).fullScreen?(me(),Fr(Md,{key:0,title:i.title},null,8,["title"])):Ge("",!0),ee(Dr)?Ge("",!0):(me(),be("div",gf,[ne(qr,{name:"d-scale-out"},{default:Hr(()=>[Ke(se("div",pf,[ne(et,{icon:"icon-play",size:40})],512),[[He,ee(a).playBtnState=="play"]])]),_:1}),ne(Ao,{state:ee(a)},null,8,["state"])])),ee(Dr)?Ge("",!0):(me(),be("input",{key:2,type:"input",readonly:"readonly",ref:y,onDblclick:O,onKeyup:[Ar(O,["f"]),P[0]||(P[0]=Ar(F=>ee(a).webFullScreen=!1,["esc"])),l],onClick:b,onKeydown:[Ar(b,["space"]),Ar(f,["arrow-left"]),Ar(o,["arrow-up","arrow-down"]),l],class:"d-player-input",maxlength:"0"},null,40,vf)),ne(_o,{loadType:ee(a).loadStateType},null,8,["loadType"]),ne(Lo),!ee(Dr)&&ee(a).control?(me(),be("div",{key:3,class:"d-player-control",ref:A},[se("div",mf,[ne(gr,{class:"d-progress-bar",onOnMousemove:D,onChange:_,disabled:!ee(a).speed,hoverText:ee(a).progressCursorTime,modelValue:ee(a).playProgress,"onUpdate:modelValue":P[1]||(P[1]=F=>ee(a).playProgress=F),preload:ee(a).preloadBar},null,8,["disabled","hoverText","modelValue","preload"])]),se("div",{class:"d-control-tool",onClick:g},[se("div",yf,[se("div",{class:"d-tool-item",onClick:b},[ne(et,{size:"24",icon:`icon-${ee(a).playBtnState}`},null,8,["icon"])]),i.controlBtns.includes("audioTrack")?(me(),be("div",Ef,[se("span",null,Ce(ee(a).currentTime),1),Tf,se("span",bf,Ce(ee(a).totalTime),1)])):Ge("",!0)]),se("div",Sf,[ee(a).qualityLevels.length&&i.controlBtns.includes("quality")?(me(),be("div",Af,[st(Ce(ee(a).qualityLevels.length&&(ee(a).qualityLevels[ee(a).currentLevel]||{}).height)+"P ",1),se("div",_f,[se("ul",Lf,[(me(!0),be(Me,null,vn(ee(a).qualityLevels,(F,N)=>(me(),be("li",{class:pt({"speed-active":ee(a).currentLevel==N}),onClick:U=>((j,V)=>{n.currentLevel=V,a.currentLevel=V})(0,N),key:F},Ce(F.height)+"P",11,Rf))),128))])])])):Ge("",!0),i.controlBtns.includes("speedRate")?(me(),be("div",Df,[st(Ce(ee(a).speedActive=="1.0"?"\u500D\u901F":ee(a).speedActive+"x")+" ",1),se("div",kf,[se("ul",Cf,[(me(!0),be(Me,null,vn(ee(a).speedRate,F=>(me(),be("li",{class:pt({"speed-active":ee(a).speedActive==F}),onClick:N=>(U=>{a.speedActive=U,a.dVideo.playbackRate=U})(F),key:F},Ce(F)+"x",11,If))),128))])])])):Ge("",!0),i.controlBtns.includes("volume")?(me(),be("div",wf,[se("div",xf,[se("div",{class:pt(["volume-main",{"is-muted":ee(a).muted}])},[se("span",Of,Ce(ee(a).muted?0:~~(100*ee(a).volume))+"%",1),ne(gr,{onChange:P[2]||(P[2]=F=>ee(a).muted=!1),hover:!1,size:"5px",vertical:!0,modelValue:ee(a).volume,"onUpdate:modelValue":P[3]||(P[3]=F=>ee(a).volume=F)},null,8,["modelValue"])],2)]),se("span",{onClick:k,style:{display:"flex"}},[ne(et,{size:"20",icon:"icon-volume-"+(ee(a).volume==0||ee(a).muted?"mute":ee(a).volume>.5?"up":"down")},null,8,["icon"])])])):Ge("",!0),i.controlBtns.includes("setting")?(me(),be("div",Pf,[ne(et,{size:"20",class:"rotateHover",icon:"icon-settings"}),se("div",Ff,[se("ul",Mf,[se("li",null,[Nf,ne(cn,{onChange:S,modelValue:ee(a).mirror,"onUpdate:modelValue":P[4]||(P[4]=F=>ee(a).mirror=F)},null,8,["modelValue"])]),se("li",null,[Bf,ne(cn,{onChange:C,modelValue:ee(a).loop,"onUpdate:modelValue":P[5]||(P[5]=F=>ee(a).loop=F)},null,8,["modelValue"])]),se("li",null,[Uf,ne(cn,{onChange:I,modelValue:ee(a).lightOff,"onUpdate:modelValue":P[6]||(P[6]=F=>ee(a).lightOff=F)},null,8,["modelValue"])])])])])):Ge("",!0),i.controlBtns.includes("pip")?(me(),be("div",{key:4,class:"d-tool-item pip-btn",onClick:w},[ne(et,{size:"20",icon:"icon-pip"}),Gf])):Ge("",!0),i.controlBtns.includes("pageFullScreen")?(me(),be("div",{key:5,class:"d-tool-item pip-btn",onClick:P[7]||(P[7]=F=>ee(a).webFullScreen=!ee(a).webFullScreen)},[ne(et,{size:"20",icon:"icon-web-screen"}),jf])):Ge("",!0),i.controlBtns.includes("fullScreen")?(me(),be("div",{key:6,class:"d-tool-item fullScreen-btn",onClick:O},[Kf,ne(et,{size:"20",icon:"icon-screen"})])):Ge("",!0)])])],512)):Ge("",!0)],34))}}));function Hf(e){e.component(zr.name,zr)}zr.__scopeId="data-v-01791e9e",zr.install=Hf;const At=e=>e!=null,yi=e=>typeof e=="function",$i=e=>e!==null&&typeof e=="object",Tg=e=>$i(e)&&yi(e.then)&&yi(e.catch),Ro=e=>typeof e=="number"||/^\d+(\.\d+)?$/.test(e),Vf=()=>Wf?/ios|iphone|ipad|ipod/.test(navigator.userAgent.toLowerCase()):!1;function bg(){}const br=Object.assign,Wf=typeof window<"u";function ea(e,t){const r=t.split(".");let i=e;return r.forEach(n=>{var s;i=$i(i)&&(s=i[n])!=null?s:""}),i}function Sg(e,t,r){return t.reduce((i,n)=>((!r||e[n]!==void 0)&&(i[n]=e[n]),i),{})}const Ag=e=>Array.isArray(e)?e:[e],dn=null,We=[Number,String],Zr={type:Boolean,default:!0},_g=e=>({type:Number,default:e}),Lg=e=>({type:We,default:e}),ht=e=>({type:String,default:e});var qi=typeof window<"u",$f=e=>e===window,ta=(e,t)=>({top:0,left:0,right:e,bottom:t,width:e,height:t}),qf=e=>{const t=ee(e);if($f(t)){const r=t.innerWidth,i=t.innerHeight;return ta(r,i)}return t!=null&&t.getBoundingClientRect?t.getBoundingClientRect():ta(0,0)};function Do(e){const t=Ve(e,null);if(t){const r=kt(),{link:i,unlink:n,internalChildren:s}=t;i(r),ir(()=>n(r));const u=Ae(()=>s.indexOf(r));return{parent:t,index:u}}return{parent:null,index:xe(-1)}}function Yf(e){const t=[],r=i=>{Array.isArray(i)&&i.forEach(n=>{var s;Wr(n)&&(t.push(n),(s=n.component)!=null&&s.subTree&&(t.push(n.component.subTree),r(n.component.subTree.children)),n.children&&r(n.children))})};return r(e),t}function zf(e,t,r){const i=Yf(e.subTree.children);r.sort((s,u)=>i.indexOf(s.vnode)-i.indexOf(u.vnode));const n=r.map(s=>s.proxy);t.sort((s,u)=>{const A=n.indexOf(s),y=n.indexOf(u);return A-y})}function Xf(e){const t=qe([]),r=qe([]),i=kt();return{children:t,linkChildren:s=>{hr(e,Object.assign({link:y=>{y.proxy&&(r.push(y),t.push(y.proxy),zf(i,t,r))},unlink:y=>{const a=r.indexOf(y);t.splice(a,1),r.splice(a,1)},children:t,internalChildren:r},s))}}}function Qf(e){let t;Ut(()=>{e(),er(()=>{t=!0})}),$a(()=>{t&&e()})}function Rg(e,t,r={}){if(!qi)return;const{target:i=window,passive:n=!1,capture:s=!1}=r;let u;const A=a=>{const T=ee(a);T&&!u&&(T.addEventListener(e,t,{capture:s,passive:n}),u=!0)},y=a=>{const T=ee(a);T&&u&&(T.removeEventListener(e,t,s),u=!1)};ir(()=>y(i)),qa(()=>y(i)),Qf(()=>A(i)),Pe(i)&&vt(i,(a,T)=>{y(T),A(a)})}var on,Xn;function Zf(){if(!on&&(on=xe(0),Xn=xe(0),qi)){const e=()=>{on.value=window.innerWidth,Xn.value=window.innerHeight};e(),window.addEventListener("resize",e,{passive:!0}),window.addEventListener("orientationchange",e,{passive:!0})}return{width:on,height:Xn}}var Jf=/scroll|auto|overlay/i,eh=qi?window:void 0;function th(e){return e.tagName!=="HTML"&&e.tagName!=="BODY"&&e.nodeType===1}function Dg(e,t=eh){let r=e;for(;r&&r!==t&&th(r);){const{overflowY:i}=window.getComputedStyle(r);if(Jf.test(i))return r;r=r.parentNode}return t}var kg=Symbol("van-field");function ra(e,t){"scrollTop"in e?e.scrollTop=t:e.scrollTo(e.scrollX,t)}function rh(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0}function nh(e){ra(window,e),ra(document.body,e)}const ih=Vf();function Cg(){ih&&nh(rh())}const sh=e=>e.stopPropagation();function ah(e,t){(typeof e.cancelable!="boolean"||e.cancelable)&&e.preventDefault(),t&&sh(e)}Zf();function _t(e){if(At(e))return Ro(e)?`${e}px`:String(e)}function oh(e){if(At(e)){if(Array.isArray(e))return{width:_t(e[0]),height:_t(e[1])};const t=_t(e);return{width:t,height:t}}}function lh(e){const t={};return e!==void 0&&(t.zIndex=+e),t}const uh=/-(\w)/g,ko=e=>e.replace(uh,(t,r)=>r.toUpperCase()),ch=e=>e.replace(/([A-Z])/g,"-$1").toLowerCase().replace(/^-/,"");function na(e,t,r){const i=e.indexOf(t);return i===-1?e:t==="-"&&i!==0?e.slice(0,i):e.slice(0,i+1)+e.slice(i).replace(r,"")}function Ig(e,t=!0,r=!0){t?e=na(e,".",/\./g):e=e.split(".")[0],r?e=na(e,"-",/-/g):e=e.replace(/-/,"");const i=t?/[^-0-9.]/g:/[^-0-9]/g;return e.replace(i,"")}const{hasOwnProperty:dh}=Object.prototype;function fh(e,t,r){const i=t[r];!At(i)||(!dh.call(e,r)||!$i(i)?e[r]=i:e[r]=Co(Object(e[r]),i))}function Co(e,t){return Object.keys(t).forEach(r=>{fh(e,t,r)}),e}var hh={name:"\u59D3\u540D",tel:"\u7535\u8BDD",save:"\u4FDD\u5B58",confirm:"\u786E\u8BA4",cancel:"\u53D6\u6D88",delete:"\u5220\u9664",loading:"\u52A0\u8F7D\u4E2D...",noCoupon:"\u6682\u65E0\u4F18\u60E0\u5238",nameEmpty:"\u8BF7\u586B\u5199\u59D3\u540D",addContact:"\u6DFB\u52A0\u8054\u7CFB\u4EBA",telInvalid:"\u8BF7\u586B\u5199\u6B63\u786E\u7684\u7535\u8BDD",vanCalendar:{end:"\u7ED3\u675F",start:"\u5F00\u59CB",title:"\u65E5\u671F\u9009\u62E9",weekdays:["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"],monthTitle:(e,t)=>`${e}\u5E74${t}\u6708`,rangePrompt:e=>`\u6700\u591A\u9009\u62E9 ${e} \u5929`},vanCascader:{select:"\u8BF7\u9009\u62E9"},vanPagination:{prev:"\u4E0A\u4E00\u9875",next:"\u4E0B\u4E00\u9875"},vanPullRefresh:{pulling:"\u4E0B\u62C9\u5373\u53EF\u5237\u65B0...",loosing:"\u91CA\u653E\u5373\u53EF\u5237\u65B0..."},vanSubmitBar:{label:"\u5408\u8BA1:"},vanCoupon:{unlimited:"\u65E0\u95E8\u69DB",discount:e=>`${e}\u6298`,condition:e=>`\u6EE1${e}\u5143\u53EF\u7528`},vanCouponCell:{title:"\u4F18\u60E0\u5238",count:e=>`${e}\u5F20\u53EF\u7528`},vanCouponList:{exchange:"\u5151\u6362",close:"\u4E0D\u4F7F\u7528",enable:"\u53EF\u7528",disabled:"\u4E0D\u53EF\u7528",placeholder:"\u8F93\u5165\u4F18\u60E0\u7801"},vanAddressEdit:{area:"\u5730\u533A",postal:"\u90AE\u653F\u7F16\u7801",areaEmpty:"\u8BF7\u9009\u62E9\u5730\u533A",addressEmpty:"\u8BF7\u586B\u5199\u8BE6\u7EC6\u5730\u5740",postalEmpty:"\u90AE\u653F\u7F16\u7801\u4E0D\u6B63\u786E",addressDetail:"\u8BE6\u7EC6\u5730\u5740",defaultAddress:"\u8BBE\u4E3A\u9ED8\u8BA4\u6536\u8D27\u5730\u5740"},vanAddressList:{add:"\u65B0\u589E\u5730\u5740"}};const ia=xe("zh-CN"),sa=qe({"zh-CN":hh}),gh={messages(){return sa[ia.value]},use(e,t){ia.value=e,this.add({[e]:t})},add(e={}){Co(sa,e)}};var ph=gh;function vh(e){const t=ko(e)+".";return(r,...i)=>{const n=ph.messages(),s=ea(n,t+r)||ea(n,r);return yi(s)?s(...i):s}}function Ei(e,t){return t?typeof t=="string"?` ${e}--${t}`:Array.isArray(t)?t.reduce((r,i)=>r+Ei(e,i),""):Object.keys(t).reduce((r,i)=>r+(t[i]?Ei(e,i):""),""):""}function mh(e){return(t,r)=>(t&&typeof t!="string"&&(r=t,t=""),t=t?`${e}__${t}`:e,`${t}${Ei(t,r)}`)}function ot(e){const t=`van-${e}`;return[t,mh(t),vh(t)]}const Jr="van-hairline",wg=`${Jr}--top`,xg=`${Jr}--left`,yh=`${Jr}--bottom`,Eh=`${Jr}--surround`,Th=`${Jr}--top-bottom`,aa="van-haptics-feedback",Og=Symbol("van-form");function yt(e){return e.install=t=>{const{name:r}=e;r&&(t.component(r,e),t.component(ko(`-${r}`),e))},e}const bh=Symbol();function Sh(e){const t=Ve(bh,null);t&&vt(t,r=>{r&&e()})}const Ah=(e,t)=>{const r=xe(),i=()=>{r.value=qf(e).height};return Ut(()=>{if(er(i),t)for(let n=1;n<=3;n++)setTimeout(i,100*n)}),Sh(()=>er(i)),r};function Io(e,t){const r=Ah(e,!0);return i=>ne("div",{class:t("placeholder"),style:{height:r.value?`${r.value}px`:void 0}},[i()])}const[wo,oa]=ot("action-bar"),Yi=Symbol(wo),_h={placeholder:Boolean,safeAreaInsetBottom:Zr};var Lh=De({name:wo,props:_h,setup(e,{slots:t}){const r=xe(),i=Io(r,oa),{linkChildren:n}=Xf(Yi);n();const s=()=>{var u;return ne("div",{ref:r,class:[oa(),{"van-safe-area-bottom":e.safeAreaInsetBottom}]},[(u=t.default)==null?void 0:u.call(t)])};return()=>e.placeholder?i(s):s()}});const Rh=yt(Lh);function Dh(e){const t=kt();t&&br(t.proxy,e)}const Fn={to:[String,Object],url:String,replace:Boolean};function kh({to:e,url:t,replace:r,$router:i}){e&&i?i[r?"replace":"push"](e):t&&(r?location.replace(t):location.href=t)}function Mn(){const e=kt().proxy;return()=>kh(e)}const[Ch,la]=ot("badge"),Ih={dot:Boolean,max:We,tag:ht("div"),color:String,offset:Array,content:We,showZero:Zr,position:ht("top-right")};var wh=De({name:Ch,props:Ih,setup(e,{slots:t}){const r=()=>{if(t.content)return!0;const{content:u,showZero:A}=e;return At(u)&&u!==""&&(A||u!==0&&u!=="0")},i=()=>{const{dot:u,max:A,content:y}=e;if(!u&&r())return t.content?t.content():At(A)&&Ro(y)&&+y>A?`${A}+`:y},n=Ae(()=>{const u={background:e.color};if(e.offset){const[A,y]=e.offset;t.default?(u.top=_t(y),typeof A=="number"?u.right=_t(-A):u.right=A.startsWith("-")?A.replace("-",""):`-${A}`):(u.marginTop=_t(y),u.marginLeft=_t(A))}return u}),s=()=>{if(r()||e.dot)return ne("div",{class:la([e.position,{dot:e.dot,fixed:!!t.default}]),style:n.value},[i()])};return()=>{if(t.default){const{tag:u}=e;return ne(u,{class:la("wrapper")},{default:()=>[t.default(),s()]})}return s()}}});const xo=yt(wh);let Oo=2e3;const Pg=()=>++Oo,xh=e=>{Oo=e},[Po,Oh]=ot("config-provider"),Fo=Symbol(Po),Ph={tag:ht("div"),zIndex:Number,themeVars:Object,iconPrefix:String};function Fh(e){const t={};return Object.keys(e).forEach(r=>{t[`--van-${ch(r)}`]=e[r]}),t}De({name:Po,props:Ph,setup(e,{slots:t}){const r=Ae(()=>{if(e.themeVars)return Fh(e.themeVars)});return hr(Fo,e),jl(()=>{e.zIndex!==void 0&&xh(e.zIndex)}),()=>ne(e.tag,{class:Oh(),style:r.value},{default:()=>{var i;return[(i=t.default)==null?void 0:i.call(t)]}})}});const[Mh,ua]=ot("icon"),Nh=e=>e==null?void 0:e.includes("/"),Bh={dot:Boolean,tag:ht("i"),name:String,size:We,badge:We,color:String,badgeProps:Object,classPrefix:String};var Uh=De({name:Mh,props:Bh,setup(e,{slots:t}){const r=Ve(Fo,null),i=Ae(()=>e.classPrefix||(r==null?void 0:r.iconPrefix)||ua());return()=>{const{tag:n,dot:s,name:u,size:A,badge:y,color:a}=e,T=Nh(u);return ne(xo,Qr({dot:s,tag:n,class:[i.value,T?"":`${i.value}-${u}`],style:{color:a,fontSize:_t(A)},content:y},e.badgeProps),{default:()=>{var v;return[(v=t.default)==null?void 0:v.call(t),T&&ne("img",{class:ua("image"),src:u},null)]}})}}});const Xr=yt(Uh),[Gh,Br]=ot("loading"),jh=Array(12).fill(null).map((e,t)=>ne("i",{class:Br("line",String(t+1))},null)),Kh=ne("svg",{class:Br("circular"),viewBox:"25 25 50 50"},[ne("circle",{cx:"50",cy:"50",r:"20",fill:"none"},null)]),Hh={size:We,type:ht("circular"),color:String,vertical:Boolean,textSize:We,textColor:String};var Vh=De({name:Gh,props:Hh,setup(e,{slots:t}){const r=Ae(()=>br({color:e.color},oh(e.size))),i=()=>{var n;if(t.default)return ne("span",{class:Br("text"),style:{fontSize:_t(e.textSize),color:(n=e.textColor)!=null?n:e.color}},[t.default()])};return()=>{const{type:n,vertical:s}=e;return ne("div",{class:Br([n,{vertical:s}]),"aria-live":"polite","aria-busy":!0},[ne("span",{class:Br("spinner",n),style:r.value},[n==="spinner"?jh:Kh]),i()])}}});const Wh=yt(Vh),[$h,ar]=ot("button"),qh=br({},Fn,{tag:ht("button"),text:String,icon:String,type:ht("default"),size:ht("normal"),color:String,block:Boolean,plain:Boolean,round:Boolean,square:Boolean,loading:Boolean,hairline:Boolean,disabled:Boolean,iconPrefix:String,nativeType:ht("button"),loadingSize:We,loadingText:String,loadingType:String,iconPosition:ht("left")});var Yh=De({name:$h,props:qh,emits:["click"],setup(e,{emit:t,slots:r}){const i=Mn(),n=()=>r.loading?r.loading():ne(Wh,{size:e.loadingSize,type:e.loadingType,class:ar("loading")},null),s=()=>{if(e.loading)return n();if(r.icon)return ne("div",{class:ar("icon")},[r.icon()]);if(e.icon)return ne(Xr,{name:e.icon,class:ar("icon"),classPrefix:e.iconPrefix},null)},u=()=>{let a;if(e.loading?a=e.loadingText:a=r.default?r.default():e.text,a)return ne("span",{class:ar("text")},[a])},A=()=>{const{color:a,plain:T}=e;if(a){const v={color:T?a:"white"};return T||(v.background=a),a.includes("gradient")?v.border=0:v.borderColor=a,v}},y=a=>{e.loading?ah(a):e.disabled||(t("click",a),i())};return()=>{const{tag:a,type:T,size:v,block:d,round:L,plain:R,square:E,loading:o,disabled:f,hairline:l,nativeType:g,iconPosition:m}=e,h=[ar([T,v,{plain:R,block:d,round:L,square:E,loading:o,disabled:f,hairline:l}]),{[Eh]:l}];return ne(a,{type:g,class:h,style:A(),disabled:f,onClick:y},{default:()=>[ne("div",{class:ar("content")},[m==="left"&&s(),u(),m==="right"&&s()])]})}}});const Mo=yt(Yh),[zh,Xh]=ot("action-bar-button"),Qh=br({},Fn,{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean});var Zh=De({name:zh,props:Qh,setup(e,{slots:t}){const r=Mn(),{parent:i,index:n}=Do(Yi),s=Ae(()=>{if(i){const A=i.children[n.value-1];return!(A&&"isButton"in A)}}),u=Ae(()=>{if(i){const A=i.children[n.value+1];return!(A&&"isButton"in A)}});return Dh({isButton:!0}),()=>{const{type:A,icon:y,text:a,color:T,loading:v,disabled:d}=e;return ne(Mo,{class:Xh([A,{last:u.value,first:s.value}]),size:"large",type:A,icon:y,color:T,loading:v,disabled:d,onClick:r},{default:()=>[t.default?t.default():a]})}}});const Jh=yt(Zh),[eg,Qn]=ot("action-bar-icon"),tg=br({},Fn,{dot:Boolean,text:String,icon:String,color:String,badge:We,iconClass:dn,badgeProps:Object,iconPrefix:String});var rg=De({name:eg,props:tg,setup(e,{slots:t}){const r=Mn();Do(Yi);const i=()=>{const{dot:n,badge:s,icon:u,color:A,iconClass:y,badgeProps:a,iconPrefix:T}=e;return t.icon?ne(xo,Qr({dot:n,class:Qn("icon"),content:s},a),{default:t.icon}):ne(Xr,{tag:"div",dot:n,name:u,badge:s,color:A,class:[Qn("icon"),y],badgeProps:a,classPrefix:T},null)};return()=>ne("div",{role:"button",class:Qn(),tabindex:0,onClick:r},[i(),t.default?t.default():e.text])}});const ng=yt(rg),[ig,or]=ot("cell"),sg={icon:String,size:String,title:We,value:We,label:We,center:Boolean,isLink:Boolean,border:Zr,required:Boolean,iconPrefix:String,valueClass:dn,labelClass:dn,titleClass:dn,titleStyle:null,arrowDirection:String,clickable:{type:Boolean,default:null}},ag=br({},sg,Fn);var og=De({name:ig,props:ag,setup(e,{slots:t}){const r=Mn(),i=()=>{if(t.label||At(e.label))return ne("div",{class:[or("label"),e.labelClass]},[t.label?t.label():e.label])},n=()=>{if(t.title||At(e.title))return ne("div",{class:[or("title"),e.titleClass],style:e.titleStyle},[t.title?t.title():ne("span",null,[e.title]),i()])},s=()=>{const y=t.value||t.default;if(y||At(e.value)){const T=t.title||At(e.title);return ne("div",{class:[or("value",{alone:!T}),e.valueClass]},[y?y():ne("span",null,[e.value])])}},u=()=>{if(t.icon)return t.icon();if(e.icon)return ne(Xr,{name:e.icon,class:or("left-icon"),classPrefix:e.iconPrefix},null)},A=()=>{if(t["right-icon"])return t["right-icon"]();if(e.isLink){const y=e.arrowDirection?`arrow-${e.arrowDirection}`:"arrow";return ne(Xr,{name:y,class:or("right-icon")},null)}};return()=>{var y,a;const{size:T,center:v,border:d,isLink:L,required:R}=e,E=(y=e.clickable)!=null?y:L,o={center:v,required:R,clickable:E,borderless:!d};return T&&(o[T]=!!T),ne("div",{class:or(o),role:E?"button":void 0,tabindex:E?0:void 0,onClick:r},[u(),n(),s(),A(),(a=t.extra)==null?void 0:a.call(t)])}}});const lg=yt(og),[ug,ca]=ot("cell-group"),cg={title:String,inset:Boolean,border:Zr};var dg=De({name:ug,inheritAttrs:!1,props:cg,setup(e,{slots:t,attrs:r}){const i=()=>{var s;return ne("div",Qr({class:[ca({inset:e.inset}),{[Th]:e.border&&!e.inset}]},r),[(s=t.default)==null?void 0:s.call(t)])},n=()=>ne("div",{class:ca("title",{inset:e.inset})},[t.title?t.title():e.title]);return()=>e.title||t.title?ne(Me,null,[n(),i()]):i()}});const fg=yt(dg),[hg,bt]=ot("nav-bar"),gg={title:String,fixed:Boolean,zIndex:We,border:Zr,leftText:String,rightText:String,leftArrow:Boolean,placeholder:Boolean,safeAreaInsetTop:Boolean};var pg=De({name:hg,props:gg,emits:["click-left","click-right"],setup(e,{emit:t,slots:r}){const i=xe(),n=Io(i,bt),s=T=>t("click-left",T),u=T=>t("click-right",T),A=()=>r.left?r.left():[e.leftArrow&&ne(Xr,{class:bt("arrow"),name:"arrow-left"},null),e.leftText&&ne("span",{class:bt("text")},[e.leftText])],y=()=>r.right?r.right():ne("span",{class:bt("text")},[e.rightText]),a=()=>{const{title:T,fixed:v,border:d,zIndex:L}=e,R=lh(L),E=e.leftArrow||e.leftText||r.left,o=e.rightText||r.right;return ne("div",{ref:i,style:R,class:[bt({fixed:v}),{[yh]:d,"van-safe-area-top":e.safeAreaInsetTop}]},[ne("div",{class:bt("content")},[E&&ne("div",{class:[bt("left"),aa],onClick:s},[A()]),ne("div",{class:[bt("title"),"van-ellipsis"]},[r.title?r.title():T]),o&&ne("div",{class:[bt("right"),aa],onClick:u},[y()])])])};return()=>e.fixed&&e.placeholder?n(a):a()}});const vg=yt(pg);const lt=uc(md);lt.use(bd);lt.use(Ld);lt.use(Mo);lt.use(vg);lt.use(Rh);lt.use(ng);lt.use(Jh);lt.use(lg);lt.use(fg);lt.use(zr);lt.mount("#app");export{bg as $,xe as A,Mo as B,Do as C,Og as D,Ae as E,Me as F,_t as G,Dh as H,vt as I,er as J,Ut as K,Rg as L,lg as M,vg as N,At as O,Ag as P,Ig as Q,ah as R,Xr as S,hr as T,Qr as U,kg as V,Cg as W,yt as X,Zr as Y,Sg as Z,Ar as _,se as a,xg as a0,wg as a1,Jh as a2,Rh as a3,Wf as a4,Qf as a5,qa as a6,Fi as a7,Dg as a8,qr as a9,lh as aa,Ke as ab,He as ac,$a as ad,bh as ae,mg as af,Pg as ag,aa as ah,uc as ai,_g as aj,ir as ak,Wh as al,Ge as am,pd as an,rr as ao,nr as ap,tu as aq,ne as b,be as c,De as d,st as e,ee as f,yg as g,rh as h,$i as i,Tg as j,yi as k,kt as l,ot as m,We as n,me as o,ht as p,Lg as q,vn as r,nh as s,Ce as t,Eg as u,br as v,Hr as w,sg as x,dn as y,qe as z};
