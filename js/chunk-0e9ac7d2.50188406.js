(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0e9ac7d2"],{"30ae":function(e,t,a){},b28f:function(e,t,a){"use strict";a("30ae")},c74b:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"main"},[t("heads",{attrs:{save:"save"},on:{previousStep:e.previousStep}}),e._m(0),t("van-form",{staticClass:"form",attrs:{"show-error-message":!1,"validate-trigger":"onSubmit","validate-first":"","scroll-to-error":""},on:{submit:e.onSubmit}},[t("van-field",{attrs:{name:"title",label:"需求标题（必填）",placeholder:"请输入需求标题",rules:[{required:!0}],maxlength:"15"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}}),t("van-field",{staticClass:"textarea",attrs:{type:"textarea",rows:"3",autosize:"",maxlength:"200","show-word-limit":"",name:"describe",label:"需求描述（必填）",placeholder:"请输入需求描述",rules:[{required:!0}]},model:{value:e.form.describe,callback:function(t){e.$set(e.form,"describe",t)},expression:"form.describe"}}),t("van-field",{staticClass:"radio",attrs:{name:"demandType",label:"需求类型（必填）",rules:[{required:!0}]},scopedSlots:e._u([{key:"input",fn:function(){return[t("van-radio-group",{attrs:{direction:"horizontal"},model:{value:e.form.demandType,callback:function(t){e.$set(e.form,"demandType",t)},expression:"form.demandType"}},[t("van-radio",{attrs:{name:"1"},scopedSlots:e._u([{key:"icon",fn:function(a){return[t("div",{staticClass:"demandType",class:a.checked?"active":""},[e._v("代码审计")])]}}])}),t("van-radio",{attrs:{name:"2"},scopedSlots:e._u([{key:"icon",fn:function(a){return[t("div",{staticClass:"demandType",class:a.checked?"active":""},[e._v("讲师招募")])]}}])}),t("van-radio",{attrs:{name:"3"},scopedSlots:e._u([{key:"icon",fn:function(a){return[t("div",{staticClass:"demandType",class:a.checked?"active":""},[e._v("智能合约")])]}}])})],1)]},proxy:!0}])}),t("van-field",{staticClass:"bond",attrs:{name:"bond",type:"digit",label:"项目保证金（必填）",placeholder:"项目保证金不能为0且最高不能超过项目款",rules:[{validator:e.asyncpProjectFunds,name:"bond"}],maxlength:"5",disabled:e.win_user_id>0},on:{input:e.userBond},scopedSlots:e._u([{key:"button",fn:function(){return[t("div",{staticClass:"sele",on:{click:function(t){return e.choose("bond")}}},[t("div",{staticClass:"coin"},[e._v(e._s(e.form.bondType))]),t("div",{staticClass:"downIcon"},[t("img",{attrs:{src:a("f8d3"),alt:""}})])])]},proxy:!0}]),model:{value:e.form.bond,callback:function(t){e.$set(e.form,"bond",t)},expression:"form.bond"}}),t("van-field",{staticClass:"radio",attrs:{name:"paymentMethod",label:"项目付款方式（必填）",rules:[{required:!0}]},scopedSlots:e._u([{key:"input",fn:function(){return[t("van-radio-group",{attrs:{direction:"horizontal"},model:{value:e.form.paymentMethod,callback:function(t){e.$set(e.form,"paymentMethod",t)},expression:"form.paymentMethod"}},[t("van-radio",{attrs:{name:"1"},scopedSlots:e._u([{key:"icon",fn:function(a){return[t("div",{staticClass:"demandType",class:a.checked?"active":""},[e._v("一次付清")])]}}])})],1)]},proxy:!0}])}),t("van-field",{staticClass:"bond",attrs:{type:"digit",name:"projectFunds",label:"项目款（必填）",placeholder:"请输入项目款",rules:[{validator:e.asyncpProjectFunds,name:"projectFunds"}],maxlength:"5",disabled:e.win_user_id>0},on:{input:function(t){e.form.negotiable=!1}},scopedSlots:e._u([{key:"button",fn:function(){return[t("div",{staticClass:"projectFunds"},[t("div",{staticClass:"sele",on:{click:function(t){return e.choose("projectFunds")}}},[t("div",{staticClass:"coin"},[e._v(e._s(e.form.bondType))]),t("div",{staticClass:"downIcon"},[t("img",{attrs:{src:a("f8d3"),alt:""}})])]),t("div",{staticClass:"btnStyle"},[t("van-button",{staticClass:"negotiable",attrs:{"native-type":"button",plain:!e.form.negotiable,disabled:e.win_user_id>0,size:"small",type:"primary",color:"#1F75D9"},on:{click:function(t){e.form.negotiable=!e.form.negotiable,e.form.projectFunds=""}}},[e._v("面议 ")])],1)])]},proxy:!0}]),model:{value:e.form.projectFunds,callback:function(t){e.$set(e.form,"projectFunds",t)},expression:"form.projectFunds"}}),t("van-field",{staticClass:"bond",attrs:{name:"number",type:"digit",label:"允许报名人数（必填）",placeholder:"请输入报名人数",rules:[{validator:e.asyncpProjectFunds,name:"number"}],maxlength:"4"},on:{input:function(t){e.form.unlimited=!1}},scopedSlots:e._u([{key:"button",fn:function(){return[t("div",{staticClass:"btnStyle"},[t("van-button",{staticClass:"negotiable",attrs:{"native-type":"button",plain:!e.form.unlimited,size:"small",type:"primary",color:"#1F75D9"},on:{click:function(t){e.form.unlimited=!e.form.unlimited,e.form.number=""}}},[e._v("不限 ")])],1)]},proxy:!0}]),model:{value:e.form.number,callback:function(t){e.$set(e.form,"number",t)},expression:"form.number"}}),t("van-field",{attrs:{readonly:"",clickable:"",name:"registrationTime",value:e.form.registrationTime,label:"报名时间（必填）",placeholder:"报名截止时间",rules:[{validator:e.asyncDate,name:"registrationTime"}]},on:{click:function(t){e.showCalendar=!0,e.timeType=0}}}),t("van-field",{attrs:{readonly:"",clickable:"",name:"deliveryTime",value:e.form.deliveryTime,label:"交付时间（必填）",placeholder:"交付截止时间",rules:[{validator:e.asyncDate,name:"deliveryTime"}]},on:{click:function(t){e.showCalendar=!0,e.timeType=1}}}),t("div",{staticClass:"btns"},[t("van-button",{staticClass:"btn",attrs:{type:"info","native-type":"button",color:"#1F75D9",plain:""},on:{click:e.previousStep}},[e._v(" "+e._s(e.query.status?"取消修改":"上一步")+" ")]),t("van-button",{staticClass:"btn",attrs:{type:"info","native-type":"submit",color:"#1F75D9"}},[e._v(e._s(e.query.status?"保存并退出":"提交")+" ")])],1)],1),t("van-action-sheet",{attrs:{"cancel-text":"取消","close-on-click-action":"",actions:e.actions},on:{select:e.onSelect},model:{value:e.currencyShow,callback:function(t){e.currencyShow=t},expression:"currencyShow"}}),t("van-calendar",{staticClass:"calendar",on:{confirm:e.onConfirm},model:{value:e.showCalendar,callback:function(t){e.showCalendar=t},expression:"showCalendar"}})],1)},n=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"info"},[t("div",{staticClass:"title"},[e._v("完善基本信息")]),t("div",{staticClass:"tips"},[e._v("让最适合的人才快速找到你")])])}],o=a("6a09"),s=a("74d2"),r=a("0c6d"),l={data(){return{win_user_id:"",DateNow:new Date((new Date).toLocaleDateString()).getTime(),query:"",task_id:"",showCalendar:!1,currencyShow:!1,currencyType:"",actions:[{name:"SRS"},{name:"USDT"}],form:{title:"",describe:"",demandType:"1",bondType:"SRS",bond:"",paymentMethod:"1",projectFunds:"",projectFundsType:"SRS",negotiable:!1,number:"",unlimited:!1,registrationTime:"",deliveryTime:""}}},methods:{choose(e){this.win_user_id>0||(this.currencyShow=!0,this.currencyType=e)},userBond(e){let t=+e,a=+this.form.projectFunds;t&&a&&t>a&&(Object(o["a"])("最高不能超过项目款"),setTimeout(()=>{this.form.bond=""},300))},onSelect(e){this.form.bondType=e.name},onConfirm(e){let t=e.getFullYear(),a=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,i=e.getDate()<10?"0"+e.getDate():e.getDate();this.timeType?this.form.deliveryTime=`${t}/${a}/${i}`:this.form.registrationTime=`${t}/${a}/${i}`,this.showCalendar=!1},previousStep(){console.log(this.$options.data.call(this).form);let e=this.$options.data.call(this).form,t=this.form;if(JSON.stringify(e)===JSON.stringify(t)||this.query.status)this.$router.go(-1);else{let e={confirmButtonText:"继续填写",cancelButtonText:"放弃填写",message:"现在离开将无法保存需求为你推荐优质人才,是否离开？"};this.showDialog(e,()=>{},()=>{localStorage.setItem("form",JSON.stringify(this.form)),this.$router.go(-1),console.log("取消事件")})}},async onSubmit(e){if(this.win_user_id>0)return void Object(o["a"])("中标后不可修改");let t={allows:this.form.number?+this.form.number:-1,amount:this.form.projectFunds?+this.form.projectFunds:-1,bail:+this.form.bond,begin_time:new Date(this.form.registrationTime).getTime(),delivery_time:new Date(this.form.deliveryTime).getTime(),description:this.form.describe,pay_type:1,amount_type:"SRS"===this.form.bondType?1:2,bail_type:"SRS"===this.form.bondType?1:2,title:this.form.title,type:+this.form.demandType,user_id:Number(localStorage.getItem("userId"))};if(this.task_id&&(t.id=+this.task_id),t.bail>t.amount&&-1!=t.amount)return void Object(o["a"])("保证金不能超过项目款");if(this.DateNow>t.begin_time)return void Object(o["a"])("报名时间不能晚于当前时间");let a=await(this.task_id?r["s"]:r["k"])(t);200===a.code&&(localStorage.removeItem("form"),Object(o["a"])("需求发布成功"),this.$router.push({path:"demandDetails",query:{id:a.data.id||this.task_id}}))},bondInsertTips(){let e=document.getElementsByClassName("bond"),t=document.createElement("div");t.innerHTML="* 保证金由雇主缴纳后，才可投递该项目",t.className="bondTips",e[0].appendChild(t)},showDialog(e,t,a){s["a"].confirm({title:e.title||"标题",message:e.message,showCancelButton:!0,confirmButtonText:e.confirmButtonText,confirmButtonColor:"#1F75D9",cancelButtonText:e.cancelButtonText}).then(()=>{t()}).catch(()=>{a()})},asyncpProjectFunds(e,t){return new Promise(a=>{"projectFunds"===t.name?this.form.negotiable?a(!0):(0===Number(e)&&Object(o["a"])("项目款不能为0"),a(!!Number(e))):"bond"===t.name?(0===Number(e)&&Object(o["a"])("项目保证金不能为0且最高不能超过项目款"),a(!!Number(e))):this.form.unlimited?a(!0):(0===Number(e)&&Object(o["a"])("报名人数不能为0"),a(!!Number(e)))})},asyncDate(e,t){if(!e)return!1;let a=new Date(e),i=a.getTime();return new Promise(e=>{if("registrationTime"===t.name)if(this.form.deliveryTime){let t=new Date(this.form.deliveryTime),a=t.getTime();i<a?e(!0):(Object(o["a"])("交付时间不能早于报名时间"),e(!1))}else e(!0);else if(this.form.registrationTime){let t=new Date(this.form.registrationTime),a=t.getTime();a<i?e(!0):(Object(o["a"])("交付时间不能早于报名时间"),e(!1))}else e(!0)})},async getData(e){let t=await Object(r["l"])({task_id:e});-1===t.data.amount&&(t.data.amount=""),-1===t.data.allows&&(t.data.allows="");let a={title:t.data.title,describe:t.data.description,demandType:t.data.type.toString(),bondType:1==t.data.amount_type?"SRS":"USDT",bond:t.data.bail,paymentMethod:"1",projectFunds:t.data.amount,projectFundsType:1==t.data.amount_type?"SRS":"USDT",negotiable:""===t.data.amount,number:t.data.allows,unlimited:""===t.data.allows,registrationTime:this.$util.getUnixToDate("yyyy-mm-dd",t.data.begin_time,"/"),deliveryTime:this.$util.getUnixToDate("yyyy-mm-dd",t.data.delivery_time,"/")};this.win_user_id=t.data.win_user_id,this.form=a}},async mounted(){if(this.query=this.$route.query,this.bondInsertTips(),this.task_id=this.$route.query.id,this.task_id)await this.getData(this.task_id);else{let e=localStorage.getItem("form");e?(this.form=JSON.parse(e),this.form.title=JSON.parse(e)?JSON.parse(e).title:""):this.form.title=this.$route.query.desc||""}}},d=l,c=(a("b28f"),a("0b56")),m=Object(c["a"])(d,i,n,!1,null,"cf3ec038",null);t["default"]=m.exports},f8d3:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAAcCAYAAAAuh5ywAAAAAXNSR0IArs4c6QAABLRJREFUWEfdl21sU2UUx//nduu2smEQjWAMy9pufRPN1nZkxJBFJkOYSlTExKAYP6hgTDRiSIwaDQmRSEJ8SZRoNBoJZgSCGHlTsxicYtsNyrjd3C3DuEzBkTEMde167zHP7S1ZcC/t2sLwfmjzvJ3z/91znvM8l2A8bndjuSy3xQBo6b7r4r+hocybSCRDodCo0Evix+ryN0ngbxgIWIpKW06ePDp0PcDYPHV3S6q0hwl/mSnmkWU5oQPZa3xrYcJnOgTRiVJJau7qOnZ2JkM5nXUtSZJaAZQCuIRR062KcuyiDiQwbG7fO8R4Tm8w9ZSZpaZw+Fj/TISyufxrCCwCYBYwGqkPnJY7v7uccmnRdrd/C5g3GVBnOFncpCjt0ZkEZXf4niLCh0wwMehCMWNld3egPa0xHaHLmu1O/yYQbxEdDPqDKHGPIp84NROgqh3+51ni7XoSMZ0jqWi5Iv/UOVbbf4DEYI3Lt0ED3tV3FNMgk9asREId1xLK5qp/haBtTmUPBqAWNfX2/hy5UtO4QGJStdO/DuCPRGiJMaxK3HJaDh29FlDVrvq3GNrLxlboSzAt/a3nl77xtEwIpFc/j+9haPhCbD4GYhqwqi8SPHIVoajG5X1PA63XfTK642UlS3/v/HFgIg2TAolFVpdvhYmxmwllAMdBtEaRg/sKDrV6tcne1fcJgLWGr05LsXl5ONx+bjLfUwKJxU6nrzFJ+ApABYAkiNYpckBEriCP2+02JzTLThAeSgUG7RUlyZXHjx+/MJXDjID0QuH21avMBwk0R1yPiPFsb3dwx1QOsh33er2W4RjtBnBvKs3oe4s5fn84HL6Uia2MgXSomto7VVPRIQLfIlwx08Zod2BbJo4ymWO3L5pNxdp+Bi8x9sz+5Ej5I2fOtI1ksl4vGplOTM+rctzhMEklhwFeoPcRvanIgdeztXPlfI+n4ca4NnoAQL0Ykxi7Kmbx4+lLZ6b2swYShquqFleaShPiqmFLZQVvi8qhjal0z/5xu/3zEsyHASw0Vn+s3F71NFpb1WytTQtIOKms9M4vLpOOgNijQzF2RBdWrc9WhNXqXSCZdTs1qZSh7b2RwIvTfTnTBhLOnc76uaMkCgX7jA2887Z5s55oa2tLZvJmra5F1RJUca5VGjCbeyOBVzNZO9GcnICE0Tle7w03xehrBu4ynOzD6M1rFOVAfDJhVmfDQqLkYQLPSwUYm6KR4NZcYKZVFMZzKErtUIz2SsAyw+i3ZcWJVROVWoej1qdKpoMA5upHgMYbentCH+QKkzcgYUg/DNnyJYBVhuGjgxZuGQqFhscKrXLVLjHBtB/AbGKorOFJ5dfg5/mAySuQMNbY2FjU/+ffn4LoMUNgR8zCzQOh0KBo2z11zaxJewiwAEgwtEejkY69+YLJO5AhTLK5fe8T4xmjHYmXljSZR/5ZRJB2pS+6JGkPKqc6DuUTplBAut1qt38rM7+UKunUL4Hni08RABdVqPf1RTp/yDdMIYF0rXan/zUQvzFG+HmTpi7v6ekMFgKm4EDCQY3L94IGvM2gs0B8WTQS7ioUzFUB0iNlX2wrL4+dz+T6nytszgdrrgLyvf5/B/Qv20CvLEXrVc4AAAAASUVORK5CYII="}}]);
//# sourceMappingURL=chunk-0e9ac7d2.50188406.js.map